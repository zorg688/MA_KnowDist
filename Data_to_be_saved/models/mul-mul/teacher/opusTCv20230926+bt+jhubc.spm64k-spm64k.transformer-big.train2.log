[2024-06-11 08:38:43] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-11 08:38:43] [marian] Running on nid007861 as process 50072 with command line:
[2024-06-11 08:38:43] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-06-11 08:38:45] [config] after: 0e
[2024-06-11 08:38:45] [config] after-batches: 0
[2024-06-11 08:38:45] [config] after-epochs: 0
[2024-06-11 08:38:45] [config] all-caps-every: 0
[2024-06-11 08:38:45] [config] allow-unk: true
[2024-06-11 08:38:45] [config] authors: false
[2024-06-11 08:38:45] [config] beam-size: 6
[2024-06-11 08:38:45] [config] bert-class-symbol: "[CLS]"
[2024-06-11 08:38:45] [config] bert-mask-symbol: "[MASK]"
[2024-06-11 08:38:45] [config] bert-masking-fraction: 0.15
[2024-06-11 08:38:45] [config] bert-sep-symbol: "[SEP]"
[2024-06-11 08:38:45] [config] bert-train-type-embeddings: true
[2024-06-11 08:38:45] [config] bert-type-vocab-size: 2
[2024-06-11 08:38:45] [config] build-info: ""
[2024-06-11 08:38:45] [config] char-conv-filters-num:
[2024-06-11 08:38:45] [config]   - 200
[2024-06-11 08:38:45] [config]   - 200
[2024-06-11 08:38:45] [config]   - 250
[2024-06-11 08:38:45] [config]   - 250
[2024-06-11 08:38:45] [config]   - 300
[2024-06-11 08:38:45] [config]   - 300
[2024-06-11 08:38:45] [config]   - 300
[2024-06-11 08:38:45] [config]   - 300
[2024-06-11 08:38:45] [config] char-conv-filters-widths:
[2024-06-11 08:38:45] [config]   - 1
[2024-06-11 08:38:45] [config]   - 2
[2024-06-11 08:38:45] [config]   - 3
[2024-06-11 08:38:45] [config]   - 4
[2024-06-11 08:38:45] [config]   - 5
[2024-06-11 08:38:45] [config]   - 6
[2024-06-11 08:38:45] [config]   - 7
[2024-06-11 08:38:45] [config]   - 8
[2024-06-11 08:38:45] [config] char-highway: 4
[2024-06-11 08:38:45] [config] char-stride: 5
[2024-06-11 08:38:45] [config] check-gradient-nan: false
[2024-06-11 08:38:45] [config] check-nan: false
[2024-06-11 08:38:45] [config] cite: false
[2024-06-11 08:38:45] [config] clip-norm: 0
[2024-06-11 08:38:45] [config] cost-scaling:
[2024-06-11 08:38:45] [config]   []
[2024-06-11 08:38:45] [config] cost-type: ce-mean-words
[2024-06-11 08:38:45] [config] cpu-threads: 0
[2024-06-11 08:38:45] [config] data-threads: 8
[2024-06-11 08:38:45] [config] data-weighting: ""
[2024-06-11 08:38:45] [config] data-weighting-type: sentence
[2024-06-11 08:38:45] [config] dec-cell: gru
[2024-06-11 08:38:45] [config] dec-cell-base-depth: 2
[2024-06-11 08:38:45] [config] dec-cell-high-depth: 1
[2024-06-11 08:38:45] [config] dec-depth: 6
[2024-06-11 08:38:45] [config] devices:
[2024-06-11 08:38:45] [config]   - 0
[2024-06-11 08:38:45] [config]   - 1
[2024-06-11 08:38:45] [config]   - 2
[2024-06-11 08:38:45] [config]   - 3
[2024-06-11 08:38:45] [config]   - 4
[2024-06-11 08:38:45] [config]   - 5
[2024-06-11 08:38:45] [config]   - 6
[2024-06-11 08:38:45] [config]   - 7
[2024-06-11 08:38:45] [config] dim-emb: 1024
[2024-06-11 08:38:45] [config] dim-rnn: 1024
[2024-06-11 08:38:45] [config] dim-vocabs:
[2024-06-11 08:38:45] [config]   - 69666
[2024-06-11 08:38:45] [config]   - 69666
[2024-06-11 08:38:45] [config] disp-first: 10
[2024-06-11 08:38:45] [config] disp-freq: 10000
[2024-06-11 08:38:45] [config] disp-label-counts: true
[2024-06-11 08:38:45] [config] dropout-rnn: 0
[2024-06-11 08:38:45] [config] dropout-src: 0
[2024-06-11 08:38:45] [config] dropout-trg: 0
[2024-06-11 08:38:45] [config] dump-config: ""
[2024-06-11 08:38:45] [config] dynamic-gradient-scaling:
[2024-06-11 08:38:45] [config]   []
[2024-06-11 08:38:45] [config] early-stopping: 20
[2024-06-11 08:38:45] [config] early-stopping-on: first
[2024-06-11 08:38:45] [config] embedding-fix-src: false
[2024-06-11 08:38:45] [config] embedding-fix-trg: false
[2024-06-11 08:38:45] [config] embedding-normalization: false
[2024-06-11 08:38:45] [config] embedding-vectors:
[2024-06-11 08:38:45] [config]   []
[2024-06-11 08:38:45] [config] enc-cell: gru
[2024-06-11 08:38:45] [config] enc-cell-depth: 1
[2024-06-11 08:38:45] [config] enc-depth: 6
[2024-06-11 08:38:45] [config] enc-type: bidirectional
[2024-06-11 08:38:45] [config] english-title-case-every: 0
[2024-06-11 08:38:45] [config] exponential-smoothing: 0.0001
[2024-06-11 08:38:45] [config] factor-weight: 1
[2024-06-11 08:38:45] [config] factors-combine: sum
[2024-06-11 08:38:45] [config] factors-dim-emb: 0
[2024-06-11 08:38:45] [config] gradient-checkpointing: false
[2024-06-11 08:38:45] [config] gradient-norm-average-window: 100
[2024-06-11 08:38:45] [config] guided-alignment: none
[2024-06-11 08:38:45] [config] guided-alignment-cost: ce
[2024-06-11 08:38:45] [config] guided-alignment-weight: 0.1
[2024-06-11 08:38:45] [config] ignore-model-config: false
[2024-06-11 08:38:45] [config] input-types:
[2024-06-11 08:38:45] [config]   []
[2024-06-11 08:38:45] [config] interpolate-env-vars: false
[2024-06-11 08:38:45] [config] keep-best: true
[2024-06-11 08:38:45] [config] label-smoothing: 0.1
[2024-06-11 08:38:45] [config] layer-normalization: false
[2024-06-11 08:38:45] [config] learn-rate: 0.0002
[2024-06-11 08:38:45] [config] lemma-dependency: ""
[2024-06-11 08:38:45] [config] lemma-dim-emb: 0
[2024-06-11 08:38:45] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-06-11 08:38:45] [config] log-level: info
[2024-06-11 08:38:45] [config] log-time-zone: ""
[2024-06-11 08:38:45] [config] logical-epoch:
[2024-06-11 08:38:45] [config]   - 1e
[2024-06-11 08:38:45] [config]   - 0
[2024-06-11 08:38:45] [config] lr-decay: 0
[2024-06-11 08:38:45] [config] lr-decay-freq: 50000
[2024-06-11 08:38:45] [config] lr-decay-inv-sqrt:
[2024-06-11 08:38:45] [config]   - 8000
[2024-06-11 08:38:45] [config] lr-decay-repeat-warmup: false
[2024-06-11 08:38:45] [config] lr-decay-reset-optimizer: false
[2024-06-11 08:38:45] [config] lr-decay-start:
[2024-06-11 08:38:45] [config]   - 10
[2024-06-11 08:38:45] [config]   - 1
[2024-06-11 08:38:45] [config] lr-decay-strategy: epoch+stalled
[2024-06-11 08:38:45] [config] lr-report: false
[2024-06-11 08:38:45] [config] lr-warmup: 8000
[2024-06-11 08:38:45] [config] lr-warmup-at-reload: false
[2024-06-11 08:38:45] [config] lr-warmup-cycle: true
[2024-06-11 08:38:45] [config] lr-warmup-start-rate: 0
[2024-06-11 08:38:45] [config] max-length: 100
[2024-06-11 08:38:45] [config] max-length-crop: false
[2024-06-11 08:38:45] [config] max-length-factor: 3
[2024-06-11 08:38:45] [config] maxi-batch: 1000
[2024-06-11 08:38:45] [config] maxi-batch-sort: trg
[2024-06-11 08:38:45] [config] mini-batch: 1000
[2024-06-11 08:38:45] [config] mini-batch-fit: true
[2024-06-11 08:38:45] [config] mini-batch-fit-step: 10
[2024-06-11 08:38:45] [config] mini-batch-round-up: true
[2024-06-11 08:38:45] [config] mini-batch-track-lr: false
[2024-06-11 08:38:45] [config] mini-batch-warmup: 0
[2024-06-11 08:38:45] [config] mini-batch-words: 0
[2024-06-11 08:38:45] [config] mini-batch-words-ref: 0
[2024-06-11 08:38:45] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-11 08:38:45] [config] multi-loss-type: sum
[2024-06-11 08:38:45] [config] n-best: false
[2024-06-11 08:38:45] [config] no-nccl: false
[2024-06-11 08:38:45] [config] no-reload: false
[2024-06-11 08:38:45] [config] no-restore-corpus: false
[2024-06-11 08:38:45] [config] normalize: 1
[2024-06-11 08:38:45] [config] normalize-gradient: false
[2024-06-11 08:38:45] [config] num-devices: 0
[2024-06-11 08:38:45] [config] optimizer: adam
[2024-06-11 08:38:45] [config] optimizer-delay: 10
[2024-06-11 08:38:45] [config] optimizer-params:
[2024-06-11 08:38:45] [config]   - 0.9
[2024-06-11 08:38:45] [config]   - 0.998
[2024-06-11 08:38:45] [config]   - 1e-09
[2024-06-11 08:38:45] [config] output-omit-bias: false
[2024-06-11 08:38:45] [config] overwrite: true
[2024-06-11 08:38:45] [config] precision:
[2024-06-11 08:38:45] [config]   - float32
[2024-06-11 08:38:45] [config]   - float32
[2024-06-11 08:38:45] [config] pretrained-model: ""
[2024-06-11 08:38:45] [config] quantize-biases: false
[2024-06-11 08:38:45] [config] quantize-bits: 0
[2024-06-11 08:38:45] [config] quantize-log-based: false
[2024-06-11 08:38:45] [config] quantize-optimization-steps: 0
[2024-06-11 08:38:45] [config] quiet: false
[2024-06-11 08:38:45] [config] quiet-translation: false
[2024-06-11 08:38:45] [config] relative-paths: false
[2024-06-11 08:38:45] [config] right-left: false
[2024-06-11 08:38:45] [config] save-freq: 10000
[2024-06-11 08:38:45] [config] seed: 2222
[2024-06-11 08:38:45] [config] sentencepiece-alphas:
[2024-06-11 08:38:45] [config]   []
[2024-06-11 08:38:45] [config] sentencepiece-max-lines: 2000000
[2024-06-11 08:38:45] [config] sentencepiece-options: ""
[2024-06-11 08:38:45] [config] sharding: local
[2024-06-11 08:38:45] [config] shuffle: batches
[2024-06-11 08:38:45] [config] shuffle-in-ram: false
[2024-06-11 08:38:45] [config] sigterm: save-and-exit
[2024-06-11 08:38:45] [config] skip: false
[2024-06-11 08:38:45] [config] sqlite: ""
[2024-06-11 08:38:45] [config] sqlite-drop: false
[2024-06-11 08:38:45] [config] sync-freq: 200u
[2024-06-11 08:38:45] [config] sync-sgd: true
[2024-06-11 08:38:45] [config] tempdir: /scratch/project_462000447/tmp
[2024-06-11 08:38:45] [config] tied-embeddings: false
[2024-06-11 08:38:45] [config] tied-embeddings-all: true
[2024-06-11 08:38:45] [config] tied-embeddings-src: false
[2024-06-11 08:38:45] [config] train-embedder-rank:
[2024-06-11 08:38:45] [config]   []
[2024-06-11 08:38:45] [config] train-sets:
[2024-06-11 08:38:45] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-06-11 08:38:45] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-06-11 08:38:45] [config] transformer-aan-activation: swish
[2024-06-11 08:38:45] [config] transformer-aan-depth: 2
[2024-06-11 08:38:45] [config] transformer-aan-nogate: false
[2024-06-11 08:38:45] [config] transformer-decoder-autoreg: self-attention
[2024-06-11 08:38:45] [config] transformer-decoder-dim-ffn: 0
[2024-06-11 08:38:45] [config] transformer-decoder-ffn-depth: 0
[2024-06-11 08:38:45] [config] transformer-depth-scaling: false
[2024-06-11 08:38:45] [config] transformer-dim-aan: 2048
[2024-06-11 08:38:45] [config] transformer-dim-ffn: 4096
[2024-06-11 08:38:45] [config] transformer-dropout: 0.1
[2024-06-11 08:38:45] [config] transformer-dropout-attention: 0
[2024-06-11 08:38:45] [config] transformer-dropout-ffn: 0
[2024-06-11 08:38:45] [config] transformer-ffn-activation: relu
[2024-06-11 08:38:45] [config] transformer-ffn-depth: 2
[2024-06-11 08:38:45] [config] transformer-guided-alignment-layer: last
[2024-06-11 08:38:45] [config] transformer-heads: 16
[2024-06-11 08:38:45] [config] transformer-no-projection: false
[2024-06-11 08:38:45] [config] transformer-pool: false
[2024-06-11 08:38:45] [config] transformer-postprocess: dan
[2024-06-11 08:38:45] [config] transformer-postprocess-emb: d
[2024-06-11 08:38:45] [config] transformer-postprocess-top: ""
[2024-06-11 08:38:45] [config] transformer-preprocess: ""
[2024-06-11 08:38:45] [config] transformer-rnn-projection: false
[2024-06-11 08:38:45] [config] transformer-tied-layers:
[2024-06-11 08:38:45] [config]   []
[2024-06-11 08:38:45] [config] transformer-train-position-embeddings: false
[2024-06-11 08:38:45] [config] tsv: false
[2024-06-11 08:38:45] [config] tsv-fields: 0
[2024-06-11 08:38:45] [config] type: transformer
[2024-06-11 08:38:45] [config] ulr: false
[2024-06-11 08:38:45] [config] ulr-dim-emb: 0
[2024-06-11 08:38:45] [config] ulr-dropout: 0
[2024-06-11 08:38:45] [config] ulr-keys-vectors: ""
[2024-06-11 08:38:45] [config] ulr-query-vectors: ""
[2024-06-11 08:38:45] [config] ulr-softmax-temperature: 1
[2024-06-11 08:38:45] [config] ulr-trainable-transformation: false
[2024-06-11 08:38:45] [config] unlikelihood-loss: false
[2024-06-11 08:38:45] [config] valid-freq: 10000
[2024-06-11 08:38:45] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-06-11 08:38:45] [config] valid-max-length: 100
[2024-06-11 08:38:45] [config] valid-metrics:
[2024-06-11 08:38:45] [config]   - perplexity
[2024-06-11 08:38:45] [config] valid-mini-batch: 16
[2024-06-11 08:38:45] [config] valid-reset-stalled: false
[2024-06-11 08:38:45] [config] valid-script-args:
[2024-06-11 08:38:45] [config]   []
[2024-06-11 08:38:45] [config] valid-script-path: ""
[2024-06-11 08:38:45] [config] valid-sets:
[2024-06-11 08:38:45] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-06-11 08:38:45] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-06-11 08:38:45] [config] valid-translation-output: ""
[2024-06-11 08:38:45] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-11 08:38:45] [config] vocabs:
[2024-06-11 08:38:45] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-11 08:38:45] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-11 08:38:45] [config] word-penalty: 0
[2024-06-11 08:38:45] [config] word-scores: false
[2024-06-11 08:38:45] [config] workspace: 20000
[2024-06-11 08:38:45] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-11 08:38:45] Using synchronous SGD
[2024-06-11 08:38:45] [comm] Compiled without MPI support. Running as a single process on nid007861
[2024-06-11 08:38:45] Synced seed 2222
[2024-06-11 08:38:45] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-11 08:38:46] [data] Setting vocabulary size for input 0 to 69,666
[2024-06-11 08:38:46] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-11 08:38:46] [data] Setting vocabulary size for input 1 to 69,666
[2024-06-11 08:38:46] [batching] Collecting statistics for batch fitting with step size 10
[2024-06-11 08:38:52] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-11 08:38:52] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-11 08:38:52] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-11 08:38:52] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-11 08:38:52] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-11 08:38:52] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-11 08:38:52] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-11 08:38:52] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-11 08:38:52] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-11 08:38:54] [comm] Using global sharding
[2024-06-11 08:38:55] [comm] NCCLCommunicators constructed successfully
[2024-06-11 08:38:55] [training] Using 8 GPUs
[2024-06-11 08:38:55] [logits] Applying loss function for 1 factor(s)
[2024-06-11 08:38:55] [memory] Reserving 945 MB, device gpu0
[2024-06-11 08:39:01] [memory] Reserving 945 MB, device gpu0
[2024-06-11 08:39:34] [batching] Done. Typical MB size is 699,120 target words
[2024-06-11 08:39:35] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-11 08:39:35] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-11 08:39:35] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-11 08:39:35] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-11 08:39:35] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-11 08:39:35] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-11 08:39:35] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-11 08:39:35] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-11 08:39:35] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-11 08:39:35] [comm] Using global sharding
[2024-06-11 08:39:35] [comm] NCCLCommunicators constructed successfully
[2024-06-11 08:39:35] [training] Using 8 GPUs
[2024-06-11 08:39:35] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-11 08:39:43] No checkpoint found, parameters reloaded from last inference model
[2024-06-11 08:39:43] Training started
[2024-06-11 08:39:52] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-06-11 08:39:52] [memory] Reserving 945 MB, device gpu6
[2024-06-11 08:39:52] [memory] Reserving 945 MB, device gpu7
[2024-06-11 08:39:52] [memory] Reserving 945 MB, device gpu4
[2024-06-11 08:39:52] [memory] Reserving 945 MB, device gpu3
[2024-06-11 08:39:52] [memory] Reserving 945 MB, device gpu2
[2024-06-11 08:39:52] [memory] Reserving 945 MB, device gpu0
[2024-06-11 08:39:52] [memory] Reserving 945 MB, device gpu5
[2024-06-11 08:39:52] [memory] Reserving 945 MB, device gpu1
[2024-06-11 08:40:04] [memory] Reserving 945 MB, device gpu0
[2024-06-11 08:40:18] [memory] Reserving 945 MB, device gpu4
[2024-06-11 08:40:18] [memory] Reserving 945 MB, device gpu3
[2024-06-11 08:40:18] [memory] Reserving 945 MB, device gpu7
[2024-06-11 08:40:19] [memory] Reserving 945 MB, device gpu6
[2024-06-11 08:40:19] [memory] Reserving 945 MB, device gpu1
[2024-06-11 08:40:19] [memory] Reserving 945 MB, device gpu2
[2024-06-11 08:40:19] [memory] Reserving 945 MB, device gpu5
[2024-06-11 08:40:25] Parameter type float32, optimization type float32, casting types false
[2024-06-11 08:40:25] Allocating memory for general optimizer shards
[2024-06-11 08:40:25] [memory] Reserving 118 MB, device gpu6
[2024-06-11 08:40:25] [memory] Reserving 118 MB, device gpu1
[2024-06-11 08:40:25] [memory] Reserving 118 MB, device gpu2
[2024-06-11 08:40:25] [memory] Reserving 118 MB, device gpu4
[2024-06-11 08:40:25] [memory] Reserving 118 MB, device gpu7
[2024-06-11 08:40:25] [memory] Reserving 118 MB, device gpu3
[2024-06-11 08:40:25] [memory] Reserving 118 MB, device gpu5
[2024-06-11 08:40:25] [memory] Reserving 118 MB, device gpu0
[2024-06-11 08:40:25] Allocating memory for Adam-specific shards
[2024-06-11 08:40:25] [memory] Reserving 236 MB, device gpu6
[2024-06-11 08:40:25] [memory] Reserving 236 MB, device gpu1
[2024-06-11 08:40:25] [memory] Reserving 236 MB, device gpu2
[2024-06-11 08:40:25] [memory] Reserving 236 MB, device gpu0
[2024-06-11 08:40:25] [memory] Reserving 236 MB, device gpu5
[2024-06-11 08:40:25] [memory] Reserving 236 MB, device gpu7
[2024-06-11 08:40:25] [memory] Reserving 236 MB, device gpu4
[2024-06-11 08:40:25] [memory] Reserving 236 MB, device gpu3
[2024-06-11 08:40:25] Ep. 1 : Up. 1 : Sen. 6,560 : Cost 3.07601476 : Time 50.56s : 12787.67 words/s : gNorm 0.8085
[2024-06-11 08:40:27] Ep. 1 : Up. 2 : Sen. 19,304 : Cost 3.45693803 : Time 1.96s : 91195.82 words/s : gNorm 0.6965
[2024-06-11 08:40:30] Ep. 1 : Up. 3 : Sen. 29,064 : Cost 3.14179969 : Time 3.12s : 93724.87 words/s : gNorm 0.5957
[2024-06-11 08:40:32] Ep. 1 : Up. 4 : Sen. 35,624 : Cost 3.45098186 : Time 1.67s : 62886.81 words/s : gNorm 0.8362
[2024-06-11 08:40:34] Ep. 1 : Up. 5 : Sen. 42,184 : Cost 3.35184908 : Time 1.84s : 67719.14 words/s : gNorm 0.9068
[2024-06-11 08:40:37] Ep. 1 : Up. 6 : Sen. 48,744 : Cost 3.07731509 : Time 3.76s : 102674.46 words/s : gNorm 0.7697
[2024-06-11 08:40:43] Ep. 1 : Up. 7 : Sen. 55,304 : Cost 3.08071804 : Time 5.44s : 110670.54 words/s : gNorm 0.7294
[2024-06-11 08:40:44] Ep. 1 : Up. 8 : Sen. 61,864 : Cost 4.03052616 : Time 1.30s : 14265.95 words/s : gNorm 2.6205
[2024-06-11 08:40:49] Ep. 1 : Up. 9 : Sen. 68,424 : Cost 3.07473087 : Time 4.79s : 104952.50 words/s : gNorm 2.1814
[2024-06-11 08:40:51] Ep. 1 : Up. 10 : Sen. 78,821 : Cost 3.50800061 : Time 1.85s : 90123.05 words/s : gNorm 1.9060
[2024-06-11 16:45:27] Ep. 1 : Up. 10000 : Sen. 76,760,695 : Cost 3.25451827 : Time 29076.25s : 92843.77 words/s : gNorm 1.3489
[2024-06-11 16:45:27] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-11 16:45:32] Saving Adam parameters
[2024-06-11 16:45:39] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-11 16:45:53] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-11 16:45:56] [valid] Ep. 1 : Up. 10000 : perplexity : 12.7852 : new best
[2024-06-12 00:51:43] Ep. 1 : Up. 20000 : Sen. 153,607,768 : Cost 3.24639583 : Time 29175.56s : 92750.68 words/s : gNorm 1.2459
[2024-06-12 00:51:43] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-12 00:51:48] Saving Adam parameters
[2024-06-12 00:51:55] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-12 00:52:09] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-12 00:52:12] [valid] Ep. 1 : Up. 20000 : perplexity : 12.4238 : new best
[2024-06-12 08:57:36] Ep. 1 : Up. 30000 : Sen. 230,347,035 : Cost 3.22590637 : Time 29153.27s : 92673.54 words/s : gNorm 1.7851
[2024-06-12 08:57:36] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-12 08:57:41] Saving Adam parameters
[2024-06-12 08:57:49] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-12 08:58:03] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-12 08:58:05] [valid] Ep. 1 : Up. 30000 : perplexity : 12.2921 : new best
[2024-06-12 17:03:54] Ep. 1 : Up. 40000 : Sen. 307,150,278 : Cost 3.21448135 : Time 29178.23s : 92715.22 words/s : gNorm 1.4091
[2024-06-12 17:03:54] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-12 17:03:59] Saving Adam parameters
[2024-06-12 17:04:07] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-12 17:04:21] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-12 17:04:23] [valid] Ep. 1 : Up. 40000 : perplexity : 12.2314 : new best
[2024-06-13 01:10:28] Ep. 1 : Up. 50000 : Sen. 383,972,434 : Cost 3.19913483 : Time 29193.56s : 92676.36 words/s : gNorm 0.7645
[2024-06-13 01:10:28] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-13 01:10:33] Saving Adam parameters
[2024-06-13 01:10:40] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-13 01:10:54] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-13 01:10:56] [valid] Ep. 1 : Up. 50000 : perplexity : 12.1864 : new best
[2024-06-13 09:16:29] Ep. 1 : Up. 60000 : Sen. 460,824,316 : Cost 3.19046712 : Time 29160.73s : 92754.30 words/s : gNorm 1.5445
[2024-06-13 09:16:29] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-13 09:16:33] Saving Adam parameters
[2024-06-13 09:16:41] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-13 09:16:55] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-13 09:16:58] [valid] Ep. 1 : Up. 60000 : perplexity : 12.1231 : new best
[2024-06-13 17:19:53] Ep. 1 : Up. 70000 : Sen. 537,601,316 : Cost 3.18683386 : Time 29004.01s : 93151.78 words/s : gNorm 1.7461
[2024-06-13 17:19:53] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-13 17:19:58] Saving Adam parameters
[2024-06-13 17:20:06] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-13 17:20:20] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-13 17:20:22] [valid] Ep. 1 : Up. 70000 : perplexity : 12.081 : new best
[2024-06-14 01:23:07] Ep. 1 : Up. 80000 : Sen. 614,372,471 : Cost 3.18417287 : Time 28994.06s : 93254.89 words/s : gNorm 1.4381
[2024-06-14 01:23:07] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-14 01:23:12] Saving Adam parameters
[2024-06-14 01:23:20] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-14 01:23:33] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-14 01:23:36] [valid] Ep. 1 : Up. 80000 : perplexity : 12.0426 : new best
[2024-06-14 11:49:22] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-14 11:49:22] [marian] Running on nid007921 as process 34310 with command line:
[2024-06-14 11:49:22] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-06-14 11:49:24] [config] after: 0e
[2024-06-14 11:49:24] [config] after-batches: 0
[2024-06-14 11:49:24] [config] after-epochs: 0
[2024-06-14 11:49:24] [config] all-caps-every: 0
[2024-06-14 11:49:24] [config] allow-unk: true
[2024-06-14 11:49:24] [config] authors: false
[2024-06-14 11:49:24] [config] beam-size: 6
[2024-06-14 11:49:24] [config] bert-class-symbol: "[CLS]"
[2024-06-14 11:49:24] [config] bert-mask-symbol: "[MASK]"
[2024-06-14 11:49:24] [config] bert-masking-fraction: 0.15
[2024-06-14 11:49:24] [config] bert-sep-symbol: "[SEP]"
[2024-06-14 11:49:24] [config] bert-train-type-embeddings: true
[2024-06-14 11:49:24] [config] bert-type-vocab-size: 2
[2024-06-14 11:49:24] [config] build-info: ""
[2024-06-14 11:49:24] [config] char-conv-filters-num:
[2024-06-14 11:49:24] [config]   - 200
[2024-06-14 11:49:24] [config]   - 200
[2024-06-14 11:49:24] [config]   - 250
[2024-06-14 11:49:24] [config]   - 250
[2024-06-14 11:49:24] [config]   - 300
[2024-06-14 11:49:24] [config]   - 300
[2024-06-14 11:49:24] [config]   - 300
[2024-06-14 11:49:24] [config]   - 300
[2024-06-14 11:49:24] [config] char-conv-filters-widths:
[2024-06-14 11:49:24] [config]   - 1
[2024-06-14 11:49:24] [config]   - 2
[2024-06-14 11:49:24] [config]   - 3
[2024-06-14 11:49:24] [config]   - 4
[2024-06-14 11:49:24] [config]   - 5
[2024-06-14 11:49:24] [config]   - 6
[2024-06-14 11:49:24] [config]   - 7
[2024-06-14 11:49:24] [config]   - 8
[2024-06-14 11:49:24] [config] char-highway: 4
[2024-06-14 11:49:24] [config] char-stride: 5
[2024-06-14 11:49:24] [config] check-gradient-nan: false
[2024-06-14 11:49:24] [config] check-nan: false
[2024-06-14 11:49:24] [config] cite: false
[2024-06-14 11:49:24] [config] clip-norm: 0
[2024-06-14 11:49:24] [config] cost-scaling:
[2024-06-14 11:49:24] [config]   []
[2024-06-14 11:49:24] [config] cost-type: ce-mean-words
[2024-06-14 11:49:24] [config] cpu-threads: 0
[2024-06-14 11:49:24] [config] data-threads: 8
[2024-06-14 11:49:24] [config] data-weighting: ""
[2024-06-14 11:49:24] [config] data-weighting-type: sentence
[2024-06-14 11:49:24] [config] dec-cell: gru
[2024-06-14 11:49:24] [config] dec-cell-base-depth: 2
[2024-06-14 11:49:24] [config] dec-cell-high-depth: 1
[2024-06-14 11:49:24] [config] dec-depth: 6
[2024-06-14 11:49:24] [config] devices:
[2024-06-14 11:49:24] [config]   - 0
[2024-06-14 11:49:24] [config]   - 1
[2024-06-14 11:49:24] [config]   - 2
[2024-06-14 11:49:24] [config]   - 3
[2024-06-14 11:49:24] [config]   - 4
[2024-06-14 11:49:24] [config]   - 5
[2024-06-14 11:49:24] [config]   - 6
[2024-06-14 11:49:24] [config]   - 7
[2024-06-14 11:49:24] [config] dim-emb: 1024
[2024-06-14 11:49:24] [config] dim-rnn: 1024
[2024-06-14 11:49:24] [config] dim-vocabs:
[2024-06-14 11:49:24] [config]   - 69666
[2024-06-14 11:49:24] [config]   - 69666
[2024-06-14 11:49:24] [config] disp-first: 10
[2024-06-14 11:49:24] [config] disp-freq: 10000
[2024-06-14 11:49:24] [config] disp-label-counts: true
[2024-06-14 11:49:24] [config] dropout-rnn: 0
[2024-06-14 11:49:24] [config] dropout-src: 0
[2024-06-14 11:49:24] [config] dropout-trg: 0
[2024-06-14 11:49:24] [config] dump-config: ""
[2024-06-14 11:49:24] [config] dynamic-gradient-scaling:
[2024-06-14 11:49:24] [config]   []
[2024-06-14 11:49:24] [config] early-stopping: 20
[2024-06-14 11:49:24] [config] early-stopping-on: first
[2024-06-14 11:49:24] [config] embedding-fix-src: false
[2024-06-14 11:49:24] [config] embedding-fix-trg: false
[2024-06-14 11:49:24] [config] embedding-normalization: false
[2024-06-14 11:49:24] [config] embedding-vectors:
[2024-06-14 11:49:24] [config]   []
[2024-06-14 11:49:24] [config] enc-cell: gru
[2024-06-14 11:49:24] [config] enc-cell-depth: 1
[2024-06-14 11:49:24] [config] enc-depth: 6
[2024-06-14 11:49:24] [config] enc-type: bidirectional
[2024-06-14 11:49:24] [config] english-title-case-every: 0
[2024-06-14 11:49:24] [config] exponential-smoothing: 0.0001
[2024-06-14 11:49:24] [config] factor-weight: 1
[2024-06-14 11:49:24] [config] factors-combine: sum
[2024-06-14 11:49:24] [config] factors-dim-emb: 0
[2024-06-14 11:49:24] [config] gradient-checkpointing: false
[2024-06-14 11:49:24] [config] gradient-norm-average-window: 100
[2024-06-14 11:49:24] [config] guided-alignment: none
[2024-06-14 11:49:24] [config] guided-alignment-cost: ce
[2024-06-14 11:49:24] [config] guided-alignment-weight: 0.1
[2024-06-14 11:49:24] [config] ignore-model-config: false
[2024-06-14 11:49:24] [config] input-types:
[2024-06-14 11:49:24] [config]   []
[2024-06-14 11:49:24] [config] interpolate-env-vars: false
[2024-06-14 11:49:24] [config] keep-best: true
[2024-06-14 11:49:24] [config] label-smoothing: 0.1
[2024-06-14 11:49:24] [config] layer-normalization: false
[2024-06-14 11:49:24] [config] learn-rate: 0.0002
[2024-06-14 11:49:24] [config] lemma-dependency: ""
[2024-06-14 11:49:24] [config] lemma-dim-emb: 0
[2024-06-14 11:49:24] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-06-14 11:49:24] [config] log-level: info
[2024-06-14 11:49:24] [config] log-time-zone: ""
[2024-06-14 11:49:24] [config] logical-epoch:
[2024-06-14 11:49:24] [config]   - 1e
[2024-06-14 11:49:24] [config]   - 0
[2024-06-14 11:49:24] [config] lr-decay: 0
[2024-06-14 11:49:24] [config] lr-decay-freq: 50000
[2024-06-14 11:49:24] [config] lr-decay-inv-sqrt:
[2024-06-14 11:49:24] [config]   - 8000
[2024-06-14 11:49:24] [config] lr-decay-repeat-warmup: false
[2024-06-14 11:49:24] [config] lr-decay-reset-optimizer: false
[2024-06-14 11:49:24] [config] lr-decay-start:
[2024-06-14 11:49:24] [config]   - 10
[2024-06-14 11:49:24] [config]   - 1
[2024-06-14 11:49:24] [config] lr-decay-strategy: epoch+stalled
[2024-06-14 11:49:24] [config] lr-report: false
[2024-06-14 11:49:24] [config] lr-warmup: 8000
[2024-06-14 11:49:24] [config] lr-warmup-at-reload: false
[2024-06-14 11:49:24] [config] lr-warmup-cycle: true
[2024-06-14 11:49:24] [config] lr-warmup-start-rate: 0
[2024-06-14 11:49:24] [config] max-length: 100
[2024-06-14 11:49:24] [config] max-length-crop: false
[2024-06-14 11:49:24] [config] max-length-factor: 3
[2024-06-14 11:49:24] [config] maxi-batch: 1000
[2024-06-14 11:49:24] [config] maxi-batch-sort: trg
[2024-06-14 11:49:24] [config] mini-batch: 1000
[2024-06-14 11:49:24] [config] mini-batch-fit: true
[2024-06-14 11:49:24] [config] mini-batch-fit-step: 10
[2024-06-14 11:49:24] [config] mini-batch-round-up: true
[2024-06-14 11:49:24] [config] mini-batch-track-lr: false
[2024-06-14 11:49:24] [config] mini-batch-warmup: 0
[2024-06-14 11:49:24] [config] mini-batch-words: 0
[2024-06-14 11:49:24] [config] mini-batch-words-ref: 0
[2024-06-14 11:49:24] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-14 11:49:24] [config] multi-loss-type: sum
[2024-06-14 11:49:24] [config] n-best: false
[2024-06-14 11:49:24] [config] no-nccl: false
[2024-06-14 11:49:24] [config] no-reload: false
[2024-06-14 11:49:24] [config] no-restore-corpus: false
[2024-06-14 11:49:24] [config] normalize: 1
[2024-06-14 11:49:24] [config] normalize-gradient: false
[2024-06-14 11:49:24] [config] num-devices: 0
[2024-06-14 11:49:24] [config] optimizer: adam
[2024-06-14 11:49:24] [config] optimizer-delay: 10
[2024-06-14 11:49:24] [config] optimizer-params:
[2024-06-14 11:49:24] [config]   - 0.9
[2024-06-14 11:49:24] [config]   - 0.998
[2024-06-14 11:49:24] [config]   - 1e-09
[2024-06-14 11:49:24] [config] output-omit-bias: false
[2024-06-14 11:49:24] [config] overwrite: true
[2024-06-14 11:49:24] [config] precision:
[2024-06-14 11:49:24] [config]   - float32
[2024-06-14 11:49:24] [config]   - float32
[2024-06-14 11:49:24] [config] pretrained-model: ""
[2024-06-14 11:49:24] [config] quantize-biases: false
[2024-06-14 11:49:24] [config] quantize-bits: 0
[2024-06-14 11:49:24] [config] quantize-log-based: false
[2024-06-14 11:49:24] [config] quantize-optimization-steps: 0
[2024-06-14 11:49:24] [config] quiet: false
[2024-06-14 11:49:24] [config] quiet-translation: false
[2024-06-14 11:49:24] [config] relative-paths: false
[2024-06-14 11:49:24] [config] right-left: false
[2024-06-14 11:49:24] [config] save-freq: 10000
[2024-06-14 11:49:24] [config] seed: 2222
[2024-06-14 11:49:24] [config] sentencepiece-alphas:
[2024-06-14 11:49:24] [config]   []
[2024-06-14 11:49:24] [config] sentencepiece-max-lines: 2000000
[2024-06-14 11:49:24] [config] sentencepiece-options: ""
[2024-06-14 11:49:24] [config] sharding: local
[2024-06-14 11:49:24] [config] shuffle: batches
[2024-06-14 11:49:24] [config] shuffle-in-ram: false
[2024-06-14 11:49:24] [config] sigterm: save-and-exit
[2024-06-14 11:49:24] [config] skip: false
[2024-06-14 11:49:24] [config] sqlite: ""
[2024-06-14 11:49:24] [config] sqlite-drop: false
[2024-06-14 11:49:24] [config] sync-freq: 200u
[2024-06-14 11:49:24] [config] sync-sgd: true
[2024-06-14 11:49:24] [config] tempdir: /scratch/project_462000447/tmp
[2024-06-14 11:49:24] [config] tied-embeddings: false
[2024-06-14 11:49:24] [config] tied-embeddings-all: true
[2024-06-14 11:49:24] [config] tied-embeddings-src: false
[2024-06-14 11:49:24] [config] train-embedder-rank:
[2024-06-14 11:49:24] [config]   []
[2024-06-14 11:49:24] [config] train-sets:
[2024-06-14 11:49:24] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-06-14 11:49:24] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-06-14 11:49:24] [config] transformer-aan-activation: swish
[2024-06-14 11:49:24] [config] transformer-aan-depth: 2
[2024-06-14 11:49:24] [config] transformer-aan-nogate: false
[2024-06-14 11:49:24] [config] transformer-decoder-autoreg: self-attention
[2024-06-14 11:49:24] [config] transformer-decoder-dim-ffn: 0
[2024-06-14 11:49:24] [config] transformer-decoder-ffn-depth: 0
[2024-06-14 11:49:24] [config] transformer-depth-scaling: false
[2024-06-14 11:49:24] [config] transformer-dim-aan: 2048
[2024-06-14 11:49:24] [config] transformer-dim-ffn: 4096
[2024-06-14 11:49:24] [config] transformer-dropout: 0.1
[2024-06-14 11:49:24] [config] transformer-dropout-attention: 0
[2024-06-14 11:49:24] [config] transformer-dropout-ffn: 0
[2024-06-14 11:49:24] [config] transformer-ffn-activation: relu
[2024-06-14 11:49:24] [config] transformer-ffn-depth: 2
[2024-06-14 11:49:24] [config] transformer-guided-alignment-layer: last
[2024-06-14 11:49:24] [config] transformer-heads: 16
[2024-06-14 11:49:24] [config] transformer-no-projection: false
[2024-06-14 11:49:24] [config] transformer-pool: false
[2024-06-14 11:49:24] [config] transformer-postprocess: dan
[2024-06-14 11:49:24] [config] transformer-postprocess-emb: d
[2024-06-14 11:49:24] [config] transformer-postprocess-top: ""
[2024-06-14 11:49:24] [config] transformer-preprocess: ""
[2024-06-14 11:49:24] [config] transformer-rnn-projection: false
[2024-06-14 11:49:24] [config] transformer-tied-layers:
[2024-06-14 11:49:24] [config]   []
[2024-06-14 11:49:24] [config] transformer-train-position-embeddings: false
[2024-06-14 11:49:24] [config] tsv: false
[2024-06-14 11:49:24] [config] tsv-fields: 0
[2024-06-14 11:49:24] [config] type: transformer
[2024-06-14 11:49:24] [config] ulr: false
[2024-06-14 11:49:24] [config] ulr-dim-emb: 0
[2024-06-14 11:49:24] [config] ulr-dropout: 0
[2024-06-14 11:49:24] [config] ulr-keys-vectors: ""
[2024-06-14 11:49:24] [config] ulr-query-vectors: ""
[2024-06-14 11:49:24] [config] ulr-softmax-temperature: 1
[2024-06-14 11:49:24] [config] ulr-trainable-transformation: false
[2024-06-14 11:49:24] [config] unlikelihood-loss: false
[2024-06-14 11:49:24] [config] valid-freq: 10000
[2024-06-14 11:49:24] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-06-14 11:49:24] [config] valid-max-length: 100
[2024-06-14 11:49:24] [config] valid-metrics:
[2024-06-14 11:49:24] [config]   - perplexity
[2024-06-14 11:49:24] [config] valid-mini-batch: 16
[2024-06-14 11:49:24] [config] valid-reset-stalled: false
[2024-06-14 11:49:24] [config] valid-script-args:
[2024-06-14 11:49:24] [config]   []
[2024-06-14 11:49:24] [config] valid-script-path: ""
[2024-06-14 11:49:24] [config] valid-sets:
[2024-06-14 11:49:24] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-06-14 11:49:24] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-06-14 11:49:24] [config] valid-translation-output: ""
[2024-06-14 11:49:24] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-14 11:49:24] [config] vocabs:
[2024-06-14 11:49:24] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-14 11:49:24] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-14 11:49:24] [config] word-penalty: 0
[2024-06-14 11:49:24] [config] word-scores: false
[2024-06-14 11:49:24] [config] workspace: 20000
[2024-06-14 11:49:24] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-14 11:49:24] Using synchronous SGD
[2024-06-14 11:49:24] [comm] Compiled without MPI support. Running as a single process on nid007921
[2024-06-14 11:49:24] Synced seed 2222
[2024-06-14 11:49:24] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-14 11:49:25] [data] Setting vocabulary size for input 0 to 69,666
[2024-06-14 11:49:25] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-14 11:49:25] [data] Setting vocabulary size for input 1 to 69,666
[2024-06-14 11:49:25] [batching] Collecting statistics for batch fitting with step size 10
[2024-06-14 11:49:27] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-14 11:49:27] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-14 11:49:27] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-14 11:49:27] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-14 11:49:27] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-14 11:49:27] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-14 11:49:27] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-14 11:49:27] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-14 11:49:27] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-14 11:49:29] [comm] Using global sharding
[2024-06-14 11:49:30] [comm] NCCLCommunicators constructed successfully
[2024-06-14 11:49:30] [training] Using 8 GPUs
[2024-06-14 11:49:30] [logits] Applying loss function for 1 factor(s)
[2024-06-14 11:49:30] [memory] Reserving 945 MB, device gpu0
[2024-06-14 11:49:35] [memory] Reserving 945 MB, device gpu0
[2024-06-14 11:50:09] [batching] Done. Typical MB size is 699,120 target words
[2024-06-14 11:50:09] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-14 11:50:09] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-14 11:50:09] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-14 11:50:09] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-14 11:50:09] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-14 11:50:09] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-14 11:50:09] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-14 11:50:09] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-14 11:50:09] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-14 11:50:09] [comm] Using global sharding
[2024-06-14 11:50:10] [comm] NCCLCommunicators constructed successfully
[2024-06-14 11:50:10] [training] Using 8 GPUs
[2024-06-14 11:50:10] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-14 11:50:27] Allocating memory for general optimizer shards
[2024-06-14 11:50:27] [memory] Reserving 118 MB, device gpu0
[2024-06-14 11:50:27] [memory] Reserving 118 MB, device gpu1
[2024-06-14 11:50:28] [memory] Reserving 118 MB, device gpu2
[2024-06-14 11:50:28] [memory] Reserving 118 MB, device gpu3
[2024-06-14 11:50:28] [memory] Reserving 118 MB, device gpu4
[2024-06-14 11:50:28] [memory] Reserving 118 MB, device gpu5
[2024-06-14 11:50:28] [memory] Reserving 118 MB, device gpu6
[2024-06-14 11:50:28] [memory] Reserving 118 MB, device gpu7
[2024-06-14 11:50:28] Loading Adam parameters
[2024-06-14 11:50:30] [memory] Reserving 236 MB, device gpu0
[2024-06-14 11:50:30] [memory] Reserving 236 MB, device gpu1
[2024-06-14 11:50:30] [memory] Reserving 236 MB, device gpu2
[2024-06-14 11:50:30] [memory] Reserving 236 MB, device gpu3
[2024-06-14 11:50:30] [memory] Reserving 236 MB, device gpu4
[2024-06-14 11:50:30] [memory] Reserving 236 MB, device gpu5
[2024-06-14 11:50:31] [memory] Reserving 236 MB, device gpu6
[2024-06-14 11:50:31] [memory] Reserving 236 MB, device gpu7
[2024-06-14 11:50:31] [memory] Reserving 945 MB, device gpu0
[2024-06-14 11:50:31] [memory] Reserving 945 MB, device gpu1
[2024-06-14 11:50:32] [memory] Reserving 945 MB, device gpu2
[2024-06-14 11:50:32] [memory] Reserving 945 MB, device gpu3
[2024-06-14 11:50:32] [memory] Reserving 945 MB, device gpu4
[2024-06-14 11:50:33] [memory] Reserving 945 MB, device gpu5
[2024-06-14 11:50:33] [memory] Reserving 945 MB, device gpu6
[2024-06-14 11:50:33] [memory] Reserving 945 MB, device gpu7
[2024-06-14 11:50:34] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-14 11:50:34] [data] Restoring the corpus state to epoch 1, batch 80000
[2024-06-14 13:13:02] Training started
[2024-06-14 13:13:02] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-06-14 13:13:17] [memory] Reserving 945 MB, device gpu0
[2024-06-14 13:13:28] [memory] Reserving 945 MB, device gpu6
[2024-06-14 13:13:28] [memory] Reserving 945 MB, device gpu4
[2024-06-14 13:13:28] [memory] Reserving 945 MB, device gpu7
[2024-06-14 13:13:28] [memory] Reserving 945 MB, device gpu1
[2024-06-14 13:13:28] [memory] Reserving 945 MB, device gpu2
[2024-06-14 13:13:28] [memory] Reserving 945 MB, device gpu5
[2024-06-14 13:13:28] [memory] Reserving 945 MB, device gpu3
[2024-06-14 13:13:32] Parameter type float32, optimization type float32, casting types false
[2024-06-14 21:20:12] Ep. 1 : Up. 90000 : Sen. 691,163,255 : Cost 3.17655134 : Time 34202.79s : 79111.04 words/s : gNorm 1.0714
[2024-06-14 21:20:12] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-14 21:20:16] Saving Adam parameters
[2024-06-14 21:20:24] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-14 21:20:38] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-14 21:20:41] [valid] Ep. 1 : Up. 90000 : perplexity : 12.0192 : new best
[2024-06-15 05:27:27] Ep. 1 : Up. 100000 : Sen. 767,899,723 : Cost 3.17206740 : Time 29235.36s : 92390.98 words/s : gNorm 1.4129
[2024-06-15 05:27:27] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-15 05:27:32] Saving Adam parameters
[2024-06-15 05:27:39] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-15 05:27:53] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-15 05:27:56] [valid] Ep. 1 : Up. 100000 : perplexity : 11.9961 : new best
[2024-06-15 13:35:34] Ep. 1 : Up. 110000 : Sen. 844,743,688 : Cost 3.17017794 : Time 29287.13s : 92463.99 words/s : gNorm 1.2171
[2024-06-15 13:35:34] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-15 13:35:39] Saving Adam parameters
[2024-06-15 13:35:47] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-15 13:36:01] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-15 13:36:03] [valid] Ep. 1 : Up. 110000 : perplexity : 11.9804 : new best
[2024-06-15 21:43:47] Ep. 1 : Up. 120000 : Sen. 921,669,289 : Cost 3.16929626 : Time 29292.55s : 92432.08 words/s : gNorm 1.4233
[2024-06-15 21:43:47] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-15 21:43:52] Saving Adam parameters
[2024-06-15 21:43:59] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-15 21:44:13] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-15 21:44:16] [valid] Ep. 1 : Up. 120000 : perplexity : 11.9639 : new best
[2024-06-16 05:51:13] Ep. 1 : Up. 130000 : Sen. 998,452,778 : Cost 3.16377926 : Time 29246.57s : 92442.49 words/s : gNorm 0.8294
[2024-06-16 05:51:14] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-16 05:51:18] Saving Adam parameters
[2024-06-16 05:51:26] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-16 05:51:40] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-16 05:51:42] [valid] Ep. 1 : Up. 130000 : perplexity : 11.9424 : new best
[2024-06-16 13:58:43] Ep. 1 : Up. 140000 : Sen. 1,075,311,877 : Cost 3.16118336 : Time 29249.07s : 92521.60 words/s : gNorm 1.1620
[2024-06-16 13:58:43] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-16 13:58:47] Saving Adam parameters
[2024-06-16 13:58:55] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-16 13:59:09] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-16 13:59:12] [valid] Ep. 1 : Up. 140000 : perplexity : 11.9239 : new best
[2024-06-16 22:06:13] Ep. 1 : Up. 150000 : Sen. 1,152,122,305 : Cost 3.15985513 : Time 29250.14s : 92452.82 words/s : gNorm 1.0669
[2024-06-16 22:06:13] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-16 22:06:18] Saving Adam parameters
[2024-06-16 22:06:25] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-16 22:06:39] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-16 22:06:42] [valid] Ep. 1 : Up. 150000 : perplexity : 11.9074 : new best
[2024-06-17 06:13:12] Ep. 1 : Up. 160000 : Sen. 1,228,879,116 : Cost 3.15938592 : Time 29218.57s : 92529.32 words/s : gNorm 1.6095
[2024-06-17 06:13:12] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-17 06:13:16] Saving Adam parameters
[2024-06-17 06:13:24] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-17 06:13:38] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-17 06:13:41] [valid] Ep. 1 : Up. 160000 : perplexity : 11.8919 : new best
[2024-06-19 00:40:37] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-19 00:40:37] [marian] Running on nid005056 as process 119109 with command line:
[2024-06-19 00:40:37] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-06-19 00:40:38] [config] after: 0e
[2024-06-19 00:40:38] [config] after-batches: 0
[2024-06-19 00:40:38] [config] after-epochs: 0
[2024-06-19 00:40:38] [config] all-caps-every: 0
[2024-06-19 00:40:38] [config] allow-unk: true
[2024-06-19 00:40:38] [config] authors: false
[2024-06-19 00:40:38] [config] beam-size: 6
[2024-06-19 00:40:38] [config] bert-class-symbol: "[CLS]"
[2024-06-19 00:40:38] [config] bert-mask-symbol: "[MASK]"
[2024-06-19 00:40:38] [config] bert-masking-fraction: 0.15
[2024-06-19 00:40:38] [config] bert-sep-symbol: "[SEP]"
[2024-06-19 00:40:38] [config] bert-train-type-embeddings: true
[2024-06-19 00:40:38] [config] bert-type-vocab-size: 2
[2024-06-19 00:40:38] [config] build-info: ""
[2024-06-19 00:40:38] [config] char-conv-filters-num:
[2024-06-19 00:40:38] [config]   - 200
[2024-06-19 00:40:38] [config]   - 200
[2024-06-19 00:40:38] [config]   - 250
[2024-06-19 00:40:38] [config]   - 250
[2024-06-19 00:40:38] [config]   - 300
[2024-06-19 00:40:38] [config]   - 300
[2024-06-19 00:40:38] [config]   - 300
[2024-06-19 00:40:38] [config]   - 300
[2024-06-19 00:40:38] [config] char-conv-filters-widths:
[2024-06-19 00:40:38] [config]   - 1
[2024-06-19 00:40:38] [config]   - 2
[2024-06-19 00:40:38] [config]   - 3
[2024-06-19 00:40:38] [config]   - 4
[2024-06-19 00:40:38] [config]   - 5
[2024-06-19 00:40:38] [config]   - 6
[2024-06-19 00:40:38] [config]   - 7
[2024-06-19 00:40:38] [config]   - 8
[2024-06-19 00:40:38] [config] char-highway: 4
[2024-06-19 00:40:38] [config] char-stride: 5
[2024-06-19 00:40:38] [config] check-gradient-nan: false
[2024-06-19 00:40:38] [config] check-nan: false
[2024-06-19 00:40:38] [config] cite: false
[2024-06-19 00:40:38] [config] clip-norm: 0
[2024-06-19 00:40:38] [config] cost-scaling:
[2024-06-19 00:40:38] [config]   []
[2024-06-19 00:40:38] [config] cost-type: ce-mean-words
[2024-06-19 00:40:38] [config] cpu-threads: 0
[2024-06-19 00:40:38] [config] data-threads: 8
[2024-06-19 00:40:38] [config] data-weighting: ""
[2024-06-19 00:40:38] [config] data-weighting-type: sentence
[2024-06-19 00:40:38] [config] dec-cell: gru
[2024-06-19 00:40:38] [config] dec-cell-base-depth: 2
[2024-06-19 00:40:38] [config] dec-cell-high-depth: 1
[2024-06-19 00:40:38] [config] dec-depth: 6
[2024-06-19 00:40:38] [config] devices:
[2024-06-19 00:40:38] [config]   - 0
[2024-06-19 00:40:38] [config]   - 1
[2024-06-19 00:40:38] [config]   - 2
[2024-06-19 00:40:38] [config]   - 3
[2024-06-19 00:40:38] [config]   - 4
[2024-06-19 00:40:38] [config]   - 5
[2024-06-19 00:40:38] [config]   - 6
[2024-06-19 00:40:38] [config]   - 7
[2024-06-19 00:40:38] [config] dim-emb: 1024
[2024-06-19 00:40:38] [config] dim-rnn: 1024
[2024-06-19 00:40:38] [config] dim-vocabs:
[2024-06-19 00:40:38] [config]   - 69666
[2024-06-19 00:40:38] [config]   - 69666
[2024-06-19 00:40:38] [config] disp-first: 10
[2024-06-19 00:40:38] [config] disp-freq: 10000
[2024-06-19 00:40:38] [config] disp-label-counts: true
[2024-06-19 00:40:38] [config] dropout-rnn: 0
[2024-06-19 00:40:38] [config] dropout-src: 0
[2024-06-19 00:40:38] [config] dropout-trg: 0
[2024-06-19 00:40:38] [config] dump-config: ""
[2024-06-19 00:40:38] [config] dynamic-gradient-scaling:
[2024-06-19 00:40:38] [config]   []
[2024-06-19 00:40:38] [config] early-stopping: 20
[2024-06-19 00:40:38] [config] early-stopping-on: first
[2024-06-19 00:40:38] [config] embedding-fix-src: false
[2024-06-19 00:40:38] [config] embedding-fix-trg: false
[2024-06-19 00:40:38] [config] embedding-normalization: false
[2024-06-19 00:40:38] [config] embedding-vectors:
[2024-06-19 00:40:38] [config]   []
[2024-06-19 00:40:38] [config] enc-cell: gru
[2024-06-19 00:40:38] [config] enc-cell-depth: 1
[2024-06-19 00:40:38] [config] enc-depth: 6
[2024-06-19 00:40:38] [config] enc-type: bidirectional
[2024-06-19 00:40:38] [config] english-title-case-every: 0
[2024-06-19 00:40:38] [config] exponential-smoothing: 0.0001
[2024-06-19 00:40:38] [config] factor-weight: 1
[2024-06-19 00:40:38] [config] factors-combine: sum
[2024-06-19 00:40:38] [config] factors-dim-emb: 0
[2024-06-19 00:40:38] [config] gradient-checkpointing: false
[2024-06-19 00:40:38] [config] gradient-norm-average-window: 100
[2024-06-19 00:40:38] [config] guided-alignment: none
[2024-06-19 00:40:38] [config] guided-alignment-cost: ce
[2024-06-19 00:40:38] [config] guided-alignment-weight: 0.1
[2024-06-19 00:40:38] [config] ignore-model-config: false
[2024-06-19 00:40:38] [config] input-types:
[2024-06-19 00:40:38] [config]   []
[2024-06-19 00:40:38] [config] interpolate-env-vars: false
[2024-06-19 00:40:38] [config] keep-best: true
[2024-06-19 00:40:38] [config] label-smoothing: 0.1
[2024-06-19 00:40:38] [config] layer-normalization: false
[2024-06-19 00:40:38] [config] learn-rate: 0.0002
[2024-06-19 00:40:38] [config] lemma-dependency: ""
[2024-06-19 00:40:38] [config] lemma-dim-emb: 0
[2024-06-19 00:40:38] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-06-19 00:40:38] [config] log-level: info
[2024-06-19 00:40:38] [config] log-time-zone: ""
[2024-06-19 00:40:38] [config] logical-epoch:
[2024-06-19 00:40:38] [config]   - 1e
[2024-06-19 00:40:38] [config]   - 0
[2024-06-19 00:40:38] [config] lr-decay: 0
[2024-06-19 00:40:38] [config] lr-decay-freq: 50000
[2024-06-19 00:40:38] [config] lr-decay-inv-sqrt:
[2024-06-19 00:40:38] [config]   - 8000
[2024-06-19 00:40:38] [config] lr-decay-repeat-warmup: false
[2024-06-19 00:40:38] [config] lr-decay-reset-optimizer: false
[2024-06-19 00:40:38] [config] lr-decay-start:
[2024-06-19 00:40:38] [config]   - 10
[2024-06-19 00:40:38] [config]   - 1
[2024-06-19 00:40:38] [config] lr-decay-strategy: epoch+stalled
[2024-06-19 00:40:38] [config] lr-report: false
[2024-06-19 00:40:38] [config] lr-warmup: 8000
[2024-06-19 00:40:38] [config] lr-warmup-at-reload: false
[2024-06-19 00:40:38] [config] lr-warmup-cycle: true
[2024-06-19 00:40:38] [config] lr-warmup-start-rate: 0
[2024-06-19 00:40:38] [config] max-length: 100
[2024-06-19 00:40:38] [config] max-length-crop: false
[2024-06-19 00:40:38] [config] max-length-factor: 3
[2024-06-19 00:40:38] [config] maxi-batch: 1000
[2024-06-19 00:40:38] [config] maxi-batch-sort: trg
[2024-06-19 00:40:38] [config] mini-batch: 1000
[2024-06-19 00:40:38] [config] mini-batch-fit: true
[2024-06-19 00:40:38] [config] mini-batch-fit-step: 10
[2024-06-19 00:40:38] [config] mini-batch-round-up: true
[2024-06-19 00:40:38] [config] mini-batch-track-lr: false
[2024-06-19 00:40:38] [config] mini-batch-warmup: 0
[2024-06-19 00:40:38] [config] mini-batch-words: 0
[2024-06-19 00:40:38] [config] mini-batch-words-ref: 0
[2024-06-19 00:40:38] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-19 00:40:38] [config] multi-loss-type: sum
[2024-06-19 00:40:38] [config] n-best: false
[2024-06-19 00:40:38] [config] no-nccl: false
[2024-06-19 00:40:38] [config] no-reload: false
[2024-06-19 00:40:38] [config] no-restore-corpus: false
[2024-06-19 00:40:38] [config] normalize: 1
[2024-06-19 00:40:38] [config] normalize-gradient: false
[2024-06-19 00:40:38] [config] num-devices: 0
[2024-06-19 00:40:38] [config] optimizer: adam
[2024-06-19 00:40:38] [config] optimizer-delay: 10
[2024-06-19 00:40:38] [config] optimizer-params:
[2024-06-19 00:40:38] [config]   - 0.9
[2024-06-19 00:40:38] [config]   - 0.998
[2024-06-19 00:40:38] [config]   - 1e-09
[2024-06-19 00:40:38] [config] output-omit-bias: false
[2024-06-19 00:40:38] [config] overwrite: true
[2024-06-19 00:40:38] [config] precision:
[2024-06-19 00:40:38] [config]   - float32
[2024-06-19 00:40:38] [config]   - float32
[2024-06-19 00:40:38] [config] pretrained-model: ""
[2024-06-19 00:40:38] [config] quantize-biases: false
[2024-06-19 00:40:38] [config] quantize-bits: 0
[2024-06-19 00:40:38] [config] quantize-log-based: false
[2024-06-19 00:40:38] [config] quantize-optimization-steps: 0
[2024-06-19 00:40:38] [config] quiet: false
[2024-06-19 00:40:38] [config] quiet-translation: false
[2024-06-19 00:40:38] [config] relative-paths: false
[2024-06-19 00:40:38] [config] right-left: false
[2024-06-19 00:40:38] [config] save-freq: 10000
[2024-06-19 00:40:38] [config] seed: 2222
[2024-06-19 00:40:38] [config] sentencepiece-alphas:
[2024-06-19 00:40:38] [config]   []
[2024-06-19 00:40:38] [config] sentencepiece-max-lines: 2000000
[2024-06-19 00:40:38] [config] sentencepiece-options: ""
[2024-06-19 00:40:38] [config] sharding: local
[2024-06-19 00:40:38] [config] shuffle: batches
[2024-06-19 00:40:38] [config] shuffle-in-ram: false
[2024-06-19 00:40:38] [config] sigterm: save-and-exit
[2024-06-19 00:40:38] [config] skip: false
[2024-06-19 00:40:38] [config] sqlite: ""
[2024-06-19 00:40:38] [config] sqlite-drop: false
[2024-06-19 00:40:38] [config] sync-freq: 200u
[2024-06-19 00:40:38] [config] sync-sgd: true
[2024-06-19 00:40:38] [config] tempdir: /scratch/project_462000447/tmp
[2024-06-19 00:40:38] [config] tied-embeddings: false
[2024-06-19 00:40:38] [config] tied-embeddings-all: true
[2024-06-19 00:40:38] [config] tied-embeddings-src: false
[2024-06-19 00:40:38] [config] train-embedder-rank:
[2024-06-19 00:40:38] [config]   []
[2024-06-19 00:40:38] [config] train-sets:
[2024-06-19 00:40:38] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-06-19 00:40:38] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-06-19 00:40:38] [config] transformer-aan-activation: swish
[2024-06-19 00:40:38] [config] transformer-aan-depth: 2
[2024-06-19 00:40:38] [config] transformer-aan-nogate: false
[2024-06-19 00:40:38] [config] transformer-decoder-autoreg: self-attention
[2024-06-19 00:40:38] [config] transformer-decoder-dim-ffn: 0
[2024-06-19 00:40:38] [config] transformer-decoder-ffn-depth: 0
[2024-06-19 00:40:38] [config] transformer-depth-scaling: false
[2024-06-19 00:40:38] [config] transformer-dim-aan: 2048
[2024-06-19 00:40:38] [config] transformer-dim-ffn: 4096
[2024-06-19 00:40:38] [config] transformer-dropout: 0.1
[2024-06-19 00:40:38] [config] transformer-dropout-attention: 0
[2024-06-19 00:40:38] [config] transformer-dropout-ffn: 0
[2024-06-19 00:40:38] [config] transformer-ffn-activation: relu
[2024-06-19 00:40:38] [config] transformer-ffn-depth: 2
[2024-06-19 00:40:38] [config] transformer-guided-alignment-layer: last
[2024-06-19 00:40:38] [config] transformer-heads: 16
[2024-06-19 00:40:38] [config] transformer-no-projection: false
[2024-06-19 00:40:38] [config] transformer-pool: false
[2024-06-19 00:40:38] [config] transformer-postprocess: dan
[2024-06-19 00:40:38] [config] transformer-postprocess-emb: d
[2024-06-19 00:40:38] [config] transformer-postprocess-top: ""
[2024-06-19 00:40:38] [config] transformer-preprocess: ""
[2024-06-19 00:40:38] [config] transformer-rnn-projection: false
[2024-06-19 00:40:38] [config] transformer-tied-layers:
[2024-06-19 00:40:38] [config]   []
[2024-06-19 00:40:38] [config] transformer-train-position-embeddings: false
[2024-06-19 00:40:38] [config] tsv: false
[2024-06-19 00:40:38] [config] tsv-fields: 0
[2024-06-19 00:40:38] [config] type: transformer
[2024-06-19 00:40:38] [config] ulr: false
[2024-06-19 00:40:38] [config] ulr-dim-emb: 0
[2024-06-19 00:40:38] [config] ulr-dropout: 0
[2024-06-19 00:40:38] [config] ulr-keys-vectors: ""
[2024-06-19 00:40:38] [config] ulr-query-vectors: ""
[2024-06-19 00:40:38] [config] ulr-softmax-temperature: 1
[2024-06-19 00:40:38] [config] ulr-trainable-transformation: false
[2024-06-19 00:40:38] [config] unlikelihood-loss: false
[2024-06-19 00:40:38] [config] valid-freq: 10000
[2024-06-19 00:40:38] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-06-19 00:40:38] [config] valid-max-length: 100
[2024-06-19 00:40:38] [config] valid-metrics:
[2024-06-19 00:40:38] [config]   - perplexity
[2024-06-19 00:40:38] [config] valid-mini-batch: 16
[2024-06-19 00:40:38] [config] valid-reset-stalled: false
[2024-06-19 00:40:38] [config] valid-script-args:
[2024-06-19 00:40:38] [config]   []
[2024-06-19 00:40:38] [config] valid-script-path: ""
[2024-06-19 00:40:38] [config] valid-sets:
[2024-06-19 00:40:38] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-06-19 00:40:38] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-06-19 00:40:38] [config] valid-translation-output: ""
[2024-06-19 00:40:38] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-19 00:40:38] [config] vocabs:
[2024-06-19 00:40:38] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-19 00:40:38] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-19 00:40:38] [config] word-penalty: 0
[2024-06-19 00:40:38] [config] word-scores: false
[2024-06-19 00:40:38] [config] workspace: 20000
[2024-06-19 00:40:38] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-19 00:40:38] Using synchronous SGD
[2024-06-19 00:40:38] [comm] Compiled without MPI support. Running as a single process on nid005056
[2024-06-19 00:40:38] Synced seed 2222
[2024-06-19 00:40:38] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-19 00:40:39] [data] Setting vocabulary size for input 0 to 69,666
[2024-06-19 00:40:39] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-19 00:40:39] [data] Setting vocabulary size for input 1 to 69,666
[2024-06-19 00:40:39] [batching] Collecting statistics for batch fitting with step size 10
[2024-06-19 00:40:41] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-19 00:40:41] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-19 00:40:41] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-19 00:40:41] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-19 00:40:41] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-19 00:40:41] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-19 00:40:41] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-19 00:40:41] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-19 00:40:41] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-19 00:40:43] [comm] Using global sharding
[2024-06-19 00:40:44] [comm] NCCLCommunicators constructed successfully
[2024-06-19 00:40:44] [training] Using 8 GPUs
[2024-06-19 00:40:44] [logits] Applying loss function for 1 factor(s)
[2024-06-19 00:40:44] [memory] Reserving 945 MB, device gpu0
[2024-06-19 00:40:49] [memory] Reserving 945 MB, device gpu0
[2024-06-19 00:41:23] [batching] Done. Typical MB size is 699,120 target words
[2024-06-19 00:41:23] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-19 00:41:23] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-19 00:41:23] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-19 00:41:23] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-19 00:41:23] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-19 00:41:23] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-19 00:41:23] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-19 00:41:23] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-19 00:41:23] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-19 00:41:23] [comm] Using global sharding
[2024-06-19 00:41:24] [comm] NCCLCommunicators constructed successfully
[2024-06-19 00:41:24] [training] Using 8 GPUs
[2024-06-19 00:41:24] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-19 00:41:42] Allocating memory for general optimizer shards
[2024-06-19 00:41:42] [memory] Reserving 118 MB, device gpu0
[2024-06-19 00:41:42] [memory] Reserving 118 MB, device gpu1
[2024-06-19 00:41:42] [memory] Reserving 118 MB, device gpu2
[2024-06-19 00:41:42] [memory] Reserving 118 MB, device gpu3
[2024-06-19 00:41:42] [memory] Reserving 118 MB, device gpu4
[2024-06-19 00:41:42] [memory] Reserving 118 MB, device gpu5
[2024-06-19 00:41:42] [memory] Reserving 118 MB, device gpu6
[2024-06-19 00:41:42] [memory] Reserving 118 MB, device gpu7
[2024-06-19 00:41:42] Loading Adam parameters
[2024-06-19 00:41:44] [memory] Reserving 236 MB, device gpu0
[2024-06-19 00:41:44] [memory] Reserving 236 MB, device gpu1
[2024-06-19 00:41:44] [memory] Reserving 236 MB, device gpu2
[2024-06-19 00:41:45] [memory] Reserving 236 MB, device gpu3
[2024-06-19 00:41:45] [memory] Reserving 236 MB, device gpu4
[2024-06-19 00:41:45] [memory] Reserving 236 MB, device gpu5
[2024-06-19 00:41:45] [memory] Reserving 236 MB, device gpu6
[2024-06-19 00:41:45] [memory] Reserving 236 MB, device gpu7
[2024-06-19 00:41:46] [memory] Reserving 945 MB, device gpu0
[2024-06-19 00:41:46] [memory] Reserving 945 MB, device gpu1
[2024-06-19 00:41:46] [memory] Reserving 945 MB, device gpu2
[2024-06-19 00:41:46] [memory] Reserving 945 MB, device gpu3
[2024-06-19 00:41:47] [memory] Reserving 945 MB, device gpu4
[2024-06-19 00:41:47] [memory] Reserving 945 MB, device gpu5
[2024-06-19 00:41:47] [memory] Reserving 945 MB, device gpu6
[2024-06-19 00:41:47] [memory] Reserving 945 MB, device gpu7
[2024-06-19 00:41:48] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-19 00:41:48] [data] Restoring the corpus state to epoch 1, batch 160000
[2024-06-19 03:27:54] Training started
[2024-06-19 03:27:54] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-06-19 03:28:15] [memory] Reserving 945 MB, device gpu0
[2024-06-19 03:28:19] [memory] Reserving 945 MB, device gpu7
[2024-06-19 03:28:19] [memory] Reserving 945 MB, device gpu6
[2024-06-19 03:28:19] [memory] Reserving 945 MB, device gpu2
[2024-06-19 03:28:19] [memory] Reserving 945 MB, device gpu3
[2024-06-19 03:28:19] [memory] Reserving 945 MB, device gpu1
[2024-06-19 03:28:19] [memory] Reserving 945 MB, device gpu4
[2024-06-19 03:28:19] [memory] Reserving 945 MB, device gpu5
[2024-06-19 03:28:21] Parameter type float32, optimization type float32, casting types false
[2024-06-19 11:27:44] Ep. 1 : Up. 170000 : Sen. 1,305,685,305 : Cost 3.15542030 : Time 38780.84s : 69734.99 words/s : gNorm 0.8380
[2024-06-19 11:27:44] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-19 11:27:49] Saving Adam parameters
[2024-06-19 11:27:56] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-19 11:28:10] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-19 11:28:13] [valid] Ep. 1 : Up. 170000 : perplexity : 11.8794 : new best
[2024-06-19 19:27:59] Ep. 1 : Up. 180000 : Sen. 1,382,506,838 : Cost 3.15316796 : Time 28814.95s : 93860.57 words/s : gNorm 1.1219
[2024-06-19 19:27:59] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-19 19:28:04] Saving Adam parameters
[2024-06-19 19:28:12] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-19 19:28:25] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-19 19:28:28] [valid] Ep. 1 : Up. 180000 : perplexity : 11.8706 : new best
[2024-06-20 03:28:30] Ep. 1 : Up. 190000 : Sen. 1,459,328,446 : Cost 3.15208673 : Time 28831.04s : 93828.35 words/s : gNorm 1.5528
[2024-06-20 03:28:30] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-20 03:28:35] Saving Adam parameters
[2024-06-20 03:28:43] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-20 03:28:57] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-20 03:28:59] [valid] Ep. 1 : Up. 190000 : perplexity : 11.859 : new best
[2024-06-20 11:29:06] Ep. 1 : Up. 200000 : Sen. 1,536,170,211 : Cost 3.15204096 : Time 28835.52s : 93866.49 words/s : gNorm 1.1565
[2024-06-20 11:29:06] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-20 11:29:11] Saving Adam parameters
[2024-06-20 11:29:18] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-20 11:29:32] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-20 11:29:35] [valid] Ep. 1 : Up. 200000 : perplexity : 11.8425 : new best
[2024-06-20 19:29:25] Ep. 1 : Up. 210000 : Sen. 1,613,078,882 : Cost 3.14865875 : Time 28818.83s : 93942.89 words/s : gNorm 0.9858
[2024-06-20 19:29:25] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-20 19:29:29] Saving Adam parameters
[2024-06-20 19:29:37] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-20 19:29:51] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-20 19:29:54] [valid] Ep. 1 : Up. 210000 : perplexity : 11.8367 : new best
[2024-06-21 03:29:30] Ep. 1 : Up. 220000 : Sen. 1,689,825,937 : Cost 3.14688420 : Time 28805.11s : 93795.06 words/s : gNorm 1.2726
[2024-06-21 03:29:30] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-21 03:29:34] Saving Adam parameters
[2024-06-21 03:29:42] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-21 03:29:56] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-21 03:29:59] [valid] Ep. 1 : Up. 220000 : perplexity : 11.8281 : new best
[2024-06-21 11:29:56] Ep. 1 : Up. 230000 : Sen. 1,766,614,774 : Cost 3.14613628 : Time 28825.92s : 93871.54 words/s : gNorm 1.0736
[2024-06-21 11:29:56] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-21 11:30:01] Saving Adam parameters
[2024-06-21 11:30:08] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-21 11:30:22] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-21 11:30:25] [valid] Ep. 1 : Up. 230000 : perplexity : 11.82 : new best
[2024-06-21 19:30:06] Ep. 1 : Up. 240000 : Sen. 1,843,489,432 : Cost 3.14662647 : Time 28810.57s : 93815.99 words/s : gNorm 1.1351
[2024-06-21 19:30:06] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-21 19:30:11] Saving Adam parameters
[2024-06-21 19:30:19] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-21 19:30:33] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-21 19:30:35] [valid] Ep. 1 : Up. 240000 : perplexity : 11.806 : new best
[2024-06-23 22:23:44] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-23 22:23:44] [marian] Running on nid005093 as process 116287 with command line:
[2024-06-23 22:23:44] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-06-23 22:23:46] [config] after: 0e
[2024-06-23 22:23:46] [config] after-batches: 0
[2024-06-23 22:23:46] [config] after-epochs: 0
[2024-06-23 22:23:46] [config] all-caps-every: 0
[2024-06-23 22:23:46] [config] allow-unk: true
[2024-06-23 22:23:46] [config] authors: false
[2024-06-23 22:23:46] [config] beam-size: 6
[2024-06-23 22:23:46] [config] bert-class-symbol: "[CLS]"
[2024-06-23 22:23:46] [config] bert-mask-symbol: "[MASK]"
[2024-06-23 22:23:46] [config] bert-masking-fraction: 0.15
[2024-06-23 22:23:46] [config] bert-sep-symbol: "[SEP]"
[2024-06-23 22:23:46] [config] bert-train-type-embeddings: true
[2024-06-23 22:23:46] [config] bert-type-vocab-size: 2
[2024-06-23 22:23:46] [config] build-info: ""
[2024-06-23 22:23:46] [config] char-conv-filters-num:
[2024-06-23 22:23:46] [config]   - 200
[2024-06-23 22:23:46] [config]   - 200
[2024-06-23 22:23:46] [config]   - 250
[2024-06-23 22:23:46] [config]   - 250
[2024-06-23 22:23:46] [config]   - 300
[2024-06-23 22:23:46] [config]   - 300
[2024-06-23 22:23:46] [config]   - 300
[2024-06-23 22:23:46] [config]   - 300
[2024-06-23 22:23:46] [config] char-conv-filters-widths:
[2024-06-23 22:23:46] [config]   - 1
[2024-06-23 22:23:46] [config]   - 2
[2024-06-23 22:23:46] [config]   - 3
[2024-06-23 22:23:46] [config]   - 4
[2024-06-23 22:23:46] [config]   - 5
[2024-06-23 22:23:46] [config]   - 6
[2024-06-23 22:23:46] [config]   - 7
[2024-06-23 22:23:46] [config]   - 8
[2024-06-23 22:23:46] [config] char-highway: 4
[2024-06-23 22:23:46] [config] char-stride: 5
[2024-06-23 22:23:46] [config] check-gradient-nan: false
[2024-06-23 22:23:46] [config] check-nan: false
[2024-06-23 22:23:46] [config] cite: false
[2024-06-23 22:23:46] [config] clip-norm: 0
[2024-06-23 22:23:46] [config] cost-scaling:
[2024-06-23 22:23:46] [config]   []
[2024-06-23 22:23:46] [config] cost-type: ce-mean-words
[2024-06-23 22:23:46] [config] cpu-threads: 0
[2024-06-23 22:23:46] [config] data-threads: 8
[2024-06-23 22:23:46] [config] data-weighting: ""
[2024-06-23 22:23:46] [config] data-weighting-type: sentence
[2024-06-23 22:23:46] [config] dec-cell: gru
[2024-06-23 22:23:46] [config] dec-cell-base-depth: 2
[2024-06-23 22:23:46] [config] dec-cell-high-depth: 1
[2024-06-23 22:23:46] [config] dec-depth: 6
[2024-06-23 22:23:46] [config] devices:
[2024-06-23 22:23:46] [config]   - 0
[2024-06-23 22:23:46] [config]   - 1
[2024-06-23 22:23:46] [config]   - 2
[2024-06-23 22:23:46] [config]   - 3
[2024-06-23 22:23:46] [config]   - 4
[2024-06-23 22:23:46] [config]   - 5
[2024-06-23 22:23:46] [config]   - 6
[2024-06-23 22:23:46] [config]   - 7
[2024-06-23 22:23:46] [config] dim-emb: 1024
[2024-06-23 22:23:46] [config] dim-rnn: 1024
[2024-06-23 22:23:46] [config] dim-vocabs:
[2024-06-23 22:23:46] [config]   - 69666
[2024-06-23 22:23:46] [config]   - 69666
[2024-06-23 22:23:46] [config] disp-first: 10
[2024-06-23 22:23:46] [config] disp-freq: 10000
[2024-06-23 22:23:46] [config] disp-label-counts: true
[2024-06-23 22:23:46] [config] dropout-rnn: 0
[2024-06-23 22:23:46] [config] dropout-src: 0
[2024-06-23 22:23:46] [config] dropout-trg: 0
[2024-06-23 22:23:46] [config] dump-config: ""
[2024-06-23 22:23:46] [config] dynamic-gradient-scaling:
[2024-06-23 22:23:46] [config]   []
[2024-06-23 22:23:46] [config] early-stopping: 20
[2024-06-23 22:23:46] [config] early-stopping-on: first
[2024-06-23 22:23:46] [config] embedding-fix-src: false
[2024-06-23 22:23:46] [config] embedding-fix-trg: false
[2024-06-23 22:23:46] [config] embedding-normalization: false
[2024-06-23 22:23:46] [config] embedding-vectors:
[2024-06-23 22:23:46] [config]   []
[2024-06-23 22:23:46] [config] enc-cell: gru
[2024-06-23 22:23:46] [config] enc-cell-depth: 1
[2024-06-23 22:23:46] [config] enc-depth: 6
[2024-06-23 22:23:46] [config] enc-type: bidirectional
[2024-06-23 22:23:46] [config] english-title-case-every: 0
[2024-06-23 22:23:46] [config] exponential-smoothing: 0.0001
[2024-06-23 22:23:46] [config] factor-weight: 1
[2024-06-23 22:23:46] [config] factors-combine: sum
[2024-06-23 22:23:46] [config] factors-dim-emb: 0
[2024-06-23 22:23:46] [config] gradient-checkpointing: false
[2024-06-23 22:23:46] [config] gradient-norm-average-window: 100
[2024-06-23 22:23:46] [config] guided-alignment: none
[2024-06-23 22:23:46] [config] guided-alignment-cost: ce
[2024-06-23 22:23:46] [config] guided-alignment-weight: 0.1
[2024-06-23 22:23:46] [config] ignore-model-config: false
[2024-06-23 22:23:46] [config] input-types:
[2024-06-23 22:23:46] [config]   []
[2024-06-23 22:23:46] [config] interpolate-env-vars: false
[2024-06-23 22:23:46] [config] keep-best: true
[2024-06-23 22:23:46] [config] label-smoothing: 0.1
[2024-06-23 22:23:46] [config] layer-normalization: false
[2024-06-23 22:23:46] [config] learn-rate: 0.0002
[2024-06-23 22:23:46] [config] lemma-dependency: ""
[2024-06-23 22:23:46] [config] lemma-dim-emb: 0
[2024-06-23 22:23:46] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-06-23 22:23:46] [config] log-level: info
[2024-06-23 22:23:46] [config] log-time-zone: ""
[2024-06-23 22:23:46] [config] logical-epoch:
[2024-06-23 22:23:46] [config]   - 1e
[2024-06-23 22:23:46] [config]   - 0
[2024-06-23 22:23:46] [config] lr-decay: 0
[2024-06-23 22:23:46] [config] lr-decay-freq: 50000
[2024-06-23 22:23:46] [config] lr-decay-inv-sqrt:
[2024-06-23 22:23:46] [config]   - 8000
[2024-06-23 22:23:46] [config] lr-decay-repeat-warmup: false
[2024-06-23 22:23:46] [config] lr-decay-reset-optimizer: false
[2024-06-23 22:23:46] [config] lr-decay-start:
[2024-06-23 22:23:46] [config]   - 10
[2024-06-23 22:23:46] [config]   - 1
[2024-06-23 22:23:46] [config] lr-decay-strategy: epoch+stalled
[2024-06-23 22:23:46] [config] lr-report: false
[2024-06-23 22:23:46] [config] lr-warmup: 8000
[2024-06-23 22:23:46] [config] lr-warmup-at-reload: false
[2024-06-23 22:23:46] [config] lr-warmup-cycle: true
[2024-06-23 22:23:46] [config] lr-warmup-start-rate: 0
[2024-06-23 22:23:46] [config] max-length: 100
[2024-06-23 22:23:46] [config] max-length-crop: false
[2024-06-23 22:23:46] [config] max-length-factor: 3
[2024-06-23 22:23:46] [config] maxi-batch: 1000
[2024-06-23 22:23:46] [config] maxi-batch-sort: trg
[2024-06-23 22:23:46] [config] mini-batch: 1000
[2024-06-23 22:23:46] [config] mini-batch-fit: true
[2024-06-23 22:23:46] [config] mini-batch-fit-step: 10
[2024-06-23 22:23:46] [config] mini-batch-round-up: true
[2024-06-23 22:23:46] [config] mini-batch-track-lr: false
[2024-06-23 22:23:46] [config] mini-batch-warmup: 0
[2024-06-23 22:23:46] [config] mini-batch-words: 0
[2024-06-23 22:23:46] [config] mini-batch-words-ref: 0
[2024-06-23 22:23:46] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-23 22:23:46] [config] multi-loss-type: sum
[2024-06-23 22:23:46] [config] n-best: false
[2024-06-23 22:23:46] [config] no-nccl: false
[2024-06-23 22:23:46] [config] no-reload: false
[2024-06-23 22:23:46] [config] no-restore-corpus: false
[2024-06-23 22:23:46] [config] normalize: 1
[2024-06-23 22:23:46] [config] normalize-gradient: false
[2024-06-23 22:23:46] [config] num-devices: 0
[2024-06-23 22:23:46] [config] optimizer: adam
[2024-06-23 22:23:46] [config] optimizer-delay: 10
[2024-06-23 22:23:46] [config] optimizer-params:
[2024-06-23 22:23:46] [config]   - 0.9
[2024-06-23 22:23:46] [config]   - 0.998
[2024-06-23 22:23:46] [config]   - 1e-09
[2024-06-23 22:23:46] [config] output-omit-bias: false
[2024-06-23 22:23:46] [config] overwrite: true
[2024-06-23 22:23:46] [config] precision:
[2024-06-23 22:23:46] [config]   - float32
[2024-06-23 22:23:46] [config]   - float32
[2024-06-23 22:23:46] [config] pretrained-model: ""
[2024-06-23 22:23:46] [config] quantize-biases: false
[2024-06-23 22:23:46] [config] quantize-bits: 0
[2024-06-23 22:23:46] [config] quantize-log-based: false
[2024-06-23 22:23:46] [config] quantize-optimization-steps: 0
[2024-06-23 22:23:46] [config] quiet: false
[2024-06-23 22:23:46] [config] quiet-translation: false
[2024-06-23 22:23:46] [config] relative-paths: false
[2024-06-23 22:23:46] [config] right-left: false
[2024-06-23 22:23:46] [config] save-freq: 10000
[2024-06-23 22:23:46] [config] seed: 2222
[2024-06-23 22:23:46] [config] sentencepiece-alphas:
[2024-06-23 22:23:46] [config]   []
[2024-06-23 22:23:46] [config] sentencepiece-max-lines: 2000000
[2024-06-23 22:23:46] [config] sentencepiece-options: ""
[2024-06-23 22:23:46] [config] sharding: local
[2024-06-23 22:23:46] [config] shuffle: batches
[2024-06-23 22:23:46] [config] shuffle-in-ram: false
[2024-06-23 22:23:46] [config] sigterm: save-and-exit
[2024-06-23 22:23:46] [config] skip: false
[2024-06-23 22:23:46] [config] sqlite: ""
[2024-06-23 22:23:46] [config] sqlite-drop: false
[2024-06-23 22:23:46] [config] sync-freq: 200u
[2024-06-23 22:23:46] [config] sync-sgd: true
[2024-06-23 22:23:46] [config] tempdir: /scratch/project_462000447/tmp
[2024-06-23 22:23:46] [config] tied-embeddings: false
[2024-06-23 22:23:46] [config] tied-embeddings-all: true
[2024-06-23 22:23:46] [config] tied-embeddings-src: false
[2024-06-23 22:23:46] [config] train-embedder-rank:
[2024-06-23 22:23:46] [config]   []
[2024-06-23 22:23:46] [config] train-sets:
[2024-06-23 22:23:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-06-23 22:23:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-06-23 22:23:46] [config] transformer-aan-activation: swish
[2024-06-23 22:23:46] [config] transformer-aan-depth: 2
[2024-06-23 22:23:46] [config] transformer-aan-nogate: false
[2024-06-23 22:23:46] [config] transformer-decoder-autoreg: self-attention
[2024-06-23 22:23:46] [config] transformer-decoder-dim-ffn: 0
[2024-06-23 22:23:46] [config] transformer-decoder-ffn-depth: 0
[2024-06-23 22:23:46] [config] transformer-depth-scaling: false
[2024-06-23 22:23:46] [config] transformer-dim-aan: 2048
[2024-06-23 22:23:46] [config] transformer-dim-ffn: 4096
[2024-06-23 22:23:46] [config] transformer-dropout: 0.1
[2024-06-23 22:23:46] [config] transformer-dropout-attention: 0
[2024-06-23 22:23:46] [config] transformer-dropout-ffn: 0
[2024-06-23 22:23:46] [config] transformer-ffn-activation: relu
[2024-06-23 22:23:46] [config] transformer-ffn-depth: 2
[2024-06-23 22:23:46] [config] transformer-guided-alignment-layer: last
[2024-06-23 22:23:46] [config] transformer-heads: 16
[2024-06-23 22:23:46] [config] transformer-no-projection: false
[2024-06-23 22:23:46] [config] transformer-pool: false
[2024-06-23 22:23:46] [config] transformer-postprocess: dan
[2024-06-23 22:23:46] [config] transformer-postprocess-emb: d
[2024-06-23 22:23:46] [config] transformer-postprocess-top: ""
[2024-06-23 22:23:46] [config] transformer-preprocess: ""
[2024-06-23 22:23:46] [config] transformer-rnn-projection: false
[2024-06-23 22:23:46] [config] transformer-tied-layers:
[2024-06-23 22:23:46] [config]   []
[2024-06-23 22:23:46] [config] transformer-train-position-embeddings: false
[2024-06-23 22:23:46] [config] tsv: false
[2024-06-23 22:23:46] [config] tsv-fields: 0
[2024-06-23 22:23:46] [config] type: transformer
[2024-06-23 22:23:46] [config] ulr: false
[2024-06-23 22:23:46] [config] ulr-dim-emb: 0
[2024-06-23 22:23:46] [config] ulr-dropout: 0
[2024-06-23 22:23:46] [config] ulr-keys-vectors: ""
[2024-06-23 22:23:46] [config] ulr-query-vectors: ""
[2024-06-23 22:23:46] [config] ulr-softmax-temperature: 1
[2024-06-23 22:23:46] [config] ulr-trainable-transformation: false
[2024-06-23 22:23:46] [config] unlikelihood-loss: false
[2024-06-23 22:23:46] [config] valid-freq: 10000
[2024-06-23 22:23:46] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-06-23 22:23:46] [config] valid-max-length: 100
[2024-06-23 22:23:46] [config] valid-metrics:
[2024-06-23 22:23:46] [config]   - perplexity
[2024-06-23 22:23:46] [config] valid-mini-batch: 16
[2024-06-23 22:23:46] [config] valid-reset-stalled: false
[2024-06-23 22:23:46] [config] valid-script-args:
[2024-06-23 22:23:46] [config]   []
[2024-06-23 22:23:46] [config] valid-script-path: ""
[2024-06-23 22:23:46] [config] valid-sets:
[2024-06-23 22:23:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-06-23 22:23:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-06-23 22:23:46] [config] valid-translation-output: ""
[2024-06-23 22:23:46] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-23 22:23:46] [config] vocabs:
[2024-06-23 22:23:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-23 22:23:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-23 22:23:46] [config] word-penalty: 0
[2024-06-23 22:23:46] [config] word-scores: false
[2024-06-23 22:23:46] [config] workspace: 20000
[2024-06-23 22:23:46] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-23 22:23:46] Using synchronous SGD
[2024-06-23 22:23:46] [comm] Compiled without MPI support. Running as a single process on nid005093
[2024-06-23 22:23:46] Synced seed 2222
[2024-06-23 22:23:46] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-23 22:23:46] [data] Setting vocabulary size for input 0 to 69,666
[2024-06-23 22:23:46] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-23 22:23:47] [data] Setting vocabulary size for input 1 to 69,666
[2024-06-23 22:23:47] [batching] Collecting statistics for batch fitting with step size 10
[2024-06-23 22:23:48] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-23 22:23:48] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-23 22:23:48] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-23 22:23:48] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-23 22:23:48] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-23 22:23:48] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-23 22:23:48] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-23 22:23:48] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-23 22:23:48] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-23 22:23:50] [comm] Using global sharding
[2024-06-23 22:23:51] [comm] NCCLCommunicators constructed successfully
[2024-06-23 22:23:51] [training] Using 8 GPUs
[2024-06-23 22:23:51] [logits] Applying loss function for 1 factor(s)
[2024-06-23 22:23:51] [memory] Reserving 945 MB, device gpu0
[2024-06-23 22:23:57] [memory] Reserving 945 MB, device gpu0
[2024-06-23 22:24:30] [batching] Done. Typical MB size is 699,120 target words
[2024-06-23 22:24:30] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-23 22:24:30] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-23 22:24:30] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-23 22:24:30] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-23 22:24:30] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-23 22:24:30] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-23 22:24:30] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-23 22:24:30] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-23 22:24:30] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-23 22:24:31] [comm] Using global sharding
[2024-06-23 22:24:31] [comm] NCCLCommunicators constructed successfully
[2024-06-23 22:24:31] [training] Using 8 GPUs
[2024-06-23 22:24:31] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-23 22:24:49] Allocating memory for general optimizer shards
[2024-06-23 22:24:49] [memory] Reserving 118 MB, device gpu0
[2024-06-23 22:24:49] [memory] Reserving 118 MB, device gpu1
[2024-06-23 22:24:49] [memory] Reserving 118 MB, device gpu2
[2024-06-23 22:24:49] [memory] Reserving 118 MB, device gpu3
[2024-06-23 22:24:49] [memory] Reserving 118 MB, device gpu4
[2024-06-23 22:24:49] [memory] Reserving 118 MB, device gpu5
[2024-06-23 22:24:49] [memory] Reserving 118 MB, device gpu6
[2024-06-23 22:24:49] [memory] Reserving 118 MB, device gpu7
[2024-06-23 22:24:49] Loading Adam parameters
[2024-06-23 22:24:51] [memory] Reserving 236 MB, device gpu0
[2024-06-23 22:24:51] [memory] Reserving 236 MB, device gpu1
[2024-06-23 22:24:51] [memory] Reserving 236 MB, device gpu2
[2024-06-23 22:24:51] [memory] Reserving 236 MB, device gpu3
[2024-06-23 22:24:52] [memory] Reserving 236 MB, device gpu4
[2024-06-23 22:24:52] [memory] Reserving 236 MB, device gpu5
[2024-06-23 22:24:52] [memory] Reserving 236 MB, device gpu6
[2024-06-23 22:24:52] [memory] Reserving 236 MB, device gpu7
[2024-06-23 22:24:53] [memory] Reserving 945 MB, device gpu0
[2024-06-23 22:24:53] [memory] Reserving 945 MB, device gpu1
[2024-06-23 22:24:53] [memory] Reserving 945 MB, device gpu2
[2024-06-23 22:24:53] [memory] Reserving 945 MB, device gpu3
[2024-06-23 22:24:54] [memory] Reserving 945 MB, device gpu4
[2024-06-23 22:24:54] [memory] Reserving 945 MB, device gpu5
[2024-06-23 22:24:54] [memory] Reserving 945 MB, device gpu6
[2024-06-23 22:24:54] [memory] Reserving 945 MB, device gpu7
[2024-06-23 22:24:55] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-23 22:24:55] [data] Restoring the corpus state to epoch 1, batch 240000
[2024-06-24 02:31:06] Training started
[2024-06-24 02:31:06] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-06-24 02:31:14] [memory] Reserving 945 MB, device gpu0
[2024-06-24 02:31:31] [memory] Reserving 945 MB, device gpu6
[2024-06-24 02:31:31] [memory] Reserving 945 MB, device gpu4
[2024-06-24 02:31:31] [memory] Reserving 945 MB, device gpu3
[2024-06-24 02:31:31] [memory] Reserving 945 MB, device gpu2
[2024-06-24 02:31:31] [memory] Reserving 945 MB, device gpu5
[2024-06-24 02:31:31] [memory] Reserving 945 MB, device gpu1
[2024-06-24 02:31:31] [memory] Reserving 945 MB, device gpu7
[2024-06-24 02:31:35] Parameter type float32, optimization type float32, casting types false
[2024-06-24 10:37:59] Ep. 1 : Up. 250000 : Sen. 1,920,253,993 : Cost 3.14321685 : Time 44009.01s : 61494.08 words/s : gNorm 1.3340
[2024-06-24 10:37:59] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-24 10:38:04] Saving Adam parameters
[2024-06-24 10:38:12] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-24 10:38:26] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-24 10:38:28] [valid] Ep. 1 : Up. 250000 : perplexity : 11.7951 : new best
[2024-06-24 18:44:37] Ep. 1 : Up. 260000 : Sen. 1,997,067,809 : Cost 3.14176559 : Time 29198.03s : 92572.60 words/s : gNorm 1.5683
[2024-06-24 18:44:37] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-24 18:44:42] Saving Adam parameters
[2024-06-24 18:44:50] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-24 18:45:04] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-24 18:45:06] [valid] Ep. 1 : Up. 260000 : perplexity : 11.7875 : new best
[2024-06-25 02:51:07] Ep. 1 : Up. 270000 : Sen. 2,073,802,594 : Cost 3.14144778 : Time 29189.95s : 92576.29 words/s : gNorm 1.2529
[2024-06-25 02:51:07] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-25 02:51:12] Saving Adam parameters
[2024-06-25 02:51:20] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-25 02:51:33] [valid] Ep. 1 : Up. 270000 : perplexity : 11.7885 : stalled 1 times (last best: 11.7875)
[2024-06-25 10:57:38] Ep. 1 : Up. 280000 : Sen. 2,150,595,144 : Cost 3.14115882 : Time 29190.29s : 92686.76 words/s : gNorm 1.2113
[2024-06-25 10:57:38] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-25 10:57:42] Saving Adam parameters
[2024-06-25 10:57:50] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-25 10:58:04] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-25 10:58:06] [valid] Ep. 1 : Up. 280000 : perplexity : 11.7849 : new best
[2024-06-25 19:04:20] Ep. 1 : Up. 290000 : Sen. 2,227,348,306 : Cost 3.13873744 : Time 29201.93s : 92544.39 words/s : gNorm 1.3572
[2024-06-25 19:04:20] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-25 19:04:24] Saving Adam parameters
[2024-06-25 19:04:32] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-25 19:04:46] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-06-25 19:04:48] [valid] Ep. 1 : Up. 290000 : perplexity : 11.7789 : new best
[2024-06-30 12:00:44] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-30 12:00:44] [marian] Running on nid005055 as process 38881 with command line:
[2024-06-30 12:00:44] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-06-30 12:00:46] [config] after: 0e
[2024-06-30 12:00:46] [config] after-batches: 0
[2024-06-30 12:00:46] [config] after-epochs: 0
[2024-06-30 12:00:46] [config] all-caps-every: 0
[2024-06-30 12:00:46] [config] allow-unk: true
[2024-06-30 12:00:46] [config] authors: false
[2024-06-30 12:00:46] [config] beam-size: 6
[2024-06-30 12:00:46] [config] bert-class-symbol: "[CLS]"
[2024-06-30 12:00:46] [config] bert-mask-symbol: "[MASK]"
[2024-06-30 12:00:46] [config] bert-masking-fraction: 0.15
[2024-06-30 12:00:46] [config] bert-sep-symbol: "[SEP]"
[2024-06-30 12:00:46] [config] bert-train-type-embeddings: true
[2024-06-30 12:00:46] [config] bert-type-vocab-size: 2
[2024-06-30 12:00:46] [config] build-info: ""
[2024-06-30 12:00:46] [config] char-conv-filters-num:
[2024-06-30 12:00:46] [config]   - 200
[2024-06-30 12:00:46] [config]   - 200
[2024-06-30 12:00:46] [config]   - 250
[2024-06-30 12:00:46] [config]   - 250
[2024-06-30 12:00:46] [config]   - 300
[2024-06-30 12:00:46] [config]   - 300
[2024-06-30 12:00:46] [config]   - 300
[2024-06-30 12:00:46] [config]   - 300
[2024-06-30 12:00:46] [config] char-conv-filters-widths:
[2024-06-30 12:00:46] [config]   - 1
[2024-06-30 12:00:46] [config]   - 2
[2024-06-30 12:00:46] [config]   - 3
[2024-06-30 12:00:46] [config]   - 4
[2024-06-30 12:00:46] [config]   - 5
[2024-06-30 12:00:46] [config]   - 6
[2024-06-30 12:00:46] [config]   - 7
[2024-06-30 12:00:46] [config]   - 8
[2024-06-30 12:00:46] [config] char-highway: 4
[2024-06-30 12:00:46] [config] char-stride: 5
[2024-06-30 12:00:46] [config] check-gradient-nan: false
[2024-06-30 12:00:46] [config] check-nan: false
[2024-06-30 12:00:46] [config] cite: false
[2024-06-30 12:00:46] [config] clip-norm: 0
[2024-06-30 12:00:46] [config] cost-scaling:
[2024-06-30 12:00:46] [config]   []
[2024-06-30 12:00:46] [config] cost-type: ce-mean-words
[2024-06-30 12:00:46] [config] cpu-threads: 0
[2024-06-30 12:00:46] [config] data-threads: 8
[2024-06-30 12:00:46] [config] data-weighting: ""
[2024-06-30 12:00:46] [config] data-weighting-type: sentence
[2024-06-30 12:00:46] [config] dec-cell: gru
[2024-06-30 12:00:46] [config] dec-cell-base-depth: 2
[2024-06-30 12:00:46] [config] dec-cell-high-depth: 1
[2024-06-30 12:00:46] [config] dec-depth: 6
[2024-06-30 12:00:46] [config] devices:
[2024-06-30 12:00:46] [config]   - 0
[2024-06-30 12:00:46] [config]   - 1
[2024-06-30 12:00:46] [config]   - 2
[2024-06-30 12:00:46] [config]   - 3
[2024-06-30 12:00:46] [config]   - 4
[2024-06-30 12:00:46] [config]   - 5
[2024-06-30 12:00:46] [config]   - 6
[2024-06-30 12:00:46] [config]   - 7
[2024-06-30 12:00:46] [config] dim-emb: 1024
[2024-06-30 12:00:46] [config] dim-rnn: 1024
[2024-06-30 12:00:46] [config] dim-vocabs:
[2024-06-30 12:00:46] [config]   - 69666
[2024-06-30 12:00:46] [config]   - 69666
[2024-06-30 12:00:46] [config] disp-first: 10
[2024-06-30 12:00:46] [config] disp-freq: 10000
[2024-06-30 12:00:46] [config] disp-label-counts: true
[2024-06-30 12:00:46] [config] dropout-rnn: 0
[2024-06-30 12:00:46] [config] dropout-src: 0
[2024-06-30 12:00:46] [config] dropout-trg: 0
[2024-06-30 12:00:46] [config] dump-config: ""
[2024-06-30 12:00:46] [config] dynamic-gradient-scaling:
[2024-06-30 12:00:46] [config]   []
[2024-06-30 12:00:46] [config] early-stopping: 20
[2024-06-30 12:00:46] [config] early-stopping-on: first
[2024-06-30 12:00:46] [config] embedding-fix-src: false
[2024-06-30 12:00:46] [config] embedding-fix-trg: false
[2024-06-30 12:00:46] [config] embedding-normalization: false
[2024-06-30 12:00:46] [config] embedding-vectors:
[2024-06-30 12:00:46] [config]   []
[2024-06-30 12:00:46] [config] enc-cell: gru
[2024-06-30 12:00:46] [config] enc-cell-depth: 1
[2024-06-30 12:00:46] [config] enc-depth: 6
[2024-06-30 12:00:46] [config] enc-type: bidirectional
[2024-06-30 12:00:46] [config] english-title-case-every: 0
[2024-06-30 12:00:46] [config] exponential-smoothing: 0.0001
[2024-06-30 12:00:46] [config] factor-weight: 1
[2024-06-30 12:00:46] [config] factors-combine: sum
[2024-06-30 12:00:46] [config] factors-dim-emb: 0
[2024-06-30 12:00:46] [config] gradient-checkpointing: false
[2024-06-30 12:00:46] [config] gradient-norm-average-window: 100
[2024-06-30 12:00:46] [config] guided-alignment: none
[2024-06-30 12:00:46] [config] guided-alignment-cost: ce
[2024-06-30 12:00:46] [config] guided-alignment-weight: 0.1
[2024-06-30 12:00:46] [config] ignore-model-config: false
[2024-06-30 12:00:46] [config] input-types:
[2024-06-30 12:00:46] [config]   []
[2024-06-30 12:00:46] [config] interpolate-env-vars: false
[2024-06-30 12:00:46] [config] keep-best: true
[2024-06-30 12:00:46] [config] label-smoothing: 0.1
[2024-06-30 12:00:46] [config] layer-normalization: false
[2024-06-30 12:00:46] [config] learn-rate: 0.0002
[2024-06-30 12:00:46] [config] lemma-dependency: ""
[2024-06-30 12:00:46] [config] lemma-dim-emb: 0
[2024-06-30 12:00:46] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-06-30 12:00:46] [config] log-level: info
[2024-06-30 12:00:46] [config] log-time-zone: ""
[2024-06-30 12:00:46] [config] logical-epoch:
[2024-06-30 12:00:46] [config]   - 1e
[2024-06-30 12:00:46] [config]   - 0
[2024-06-30 12:00:46] [config] lr-decay: 0
[2024-06-30 12:00:46] [config] lr-decay-freq: 50000
[2024-06-30 12:00:46] [config] lr-decay-inv-sqrt:
[2024-06-30 12:00:46] [config]   - 8000
[2024-06-30 12:00:46] [config] lr-decay-repeat-warmup: false
[2024-06-30 12:00:46] [config] lr-decay-reset-optimizer: false
[2024-06-30 12:00:46] [config] lr-decay-start:
[2024-06-30 12:00:46] [config]   - 10
[2024-06-30 12:00:46] [config]   - 1
[2024-06-30 12:00:46] [config] lr-decay-strategy: epoch+stalled
[2024-06-30 12:00:46] [config] lr-report: false
[2024-06-30 12:00:46] [config] lr-warmup: 8000
[2024-06-30 12:00:46] [config] lr-warmup-at-reload: false
[2024-06-30 12:00:46] [config] lr-warmup-cycle: true
[2024-06-30 12:00:46] [config] lr-warmup-start-rate: 0
[2024-06-30 12:00:46] [config] max-length: 100
[2024-06-30 12:00:46] [config] max-length-crop: false
[2024-06-30 12:00:46] [config] max-length-factor: 3
[2024-06-30 12:00:46] [config] maxi-batch: 1000
[2024-06-30 12:00:46] [config] maxi-batch-sort: trg
[2024-06-30 12:00:46] [config] mini-batch: 1000
[2024-06-30 12:00:46] [config] mini-batch-fit: true
[2024-06-30 12:00:46] [config] mini-batch-fit-step: 10
[2024-06-30 12:00:46] [config] mini-batch-round-up: true
[2024-06-30 12:00:46] [config] mini-batch-track-lr: false
[2024-06-30 12:00:46] [config] mini-batch-warmup: 0
[2024-06-30 12:00:46] [config] mini-batch-words: 0
[2024-06-30 12:00:46] [config] mini-batch-words-ref: 0
[2024-06-30 12:00:46] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-30 12:00:46] [config] multi-loss-type: sum
[2024-06-30 12:00:46] [config] n-best: false
[2024-06-30 12:00:46] [config] no-nccl: false
[2024-06-30 12:00:46] [config] no-reload: false
[2024-06-30 12:00:46] [config] no-restore-corpus: false
[2024-06-30 12:00:46] [config] normalize: 1
[2024-06-30 12:00:46] [config] normalize-gradient: false
[2024-06-30 12:00:46] [config] num-devices: 0
[2024-06-30 12:00:46] [config] optimizer: adam
[2024-06-30 12:00:46] [config] optimizer-delay: 10
[2024-06-30 12:00:46] [config] optimizer-params:
[2024-06-30 12:00:46] [config]   - 0.9
[2024-06-30 12:00:46] [config]   - 0.998
[2024-06-30 12:00:46] [config]   - 1e-09
[2024-06-30 12:00:46] [config] output-omit-bias: false
[2024-06-30 12:00:46] [config] overwrite: true
[2024-06-30 12:00:46] [config] precision:
[2024-06-30 12:00:46] [config]   - float32
[2024-06-30 12:00:46] [config]   - float32
[2024-06-30 12:00:46] [config] pretrained-model: ""
[2024-06-30 12:00:46] [config] quantize-biases: false
[2024-06-30 12:00:46] [config] quantize-bits: 0
[2024-06-30 12:00:46] [config] quantize-log-based: false
[2024-06-30 12:00:46] [config] quantize-optimization-steps: 0
[2024-06-30 12:00:46] [config] quiet: false
[2024-06-30 12:00:46] [config] quiet-translation: false
[2024-06-30 12:00:46] [config] relative-paths: false
[2024-06-30 12:00:46] [config] right-left: false
[2024-06-30 12:00:46] [config] save-freq: 10000
[2024-06-30 12:00:46] [config] seed: 2222
[2024-06-30 12:00:46] [config] sentencepiece-alphas:
[2024-06-30 12:00:46] [config]   []
[2024-06-30 12:00:46] [config] sentencepiece-max-lines: 2000000
[2024-06-30 12:00:46] [config] sentencepiece-options: ""
[2024-06-30 12:00:46] [config] sharding: local
[2024-06-30 12:00:46] [config] shuffle: batches
[2024-06-30 12:00:46] [config] shuffle-in-ram: false
[2024-06-30 12:00:46] [config] sigterm: save-and-exit
[2024-06-30 12:00:46] [config] skip: false
[2024-06-30 12:00:46] [config] sqlite: ""
[2024-06-30 12:00:46] [config] sqlite-drop: false
[2024-06-30 12:00:46] [config] sync-freq: 200u
[2024-06-30 12:00:46] [config] sync-sgd: true
[2024-06-30 12:00:46] [config] tempdir: /scratch/project_462000447/tmp
[2024-06-30 12:00:46] [config] tied-embeddings: false
[2024-06-30 12:00:46] [config] tied-embeddings-all: true
[2024-06-30 12:00:46] [config] tied-embeddings-src: false
[2024-06-30 12:00:46] [config] train-embedder-rank:
[2024-06-30 12:00:46] [config]   []
[2024-06-30 12:00:46] [config] train-sets:
[2024-06-30 12:00:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-06-30 12:00:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-06-30 12:00:46] [config] transformer-aan-activation: swish
[2024-06-30 12:00:46] [config] transformer-aan-depth: 2
[2024-06-30 12:00:46] [config] transformer-aan-nogate: false
[2024-06-30 12:00:46] [config] transformer-decoder-autoreg: self-attention
[2024-06-30 12:00:46] [config] transformer-decoder-dim-ffn: 0
[2024-06-30 12:00:46] [config] transformer-decoder-ffn-depth: 0
[2024-06-30 12:00:46] [config] transformer-depth-scaling: false
[2024-06-30 12:00:46] [config] transformer-dim-aan: 2048
[2024-06-30 12:00:46] [config] transformer-dim-ffn: 4096
[2024-06-30 12:00:46] [config] transformer-dropout: 0.1
[2024-06-30 12:00:46] [config] transformer-dropout-attention: 0
[2024-06-30 12:00:46] [config] transformer-dropout-ffn: 0
[2024-06-30 12:00:46] [config] transformer-ffn-activation: relu
[2024-06-30 12:00:46] [config] transformer-ffn-depth: 2
[2024-06-30 12:00:46] [config] transformer-guided-alignment-layer: last
[2024-06-30 12:00:46] [config] transformer-heads: 16
[2024-06-30 12:00:46] [config] transformer-no-projection: false
[2024-06-30 12:00:46] [config] transformer-pool: false
[2024-06-30 12:00:46] [config] transformer-postprocess: dan
[2024-06-30 12:00:46] [config] transformer-postprocess-emb: d
[2024-06-30 12:00:46] [config] transformer-postprocess-top: ""
[2024-06-30 12:00:46] [config] transformer-preprocess: ""
[2024-06-30 12:00:46] [config] transformer-rnn-projection: false
[2024-06-30 12:00:46] [config] transformer-tied-layers:
[2024-06-30 12:00:46] [config]   []
[2024-06-30 12:00:46] [config] transformer-train-position-embeddings: false
[2024-06-30 12:00:46] [config] tsv: false
[2024-06-30 12:00:46] [config] tsv-fields: 0
[2024-06-30 12:00:46] [config] type: transformer
[2024-06-30 12:00:46] [config] ulr: false
[2024-06-30 12:00:46] [config] ulr-dim-emb: 0
[2024-06-30 12:00:46] [config] ulr-dropout: 0
[2024-06-30 12:00:46] [config] ulr-keys-vectors: ""
[2024-06-30 12:00:46] [config] ulr-query-vectors: ""
[2024-06-30 12:00:46] [config] ulr-softmax-temperature: 1
[2024-06-30 12:00:46] [config] ulr-trainable-transformation: false
[2024-06-30 12:00:46] [config] unlikelihood-loss: false
[2024-06-30 12:00:46] [config] valid-freq: 10000
[2024-06-30 12:00:46] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-06-30 12:00:46] [config] valid-max-length: 100
[2024-06-30 12:00:46] [config] valid-metrics:
[2024-06-30 12:00:46] [config]   - perplexity
[2024-06-30 12:00:46] [config] valid-mini-batch: 16
[2024-06-30 12:00:46] [config] valid-reset-stalled: false
[2024-06-30 12:00:46] [config] valid-script-args:
[2024-06-30 12:00:46] [config]   []
[2024-06-30 12:00:46] [config] valid-script-path: ""
[2024-06-30 12:00:46] [config] valid-sets:
[2024-06-30 12:00:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-06-30 12:00:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-06-30 12:00:46] [config] valid-translation-output: ""
[2024-06-30 12:00:46] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-30 12:00:46] [config] vocabs:
[2024-06-30 12:00:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-30 12:00:46] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-30 12:00:46] [config] word-penalty: 0
[2024-06-30 12:00:46] [config] word-scores: false
[2024-06-30 12:00:46] [config] workspace: 20000
[2024-06-30 12:00:46] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-06-30 12:00:46] Using synchronous SGD
[2024-06-30 12:00:46] [comm] Compiled without MPI support. Running as a single process on nid005055
[2024-06-30 12:00:46] Synced seed 2222
[2024-06-30 12:00:46] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-30 12:00:46] [data] Setting vocabulary size for input 0 to 69,666
[2024-06-30 12:00:46] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-06-30 12:00:47] [data] Setting vocabulary size for input 1 to 69,666
[2024-06-30 12:00:47] [batching] Collecting statistics for batch fitting with step size 10
[2024-06-30 12:00:51] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-30 12:00:51] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-30 12:00:51] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-30 12:00:51] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-30 12:00:51] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-30 12:00:51] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-30 12:00:51] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-30 12:00:51] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-30 12:00:51] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-30 12:00:53] [comm] Using global sharding
[2024-06-30 12:00:54] [comm] NCCLCommunicators constructed successfully
[2024-06-30 12:00:54] [training] Using 8 GPUs
[2024-06-30 12:00:54] [logits] Applying loss function for 1 factor(s)
[2024-06-30 12:00:54] [memory] Reserving 945 MB, device gpu0
[2024-06-30 12:00:59] [memory] Reserving 945 MB, device gpu0
[2024-06-30 12:01:34] [batching] Done. Typical MB size is 699,120 target words
[2024-06-30 12:01:34] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-06-30 12:01:34] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-06-30 12:01:34] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-06-30 12:01:34] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-06-30 12:01:34] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-06-30 12:01:34] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-06-30 12:01:34] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-06-30 12:01:34] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-06-30 12:01:34] [comm] Using NCCL 3.2.12 for GPU communication
[2024-06-30 12:01:34] [comm] Using global sharding
[2024-06-30 12:01:35] [comm] NCCLCommunicators constructed successfully
[2024-06-30 12:01:35] [training] Using 8 GPUs
[2024-06-30 12:01:35] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-06-30 12:01:53] Allocating memory for general optimizer shards
[2024-06-30 12:01:53] [memory] Reserving 118 MB, device gpu0
[2024-06-30 12:01:53] [memory] Reserving 118 MB, device gpu1
[2024-06-30 12:01:53] [memory] Reserving 118 MB, device gpu2
[2024-06-30 12:01:53] [memory] Reserving 118 MB, device gpu3
[2024-06-30 12:01:53] [memory] Reserving 118 MB, device gpu4
[2024-06-30 12:01:53] [memory] Reserving 118 MB, device gpu5
[2024-06-30 12:01:53] [memory] Reserving 118 MB, device gpu6
[2024-06-30 12:01:53] [memory] Reserving 118 MB, device gpu7
[2024-06-30 12:01:53] Loading Adam parameters
[2024-06-30 12:01:55] [memory] Reserving 236 MB, device gpu0
[2024-06-30 12:01:55] [memory] Reserving 236 MB, device gpu1
[2024-06-30 12:01:55] [memory] Reserving 236 MB, device gpu2
[2024-06-30 12:01:55] [memory] Reserving 236 MB, device gpu3
[2024-06-30 12:01:55] [memory] Reserving 236 MB, device gpu4
[2024-06-30 12:01:56] [memory] Reserving 236 MB, device gpu5
[2024-06-30 12:01:56] [memory] Reserving 236 MB, device gpu6
[2024-06-30 12:01:56] [memory] Reserving 236 MB, device gpu7
[2024-06-30 12:01:56] [memory] Reserving 945 MB, device gpu0
[2024-06-30 12:01:57] [memory] Reserving 945 MB, device gpu1
[2024-06-30 12:01:57] [memory] Reserving 945 MB, device gpu2
[2024-06-30 12:01:57] [memory] Reserving 945 MB, device gpu3
[2024-06-30 12:01:57] [memory] Reserving 945 MB, device gpu4
[2024-06-30 12:01:58] [memory] Reserving 945 MB, device gpu5
[2024-06-30 12:01:58] [memory] Reserving 945 MB, device gpu6
[2024-06-30 12:01:58] [memory] Reserving 945 MB, device gpu7
[2024-06-30 12:01:59] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-06-30 12:01:59] [data] Restoring the corpus state to epoch 1, batch 290000
[2024-06-30 17:02:30] Training started
[2024-06-30 17:02:30] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-06-30 17:02:51] [memory] Reserving 945 MB, device gpu0
[2024-06-30 17:02:55] [memory] Reserving 945 MB, device gpu1
[2024-06-30 17:02:55] [memory] Reserving 945 MB, device gpu2
[2024-06-30 17:02:55] [memory] Reserving 945 MB, device gpu7
[2024-06-30 17:02:55] [memory] Reserving 945 MB, device gpu4
[2024-06-30 17:02:55] [memory] Reserving 945 MB, device gpu6
[2024-06-30 17:02:55] [memory] Reserving 945 MB, device gpu3
[2024-06-30 17:02:55] [memory] Reserving 945 MB, device gpu5
[2024-06-30 17:02:57] Parameter type float32, optimization type float32, casting types false
[2024-07-01 01:09:16] Ep. 1 : Up. 300000 : Sen. 2,304,148,593 : Cost 3.13714504 : Time 47261.82s : 57212.24 words/s : gNorm 1.2708
[2024-07-01 01:09:16] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-01 01:09:21] Saving Adam parameters
[2024-07-01 01:09:29] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-01 01:09:42] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-01 01:09:45] [valid] Ep. 1 : Up. 300000 : perplexity : 11.7692 : new best
[2024-07-01 09:15:58] Ep. 1 : Up. 310000 : Sen. 2,380,949,110 : Cost 3.13701010 : Time 29201.88s : 92563.95 words/s : gNorm 1.4065
[2024-07-01 09:15:58] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-01 09:16:03] Saving Adam parameters
[2024-07-01 09:16:10] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-01 09:16:24] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-01 09:16:27] [valid] Ep. 1 : Up. 310000 : perplexity : 11.763 : new best
[2024-07-01 17:23:19] Ep. 1 : Up. 320000 : Sen. 2,457,802,616 : Cost 3.13728452 : Time 29241.60s : 92547.88 words/s : gNorm 1.7457
[2024-07-01 17:23:19] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-01 17:23:24] Saving Adam parameters
[2024-07-01 17:23:32] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-01 17:23:46] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-01 17:23:48] [valid] Ep. 1 : Up. 320000 : perplexity : 11.759 : new best
[2024-07-02 01:30:03] Ep. 1 : Up. 330000 : Sen. 2,534,592,221 : Cost 3.13498378 : Time 29203.87s : 92621.31 words/s : gNorm 1.1068
[2024-07-02 01:30:03] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-02 01:30:08] Saving Adam parameters
[2024-07-02 01:30:16] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-02 01:30:30] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-02 01:30:32] [valid] Ep. 1 : Up. 330000 : perplexity : 11.7527 : new best
[2024-07-02 09:37:12] Ep. 1 : Up. 340000 : Sen. 2,611,455,015 : Cost 3.13345408 : Time 29228.51s : 92525.67 words/s : gNorm 1.2430
[2024-07-02 09:37:12] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-02 09:37:17] Saving Adam parameters
[2024-07-02 09:37:25] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-02 09:37:39] [valid] Ep. 1 : Up. 340000 : perplexity : 11.7573 : stalled 1 times (last best: 11.7527)
[2024-07-02 17:44:39] Ep. 1 : Up. 350000 : Sen. 2,688,251,011 : Cost 3.13323569 : Time 29246.60s : 92501.61 words/s : gNorm 1.6946
[2024-07-02 17:44:40] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-02 17:44:46] Saving Adam parameters
[2024-07-02 17:44:53] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-02 17:45:07] [valid] Ep. 1 : Up. 350000 : perplexity : 11.7558 : stalled 2 times (last best: 11.7527)
[2024-07-03 01:51:26] Ep. 1 : Up. 360000 : Sen. 2,765,121,358 : Cost 3.13348413 : Time 29205.26s : 92680.24 words/s : gNorm 1.0750
[2024-07-03 01:51:26] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-03 01:51:31] Saving Adam parameters
[2024-07-03 01:51:38] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-03 01:51:52] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-03 01:51:55] [valid] Ep. 1 : Up. 360000 : perplexity : 11.7418 : new best
[2024-07-03 09:58:30] Ep. 1 : Up. 370000 : Sen. 2,841,961,652 : Cost 3.13128233 : Time 29224.07s : 92636.13 words/s : gNorm 1.5290
[2024-07-03 09:58:30] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-03 09:58:35] Saving Adam parameters
[2024-07-03 09:58:42] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-03 09:58:56] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-03 09:58:58] [valid] Ep. 1 : Up. 370000 : perplexity : 11.7379 : new best
[2024-07-03 14:19:34] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-03 14:19:34] [marian] Running on nid005075 as process 43234 with command line:
[2024-07-03 14:19:34] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-03 14:19:36] [config] after: 0e
[2024-07-03 14:19:36] [config] after-batches: 0
[2024-07-03 14:19:36] [config] after-epochs: 0
[2024-07-03 14:19:36] [config] all-caps-every: 0
[2024-07-03 14:19:36] [config] allow-unk: true
[2024-07-03 14:19:36] [config] authors: false
[2024-07-03 14:19:36] [config] beam-size: 6
[2024-07-03 14:19:36] [config] bert-class-symbol: "[CLS]"
[2024-07-03 14:19:36] [config] bert-mask-symbol: "[MASK]"
[2024-07-03 14:19:36] [config] bert-masking-fraction: 0.15
[2024-07-03 14:19:36] [config] bert-sep-symbol: "[SEP]"
[2024-07-03 14:19:36] [config] bert-train-type-embeddings: true
[2024-07-03 14:19:36] [config] bert-type-vocab-size: 2
[2024-07-03 14:19:36] [config] build-info: ""
[2024-07-03 14:19:36] [config] char-conv-filters-num:
[2024-07-03 14:19:36] [config]   - 200
[2024-07-03 14:19:36] [config]   - 200
[2024-07-03 14:19:36] [config]   - 250
[2024-07-03 14:19:36] [config]   - 250
[2024-07-03 14:19:36] [config]   - 300
[2024-07-03 14:19:36] [config]   - 300
[2024-07-03 14:19:36] [config]   - 300
[2024-07-03 14:19:36] [config]   - 300
[2024-07-03 14:19:36] [config] char-conv-filters-widths:
[2024-07-03 14:19:36] [config]   - 1
[2024-07-03 14:19:36] [config]   - 2
[2024-07-03 14:19:36] [config]   - 3
[2024-07-03 14:19:36] [config]   - 4
[2024-07-03 14:19:36] [config]   - 5
[2024-07-03 14:19:36] [config]   - 6
[2024-07-03 14:19:36] [config]   - 7
[2024-07-03 14:19:36] [config]   - 8
[2024-07-03 14:19:36] [config] char-highway: 4
[2024-07-03 14:19:36] [config] char-stride: 5
[2024-07-03 14:19:36] [config] check-gradient-nan: false
[2024-07-03 14:19:36] [config] check-nan: false
[2024-07-03 14:19:36] [config] cite: false
[2024-07-03 14:19:36] [config] clip-norm: 0
[2024-07-03 14:19:36] [config] cost-scaling:
[2024-07-03 14:19:36] [config]   []
[2024-07-03 14:19:36] [config] cost-type: ce-mean-words
[2024-07-03 14:19:36] [config] cpu-threads: 0
[2024-07-03 14:19:36] [config] data-threads: 8
[2024-07-03 14:19:36] [config] data-weighting: ""
[2024-07-03 14:19:36] [config] data-weighting-type: sentence
[2024-07-03 14:19:36] [config] dec-cell: gru
[2024-07-03 14:19:36] [config] dec-cell-base-depth: 2
[2024-07-03 14:19:36] [config] dec-cell-high-depth: 1
[2024-07-03 14:19:36] [config] dec-depth: 6
[2024-07-03 14:19:36] [config] devices:
[2024-07-03 14:19:36] [config]   - 0
[2024-07-03 14:19:36] [config]   - 1
[2024-07-03 14:19:36] [config]   - 2
[2024-07-03 14:19:36] [config]   - 3
[2024-07-03 14:19:36] [config]   - 4
[2024-07-03 14:19:36] [config]   - 5
[2024-07-03 14:19:36] [config]   - 6
[2024-07-03 14:19:36] [config]   - 7
[2024-07-03 14:19:36] [config] dim-emb: 1024
[2024-07-03 14:19:36] [config] dim-rnn: 1024
[2024-07-03 14:19:36] [config] dim-vocabs:
[2024-07-03 14:19:36] [config]   - 69666
[2024-07-03 14:19:36] [config]   - 69666
[2024-07-03 14:19:36] [config] disp-first: 10
[2024-07-03 14:19:36] [config] disp-freq: 10000
[2024-07-03 14:19:36] [config] disp-label-counts: true
[2024-07-03 14:19:36] [config] dropout-rnn: 0
[2024-07-03 14:19:36] [config] dropout-src: 0
[2024-07-03 14:19:36] [config] dropout-trg: 0
[2024-07-03 14:19:36] [config] dump-config: ""
[2024-07-03 14:19:36] [config] dynamic-gradient-scaling:
[2024-07-03 14:19:36] [config]   []
[2024-07-03 14:19:36] [config] early-stopping: 20
[2024-07-03 14:19:36] [config] early-stopping-on: first
[2024-07-03 14:19:36] [config] embedding-fix-src: false
[2024-07-03 14:19:36] [config] embedding-fix-trg: false
[2024-07-03 14:19:36] [config] embedding-normalization: false
[2024-07-03 14:19:36] [config] embedding-vectors:
[2024-07-03 14:19:36] [config]   []
[2024-07-03 14:19:36] [config] enc-cell: gru
[2024-07-03 14:19:36] [config] enc-cell-depth: 1
[2024-07-03 14:19:36] [config] enc-depth: 6
[2024-07-03 14:19:36] [config] enc-type: bidirectional
[2024-07-03 14:19:36] [config] english-title-case-every: 0
[2024-07-03 14:19:36] [config] exponential-smoothing: 0.0001
[2024-07-03 14:19:36] [config] factor-weight: 1
[2024-07-03 14:19:36] [config] factors-combine: sum
[2024-07-03 14:19:36] [config] factors-dim-emb: 0
[2024-07-03 14:19:36] [config] gradient-checkpointing: false
[2024-07-03 14:19:36] [config] gradient-norm-average-window: 100
[2024-07-03 14:19:36] [config] guided-alignment: none
[2024-07-03 14:19:36] [config] guided-alignment-cost: ce
[2024-07-03 14:19:36] [config] guided-alignment-weight: 0.1
[2024-07-03 14:19:36] [config] ignore-model-config: false
[2024-07-03 14:19:36] [config] input-types:
[2024-07-03 14:19:36] [config]   []
[2024-07-03 14:19:36] [config] interpolate-env-vars: false
[2024-07-03 14:19:36] [config] keep-best: true
[2024-07-03 14:19:36] [config] label-smoothing: 0.1
[2024-07-03 14:19:36] [config] layer-normalization: false
[2024-07-03 14:19:36] [config] learn-rate: 0.0002
[2024-07-03 14:19:36] [config] lemma-dependency: ""
[2024-07-03 14:19:36] [config] lemma-dim-emb: 0
[2024-07-03 14:19:36] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-03 14:19:36] [config] log-level: info
[2024-07-03 14:19:36] [config] log-time-zone: ""
[2024-07-03 14:19:36] [config] logical-epoch:
[2024-07-03 14:19:36] [config]   - 1e
[2024-07-03 14:19:36] [config]   - 0
[2024-07-03 14:19:36] [config] lr-decay: 0
[2024-07-03 14:19:36] [config] lr-decay-freq: 50000
[2024-07-03 14:19:36] [config] lr-decay-inv-sqrt:
[2024-07-03 14:19:36] [config]   - 8000
[2024-07-03 14:19:36] [config] lr-decay-repeat-warmup: false
[2024-07-03 14:19:36] [config] lr-decay-reset-optimizer: false
[2024-07-03 14:19:36] [config] lr-decay-start:
[2024-07-03 14:19:36] [config]   - 10
[2024-07-03 14:19:36] [config]   - 1
[2024-07-03 14:19:36] [config] lr-decay-strategy: epoch+stalled
[2024-07-03 14:19:36] [config] lr-report: false
[2024-07-03 14:19:36] [config] lr-warmup: 8000
[2024-07-03 14:19:36] [config] lr-warmup-at-reload: false
[2024-07-03 14:19:36] [config] lr-warmup-cycle: true
[2024-07-03 14:19:36] [config] lr-warmup-start-rate: 0
[2024-07-03 14:19:36] [config] max-length: 100
[2024-07-03 14:19:36] [config] max-length-crop: false
[2024-07-03 14:19:36] [config] max-length-factor: 3
[2024-07-03 14:19:36] [config] maxi-batch: 1000
[2024-07-03 14:19:36] [config] maxi-batch-sort: trg
[2024-07-03 14:19:36] [config] mini-batch: 1000
[2024-07-03 14:19:36] [config] mini-batch-fit: true
[2024-07-03 14:19:36] [config] mini-batch-fit-step: 10
[2024-07-03 14:19:36] [config] mini-batch-round-up: true
[2024-07-03 14:19:36] [config] mini-batch-track-lr: false
[2024-07-03 14:19:36] [config] mini-batch-warmup: 0
[2024-07-03 14:19:36] [config] mini-batch-words: 0
[2024-07-03 14:19:36] [config] mini-batch-words-ref: 0
[2024-07-03 14:19:36] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-03 14:19:36] [config] multi-loss-type: sum
[2024-07-03 14:19:36] [config] n-best: false
[2024-07-03 14:19:36] [config] no-nccl: false
[2024-07-03 14:19:36] [config] no-reload: false
[2024-07-03 14:19:36] [config] no-restore-corpus: false
[2024-07-03 14:19:36] [config] normalize: 1
[2024-07-03 14:19:36] [config] normalize-gradient: false
[2024-07-03 14:19:36] [config] num-devices: 0
[2024-07-03 14:19:36] [config] optimizer: adam
[2024-07-03 14:19:36] [config] optimizer-delay: 10
[2024-07-03 14:19:36] [config] optimizer-params:
[2024-07-03 14:19:36] [config]   - 0.9
[2024-07-03 14:19:36] [config]   - 0.998
[2024-07-03 14:19:36] [config]   - 1e-09
[2024-07-03 14:19:36] [config] output-omit-bias: false
[2024-07-03 14:19:36] [config] overwrite: true
[2024-07-03 14:19:36] [config] precision:
[2024-07-03 14:19:36] [config]   - float32
[2024-07-03 14:19:36] [config]   - float32
[2024-07-03 14:19:36] [config] pretrained-model: ""
[2024-07-03 14:19:36] [config] quantize-biases: false
[2024-07-03 14:19:36] [config] quantize-bits: 0
[2024-07-03 14:19:36] [config] quantize-log-based: false
[2024-07-03 14:19:36] [config] quantize-optimization-steps: 0
[2024-07-03 14:19:36] [config] quiet: false
[2024-07-03 14:19:36] [config] quiet-translation: false
[2024-07-03 14:19:36] [config] relative-paths: false
[2024-07-03 14:19:36] [config] right-left: false
[2024-07-03 14:19:36] [config] save-freq: 10000
[2024-07-03 14:19:36] [config] seed: 2222
[2024-07-03 14:19:36] [config] sentencepiece-alphas:
[2024-07-03 14:19:36] [config]   []
[2024-07-03 14:19:36] [config] sentencepiece-max-lines: 2000000
[2024-07-03 14:19:36] [config] sentencepiece-options: ""
[2024-07-03 14:19:36] [config] sharding: local
[2024-07-03 14:19:36] [config] shuffle: batches
[2024-07-03 14:19:36] [config] shuffle-in-ram: false
[2024-07-03 14:19:36] [config] sigterm: save-and-exit
[2024-07-03 14:19:36] [config] skip: false
[2024-07-03 14:19:36] [config] sqlite: ""
[2024-07-03 14:19:36] [config] sqlite-drop: false
[2024-07-03 14:19:36] [config] sync-freq: 200u
[2024-07-03 14:19:36] [config] sync-sgd: true
[2024-07-03 14:19:36] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-03 14:19:36] [config] tied-embeddings: false
[2024-07-03 14:19:36] [config] tied-embeddings-all: true
[2024-07-03 14:19:36] [config] tied-embeddings-src: false
[2024-07-03 14:19:36] [config] train-embedder-rank:
[2024-07-03 14:19:36] [config]   []
[2024-07-03 14:19:36] [config] train-sets:
[2024-07-03 14:19:36] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-03 14:19:36] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-03 14:19:36] [config] transformer-aan-activation: swish
[2024-07-03 14:19:36] [config] transformer-aan-depth: 2
[2024-07-03 14:19:36] [config] transformer-aan-nogate: false
[2024-07-03 14:19:36] [config] transformer-decoder-autoreg: self-attention
[2024-07-03 14:19:36] [config] transformer-decoder-dim-ffn: 0
[2024-07-03 14:19:36] [config] transformer-decoder-ffn-depth: 0
[2024-07-03 14:19:36] [config] transformer-depth-scaling: false
[2024-07-03 14:19:36] [config] transformer-dim-aan: 2048
[2024-07-03 14:19:36] [config] transformer-dim-ffn: 4096
[2024-07-03 14:19:36] [config] transformer-dropout: 0.1
[2024-07-03 14:19:36] [config] transformer-dropout-attention: 0
[2024-07-03 14:19:36] [config] transformer-dropout-ffn: 0
[2024-07-03 14:19:36] [config] transformer-ffn-activation: relu
[2024-07-03 14:19:36] [config] transformer-ffn-depth: 2
[2024-07-03 14:19:36] [config] transformer-guided-alignment-layer: last
[2024-07-03 14:19:36] [config] transformer-heads: 16
[2024-07-03 14:19:36] [config] transformer-no-projection: false
[2024-07-03 14:19:36] [config] transformer-pool: false
[2024-07-03 14:19:36] [config] transformer-postprocess: dan
[2024-07-03 14:19:36] [config] transformer-postprocess-emb: d
[2024-07-03 14:19:36] [config] transformer-postprocess-top: ""
[2024-07-03 14:19:36] [config] transformer-preprocess: ""
[2024-07-03 14:19:36] [config] transformer-rnn-projection: false
[2024-07-03 14:19:36] [config] transformer-tied-layers:
[2024-07-03 14:19:36] [config]   []
[2024-07-03 14:19:36] [config] transformer-train-position-embeddings: false
[2024-07-03 14:19:36] [config] tsv: false
[2024-07-03 14:19:36] [config] tsv-fields: 0
[2024-07-03 14:19:36] [config] type: transformer
[2024-07-03 14:19:36] [config] ulr: false
[2024-07-03 14:19:36] [config] ulr-dim-emb: 0
[2024-07-03 14:19:36] [config] ulr-dropout: 0
[2024-07-03 14:19:36] [config] ulr-keys-vectors: ""
[2024-07-03 14:19:36] [config] ulr-query-vectors: ""
[2024-07-03 14:19:36] [config] ulr-softmax-temperature: 1
[2024-07-03 14:19:36] [config] ulr-trainable-transformation: false
[2024-07-03 14:19:36] [config] unlikelihood-loss: false
[2024-07-03 14:19:36] [config] valid-freq: 10000
[2024-07-03 14:19:36] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-03 14:19:36] [config] valid-max-length: 100
[2024-07-03 14:19:36] [config] valid-metrics:
[2024-07-03 14:19:36] [config]   - perplexity
[2024-07-03 14:19:36] [config] valid-mini-batch: 16
[2024-07-03 14:19:36] [config] valid-reset-stalled: false
[2024-07-03 14:19:36] [config] valid-script-args:
[2024-07-03 14:19:36] [config]   []
[2024-07-03 14:19:36] [config] valid-script-path: ""
[2024-07-03 14:19:36] [config] valid-sets:
[2024-07-03 14:19:36] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-03 14:19:36] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-03 14:19:36] [config] valid-translation-output: ""
[2024-07-03 14:19:36] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-03 14:19:36] [config] vocabs:
[2024-07-03 14:19:36] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-03 14:19:36] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-03 14:19:36] [config] word-penalty: 0
[2024-07-03 14:19:36] [config] word-scores: false
[2024-07-03 14:19:36] [config] workspace: 20000
[2024-07-03 14:19:36] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-03 14:19:36] Using synchronous SGD
[2024-07-03 14:19:36] [comm] Compiled without MPI support. Running as a single process on nid005075
[2024-07-03 14:19:36] Synced seed 2222
[2024-07-03 14:19:36] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-03 14:19:36] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-03 14:19:36] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-03 14:19:36] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-03 14:19:36] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-03 14:19:41] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-03 14:19:41] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-03 14:19:41] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-03 14:19:41] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-03 14:19:41] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-03 14:19:41] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-03 14:19:41] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-03 14:19:41] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-03 14:19:41] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-03 14:19:43] [comm] Using global sharding
[2024-07-03 14:19:44] [comm] NCCLCommunicators constructed successfully
[2024-07-03 14:19:44] [training] Using 8 GPUs
[2024-07-03 14:19:44] [logits] Applying loss function for 1 factor(s)
[2024-07-03 14:19:44] [memory] Reserving 945 MB, device gpu0
[2024-07-03 14:19:50] [memory] Reserving 945 MB, device gpu0
[2024-07-03 14:20:23] [batching] Done. Typical MB size is 699,120 target words
[2024-07-03 14:20:24] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-03 14:20:24] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-03 14:20:24] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-03 14:20:24] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-03 14:20:24] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-03 14:20:24] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-03 14:20:24] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-03 14:20:24] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-03 14:20:24] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-03 14:20:24] [comm] Using global sharding
[2024-07-03 14:20:24] [comm] NCCLCommunicators constructed successfully
[2024-07-03 14:20:24] [training] Using 8 GPUs
[2024-07-03 14:20:24] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-03 14:20:42] Allocating memory for general optimizer shards
[2024-07-03 14:20:42] [memory] Reserving 118 MB, device gpu0
[2024-07-03 14:20:42] [memory] Reserving 118 MB, device gpu1
[2024-07-03 14:20:42] [memory] Reserving 118 MB, device gpu2
[2024-07-03 14:20:42] [memory] Reserving 118 MB, device gpu3
[2024-07-03 14:20:42] [memory] Reserving 118 MB, device gpu4
[2024-07-03 14:20:42] [memory] Reserving 118 MB, device gpu5
[2024-07-03 14:20:42] [memory] Reserving 118 MB, device gpu6
[2024-07-03 14:20:42] [memory] Reserving 118 MB, device gpu7
[2024-07-03 14:20:43] Loading Adam parameters
[2024-07-03 14:20:44] [memory] Reserving 236 MB, device gpu0
[2024-07-03 14:20:45] [memory] Reserving 236 MB, device gpu1
[2024-07-03 14:20:45] [memory] Reserving 236 MB, device gpu2
[2024-07-03 14:20:45] [memory] Reserving 236 MB, device gpu3
[2024-07-03 14:20:45] [memory] Reserving 236 MB, device gpu4
[2024-07-03 14:20:45] [memory] Reserving 236 MB, device gpu5
[2024-07-03 14:20:45] [memory] Reserving 236 MB, device gpu6
[2024-07-03 14:20:46] [memory] Reserving 236 MB, device gpu7
[2024-07-03 14:20:46] [memory] Reserving 945 MB, device gpu0
[2024-07-03 14:20:46] [memory] Reserving 945 MB, device gpu1
[2024-07-03 14:20:46] [memory] Reserving 945 MB, device gpu2
[2024-07-03 14:20:47] [memory] Reserving 945 MB, device gpu3
[2024-07-03 14:20:47] [memory] Reserving 945 MB, device gpu4
[2024-07-03 14:20:47] [memory] Reserving 945 MB, device gpu5
[2024-07-03 14:20:47] [memory] Reserving 945 MB, device gpu6
[2024-07-03 14:20:48] [memory] Reserving 945 MB, device gpu7
[2024-07-03 14:20:48] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-03 14:20:48] [data] Restoring the corpus state to epoch 1, batch 370000
[2024-07-03 14:22:05] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-03 14:22:05] [marian] Running on nid005069 as process 31137 with command line:
[2024-07-03 14:22:05] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-03 14:22:07] [config] after: 0e
[2024-07-03 14:22:07] [config] after-batches: 0
[2024-07-03 14:22:07] [config] after-epochs: 0
[2024-07-03 14:22:07] [config] all-caps-every: 0
[2024-07-03 14:22:07] [config] allow-unk: true
[2024-07-03 14:22:07] [config] authors: false
[2024-07-03 14:22:07] [config] beam-size: 6
[2024-07-03 14:22:07] [config] bert-class-symbol: "[CLS]"
[2024-07-03 14:22:07] [config] bert-mask-symbol: "[MASK]"
[2024-07-03 14:22:07] [config] bert-masking-fraction: 0.15
[2024-07-03 14:22:07] [config] bert-sep-symbol: "[SEP]"
[2024-07-03 14:22:07] [config] bert-train-type-embeddings: true
[2024-07-03 14:22:07] [config] bert-type-vocab-size: 2
[2024-07-03 14:22:07] [config] build-info: ""
[2024-07-03 14:22:07] [config] char-conv-filters-num:
[2024-07-03 14:22:07] [config]   - 200
[2024-07-03 14:22:07] [config]   - 200
[2024-07-03 14:22:07] [config]   - 250
[2024-07-03 14:22:07] [config]   - 250
[2024-07-03 14:22:07] [config]   - 300
[2024-07-03 14:22:07] [config]   - 300
[2024-07-03 14:22:07] [config]   - 300
[2024-07-03 14:22:07] [config]   - 300
[2024-07-03 14:22:07] [config] char-conv-filters-widths:
[2024-07-03 14:22:07] [config]   - 1
[2024-07-03 14:22:07] [config]   - 2
[2024-07-03 14:22:07] [config]   - 3
[2024-07-03 14:22:07] [config]   - 4
[2024-07-03 14:22:07] [config]   - 5
[2024-07-03 14:22:07] [config]   - 6
[2024-07-03 14:22:07] [config]   - 7
[2024-07-03 14:22:07] [config]   - 8
[2024-07-03 14:22:07] [config] char-highway: 4
[2024-07-03 14:22:07] [config] char-stride: 5
[2024-07-03 14:22:07] [config] check-gradient-nan: false
[2024-07-03 14:22:07] [config] check-nan: false
[2024-07-03 14:22:07] [config] cite: false
[2024-07-03 14:22:07] [config] clip-norm: 0
[2024-07-03 14:22:07] [config] cost-scaling:
[2024-07-03 14:22:07] [config]   []
[2024-07-03 14:22:07] [config] cost-type: ce-mean-words
[2024-07-03 14:22:07] [config] cpu-threads: 0
[2024-07-03 14:22:07] [config] data-threads: 8
[2024-07-03 14:22:07] [config] data-weighting: ""
[2024-07-03 14:22:07] [config] data-weighting-type: sentence
[2024-07-03 14:22:07] [config] dec-cell: gru
[2024-07-03 14:22:07] [config] dec-cell-base-depth: 2
[2024-07-03 14:22:07] [config] dec-cell-high-depth: 1
[2024-07-03 14:22:07] [config] dec-depth: 6
[2024-07-03 14:22:07] [config] devices:
[2024-07-03 14:22:07] [config]   - 0
[2024-07-03 14:22:07] [config]   - 1
[2024-07-03 14:22:07] [config]   - 2
[2024-07-03 14:22:07] [config]   - 3
[2024-07-03 14:22:07] [config]   - 4
[2024-07-03 14:22:07] [config]   - 5
[2024-07-03 14:22:07] [config]   - 6
[2024-07-03 14:22:07] [config]   - 7
[2024-07-03 14:22:07] [config] dim-emb: 1024
[2024-07-03 14:22:07] [config] dim-rnn: 1024
[2024-07-03 14:22:07] [config] dim-vocabs:
[2024-07-03 14:22:07] [config]   - 69666
[2024-07-03 14:22:07] [config]   - 69666
[2024-07-03 14:22:07] [config] disp-first: 10
[2024-07-03 14:22:07] [config] disp-freq: 10000
[2024-07-03 14:22:07] [config] disp-label-counts: true
[2024-07-03 14:22:07] [config] dropout-rnn: 0
[2024-07-03 14:22:07] [config] dropout-src: 0
[2024-07-03 14:22:07] [config] dropout-trg: 0
[2024-07-03 14:22:07] [config] dump-config: ""
[2024-07-03 14:22:07] [config] dynamic-gradient-scaling:
[2024-07-03 14:22:07] [config]   []
[2024-07-03 14:22:07] [config] early-stopping: 20
[2024-07-03 14:22:07] [config] early-stopping-on: first
[2024-07-03 14:22:07] [config] embedding-fix-src: false
[2024-07-03 14:22:07] [config] embedding-fix-trg: false
[2024-07-03 14:22:07] [config] embedding-normalization: false
[2024-07-03 14:22:07] [config] embedding-vectors:
[2024-07-03 14:22:07] [config]   []
[2024-07-03 14:22:07] [config] enc-cell: gru
[2024-07-03 14:22:07] [config] enc-cell-depth: 1
[2024-07-03 14:22:07] [config] enc-depth: 6
[2024-07-03 14:22:07] [config] enc-type: bidirectional
[2024-07-03 14:22:07] [config] english-title-case-every: 0
[2024-07-03 14:22:07] [config] exponential-smoothing: 0.0001
[2024-07-03 14:22:07] [config] factor-weight: 1
[2024-07-03 14:22:07] [config] factors-combine: sum
[2024-07-03 14:22:07] [config] factors-dim-emb: 0
[2024-07-03 14:22:07] [config] gradient-checkpointing: false
[2024-07-03 14:22:07] [config] gradient-norm-average-window: 100
[2024-07-03 14:22:07] [config] guided-alignment: none
[2024-07-03 14:22:07] [config] guided-alignment-cost: ce
[2024-07-03 14:22:07] [config] guided-alignment-weight: 0.1
[2024-07-03 14:22:07] [config] ignore-model-config: false
[2024-07-03 14:22:07] [config] input-types:
[2024-07-03 14:22:07] [config]   []
[2024-07-03 14:22:07] [config] interpolate-env-vars: false
[2024-07-03 14:22:07] [config] keep-best: true
[2024-07-03 14:22:07] [config] label-smoothing: 0.1
[2024-07-03 14:22:07] [config] layer-normalization: false
[2024-07-03 14:22:07] [config] learn-rate: 0.0002
[2024-07-03 14:22:07] [config] lemma-dependency: ""
[2024-07-03 14:22:07] [config] lemma-dim-emb: 0
[2024-07-03 14:22:07] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-03 14:22:07] [config] log-level: info
[2024-07-03 14:22:07] [config] log-time-zone: ""
[2024-07-03 14:22:07] [config] logical-epoch:
[2024-07-03 14:22:07] [config]   - 1e
[2024-07-03 14:22:07] [config]   - 0
[2024-07-03 14:22:07] [config] lr-decay: 0
[2024-07-03 14:22:07] [config] lr-decay-freq: 50000
[2024-07-03 14:22:07] [config] lr-decay-inv-sqrt:
[2024-07-03 14:22:07] [config]   - 8000
[2024-07-03 14:22:07] [config] lr-decay-repeat-warmup: false
[2024-07-03 14:22:07] [config] lr-decay-reset-optimizer: false
[2024-07-03 14:22:07] [config] lr-decay-start:
[2024-07-03 14:22:07] [config]   - 10
[2024-07-03 14:22:07] [config]   - 1
[2024-07-03 14:22:07] [config] lr-decay-strategy: epoch+stalled
[2024-07-03 14:22:07] [config] lr-report: false
[2024-07-03 14:22:07] [config] lr-warmup: 8000
[2024-07-03 14:22:07] [config] lr-warmup-at-reload: false
[2024-07-03 14:22:07] [config] lr-warmup-cycle: true
[2024-07-03 14:22:07] [config] lr-warmup-start-rate: 0
[2024-07-03 14:22:07] [config] max-length: 100
[2024-07-03 14:22:07] [config] max-length-crop: false
[2024-07-03 14:22:07] [config] max-length-factor: 3
[2024-07-03 14:22:07] [config] maxi-batch: 1000
[2024-07-03 14:22:07] [config] maxi-batch-sort: trg
[2024-07-03 14:22:07] [config] mini-batch: 1000
[2024-07-03 14:22:07] [config] mini-batch-fit: true
[2024-07-03 14:22:07] [config] mini-batch-fit-step: 10
[2024-07-03 14:22:07] [config] mini-batch-round-up: true
[2024-07-03 14:22:07] [config] mini-batch-track-lr: false
[2024-07-03 14:22:07] [config] mini-batch-warmup: 0
[2024-07-03 14:22:07] [config] mini-batch-words: 0
[2024-07-03 14:22:07] [config] mini-batch-words-ref: 0
[2024-07-03 14:22:07] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-03 14:22:07] [config] multi-loss-type: sum
[2024-07-03 14:22:07] [config] n-best: false
[2024-07-03 14:22:07] [config] no-nccl: false
[2024-07-03 14:22:07] [config] no-reload: false
[2024-07-03 14:22:07] [config] no-restore-corpus: false
[2024-07-03 14:22:07] [config] normalize: 1
[2024-07-03 14:22:07] [config] normalize-gradient: false
[2024-07-03 14:22:07] [config] num-devices: 0
[2024-07-03 14:22:07] [config] optimizer: adam
[2024-07-03 14:22:07] [config] optimizer-delay: 10
[2024-07-03 14:22:07] [config] optimizer-params:
[2024-07-03 14:22:07] [config]   - 0.9
[2024-07-03 14:22:07] [config]   - 0.998
[2024-07-03 14:22:07] [config]   - 1e-09
[2024-07-03 14:22:07] [config] output-omit-bias: false
[2024-07-03 14:22:07] [config] overwrite: true
[2024-07-03 14:22:07] [config] precision:
[2024-07-03 14:22:07] [config]   - float32
[2024-07-03 14:22:07] [config]   - float32
[2024-07-03 14:22:07] [config] pretrained-model: ""
[2024-07-03 14:22:07] [config] quantize-biases: false
[2024-07-03 14:22:07] [config] quantize-bits: 0
[2024-07-03 14:22:07] [config] quantize-log-based: false
[2024-07-03 14:22:07] [config] quantize-optimization-steps: 0
[2024-07-03 14:22:07] [config] quiet: false
[2024-07-03 14:22:07] [config] quiet-translation: false
[2024-07-03 14:22:07] [config] relative-paths: false
[2024-07-03 14:22:07] [config] right-left: false
[2024-07-03 14:22:07] [config] save-freq: 10000
[2024-07-03 14:22:07] [config] seed: 2222
[2024-07-03 14:22:07] [config] sentencepiece-alphas:
[2024-07-03 14:22:07] [config]   []
[2024-07-03 14:22:07] [config] sentencepiece-max-lines: 2000000
[2024-07-03 14:22:07] [config] sentencepiece-options: ""
[2024-07-03 14:22:07] [config] sharding: local
[2024-07-03 14:22:07] [config] shuffle: batches
[2024-07-03 14:22:07] [config] shuffle-in-ram: false
[2024-07-03 14:22:07] [config] sigterm: save-and-exit
[2024-07-03 14:22:07] [config] skip: false
[2024-07-03 14:22:07] [config] sqlite: ""
[2024-07-03 14:22:07] [config] sqlite-drop: false
[2024-07-03 14:22:07] [config] sync-freq: 200u
[2024-07-03 14:22:07] [config] sync-sgd: true
[2024-07-03 14:22:07] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-03 14:22:07] [config] tied-embeddings: false
[2024-07-03 14:22:07] [config] tied-embeddings-all: true
[2024-07-03 14:22:07] [config] tied-embeddings-src: false
[2024-07-03 14:22:07] [config] train-embedder-rank:
[2024-07-03 14:22:07] [config]   []
[2024-07-03 14:22:07] [config] train-sets:
[2024-07-03 14:22:07] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-03 14:22:07] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-03 14:22:07] [config] transformer-aan-activation: swish
[2024-07-03 14:22:07] [config] transformer-aan-depth: 2
[2024-07-03 14:22:07] [config] transformer-aan-nogate: false
[2024-07-03 14:22:07] [config] transformer-decoder-autoreg: self-attention
[2024-07-03 14:22:07] [config] transformer-decoder-dim-ffn: 0
[2024-07-03 14:22:07] [config] transformer-decoder-ffn-depth: 0
[2024-07-03 14:22:07] [config] transformer-depth-scaling: false
[2024-07-03 14:22:07] [config] transformer-dim-aan: 2048
[2024-07-03 14:22:07] [config] transformer-dim-ffn: 4096
[2024-07-03 14:22:07] [config] transformer-dropout: 0.1
[2024-07-03 14:22:07] [config] transformer-dropout-attention: 0
[2024-07-03 14:22:07] [config] transformer-dropout-ffn: 0
[2024-07-03 14:22:07] [config] transformer-ffn-activation: relu
[2024-07-03 14:22:07] [config] transformer-ffn-depth: 2
[2024-07-03 14:22:07] [config] transformer-guided-alignment-layer: last
[2024-07-03 14:22:07] [config] transformer-heads: 16
[2024-07-03 14:22:07] [config] transformer-no-projection: false
[2024-07-03 14:22:07] [config] transformer-pool: false
[2024-07-03 14:22:07] [config] transformer-postprocess: dan
[2024-07-03 14:22:07] [config] transformer-postprocess-emb: d
[2024-07-03 14:22:07] [config] transformer-postprocess-top: ""
[2024-07-03 14:22:07] [config] transformer-preprocess: ""
[2024-07-03 14:22:07] [config] transformer-rnn-projection: false
[2024-07-03 14:22:07] [config] transformer-tied-layers:
[2024-07-03 14:22:07] [config]   []
[2024-07-03 14:22:07] [config] transformer-train-position-embeddings: false
[2024-07-03 14:22:07] [config] tsv: false
[2024-07-03 14:22:07] [config] tsv-fields: 0
[2024-07-03 14:22:07] [config] type: transformer
[2024-07-03 14:22:07] [config] ulr: false
[2024-07-03 14:22:07] [config] ulr-dim-emb: 0
[2024-07-03 14:22:07] [config] ulr-dropout: 0
[2024-07-03 14:22:07] [config] ulr-keys-vectors: ""
[2024-07-03 14:22:07] [config] ulr-query-vectors: ""
[2024-07-03 14:22:07] [config] ulr-softmax-temperature: 1
[2024-07-03 14:22:07] [config] ulr-trainable-transformation: false
[2024-07-03 14:22:07] [config] unlikelihood-loss: false
[2024-07-03 14:22:07] [config] valid-freq: 10000
[2024-07-03 14:22:07] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-03 14:22:07] [config] valid-max-length: 100
[2024-07-03 14:22:07] [config] valid-metrics:
[2024-07-03 14:22:07] [config]   - perplexity
[2024-07-03 14:22:07] [config] valid-mini-batch: 16
[2024-07-03 14:22:07] [config] valid-reset-stalled: false
[2024-07-03 14:22:07] [config] valid-script-args:
[2024-07-03 14:22:07] [config]   []
[2024-07-03 14:22:07] [config] valid-script-path: ""
[2024-07-03 14:22:07] [config] valid-sets:
[2024-07-03 14:22:07] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-03 14:22:07] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-03 14:22:07] [config] valid-translation-output: ""
[2024-07-03 14:22:07] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-03 14:22:07] [config] vocabs:
[2024-07-03 14:22:07] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-03 14:22:07] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-03 14:22:07] [config] word-penalty: 0
[2024-07-03 14:22:07] [config] word-scores: false
[2024-07-03 14:22:07] [config] workspace: 20000
[2024-07-03 14:22:07] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-03 14:22:07] Using synchronous SGD
[2024-07-03 14:22:07] [comm] Compiled without MPI support. Running as a single process on nid005069
[2024-07-03 14:22:07] Synced seed 2222
[2024-07-03 14:22:07] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-03 14:22:07] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-03 14:22:07] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-03 14:22:08] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-03 14:22:08] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-03 14:22:09] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-03 14:22:09] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-03 14:22:09] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-03 14:22:09] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-03 14:22:09] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-03 14:22:09] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-03 14:22:09] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-03 14:22:09] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-03 14:22:09] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-03 14:22:11] [comm] Using global sharding
[2024-07-03 14:22:12] [comm] NCCLCommunicators constructed successfully
[2024-07-03 14:22:12] [training] Using 8 GPUs
[2024-07-03 14:22:12] [logits] Applying loss function for 1 factor(s)
[2024-07-03 14:22:12] [memory] Reserving 945 MB, device gpu0
[2024-07-03 14:22:18] [memory] Reserving 945 MB, device gpu0
[2024-07-03 14:22:52] [batching] Done. Typical MB size is 699,120 target words
[2024-07-03 14:22:52] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-03 14:22:52] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-03 14:22:52] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-03 14:22:52] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-03 14:22:52] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-03 14:22:52] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-03 14:22:52] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-03 14:22:52] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-03 14:22:52] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-03 14:22:52] [comm] Using global sharding
[2024-07-03 14:22:53] [comm] NCCLCommunicators constructed successfully
[2024-07-03 14:22:53] [training] Using 8 GPUs
[2024-07-03 14:22:53] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-03 14:23:11] Allocating memory for general optimizer shards
[2024-07-03 14:23:11] [memory] Reserving 118 MB, device gpu0
[2024-07-03 14:23:11] [memory] Reserving 118 MB, device gpu1
[2024-07-03 14:23:11] [memory] Reserving 118 MB, device gpu2
[2024-07-03 14:23:11] [memory] Reserving 118 MB, device gpu3
[2024-07-03 14:23:11] [memory] Reserving 118 MB, device gpu4
[2024-07-03 14:23:11] [memory] Reserving 118 MB, device gpu5
[2024-07-03 14:23:11] [memory] Reserving 118 MB, device gpu6
[2024-07-03 14:23:11] [memory] Reserving 118 MB, device gpu7
[2024-07-03 14:23:11] Loading Adam parameters
[2024-07-03 14:23:13] [memory] Reserving 236 MB, device gpu0
[2024-07-03 14:23:13] [memory] Reserving 236 MB, device gpu1
[2024-07-03 14:23:13] [memory] Reserving 236 MB, device gpu2
[2024-07-03 14:23:13] [memory] Reserving 236 MB, device gpu3
[2024-07-03 14:23:13] [memory] Reserving 236 MB, device gpu4
[2024-07-03 14:23:14] [memory] Reserving 236 MB, device gpu5
[2024-07-03 14:23:14] [memory] Reserving 236 MB, device gpu6
[2024-07-03 14:23:14] [memory] Reserving 236 MB, device gpu7
[2024-07-03 14:23:14] [memory] Reserving 945 MB, device gpu0
[2024-07-03 14:23:15] [memory] Reserving 945 MB, device gpu1
[2024-07-03 14:23:15] [memory] Reserving 945 MB, device gpu2
[2024-07-03 14:23:15] [memory] Reserving 945 MB, device gpu3
[2024-07-03 14:23:15] [memory] Reserving 945 MB, device gpu4
[2024-07-03 14:23:16] [memory] Reserving 945 MB, device gpu5
[2024-07-03 14:23:16] [memory] Reserving 945 MB, device gpu6
[2024-07-03 14:23:16] [memory] Reserving 945 MB, device gpu7
[2024-07-03 14:23:17] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-03 14:23:17] [data] Restoring the corpus state to epoch 1, batch 370000
[2024-07-03 20:40:43] Training started
[2024-07-03 20:40:43] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-03 20:40:51] [memory] Reserving 945 MB, device gpu0
[2024-07-03 20:41:08] [memory] Reserving 945 MB, device gpu6
[2024-07-03 20:41:09] [memory] Reserving 945 MB, device gpu2
[2024-07-03 20:41:09] [memory] Reserving 945 MB, device gpu1
[2024-07-03 20:41:09] [memory] Reserving 945 MB, device gpu7
[2024-07-03 20:41:09] [memory] Reserving 945 MB, device gpu3
[2024-07-03 20:41:09] [memory] Reserving 945 MB, device gpu4
[2024-07-03 20:41:09] [memory] Reserving 945 MB, device gpu5
[2024-07-03 20:41:11] Parameter type float32, optimization type float32, casting types false
[2024-07-03 20:52:50] Training started
[2024-07-03 20:52:50] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-03 20:52:55] [memory] Reserving 945 MB, device gpu0
[2024-07-03 20:53:16] [memory] Reserving 945 MB, device gpu4
[2024-07-03 20:53:16] [memory] Reserving 945 MB, device gpu5
[2024-07-03 20:53:16] [memory] Reserving 945 MB, device gpu1
[2024-07-03 20:53:16] [memory] Reserving 945 MB, device gpu7
[2024-07-03 20:53:16] [memory] Reserving 945 MB, device gpu2
[2024-07-03 20:53:16] [memory] Reserving 945 MB, device gpu6
[2024-07-03 20:53:16] [memory] Reserving 945 MB, device gpu3
[2024-07-03 20:53:18] Parameter type float32, optimization type float32, casting types false
[2024-07-04 04:49:18] Ep. 1 : Up. 380000 : Sen. 2,918,925,638 : Cost 3.13019419 : Time 52134.43s : 51981.67 words/s : gNorm 1.2246
[2024-07-04 04:49:18] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-04 04:49:23] Saving Adam parameters
[2024-07-04 04:49:31] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-04 04:49:45] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-04 04:49:47] [valid] Ep. 1 : Up. 380000 : perplexity : 11.7283 : new best
[2024-07-04 05:00:09] Ep. 1 : Up. 380000 : Sen. 2,918,925,638 : Cost 3.13022876 : Time 52637.30s : 51485.06 words/s : gNorm 1.2279
[2024-07-04 05:00:09] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-04 05:00:14] Saving Adam parameters
[2024-07-04 05:00:22] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-04 05:00:36] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-04 05:00:38] [valid] Ep. 1 : Up. 380000 : perplexity : 11.7249 : new best
[2024-07-04 12:58:16] Ep. 1 : Up. 390000 : Sen. 2,995,753,157 : Cost 3.12983656 : Time 29338.15s : 92205.08 words/s : gNorm 0.9636
[2024-07-04 12:58:16] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-04 12:58:21] Saving Adam parameters
[2024-07-04 12:58:29] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-04 12:58:43] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-04 12:58:46] [valid] Ep. 1 : Up. 390000 : perplexity : 11.721 : new best
[2024-07-04 13:07:07] Ep. 1 : Up. 390000 : Sen. 2,995,753,157 : Cost 3.12982798 : Time 29217.46s : 92585.93 words/s : gNorm 0.9600
[2024-07-04 13:07:07] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-04 13:07:12] Saving Adam parameters
[2024-07-04 13:07:20] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-04 13:07:33] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-04 13:07:36] [valid] Ep. 1 : Up. 390000 : perplexity : 11.7151 : new best
[2024-07-04 21:06:48] Ep. 1 : Up. 400000 : Sen. 3,072,532,973 : Cost 3.13021231 : Time 29312.05s : 92257.56 words/s : gNorm 1.2581
[2024-07-04 21:06:48] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-04 21:06:53] Saving Adam parameters
[2024-07-04 21:07:01] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-04 21:07:15] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-04 21:07:18] [valid] Ep. 1 : Up. 400000 : perplexity : 11.7159 : new best
[2024-07-04 21:13:38] Ep. 1 : Up. 400000 : Sen. 3,072,532,973 : Cost 3.13030720 : Time 29190.70s : 92641.06 words/s : gNorm 1.2814
[2024-07-04 21:13:38] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-04 21:13:42] Saving Adam parameters
[2024-07-04 21:13:50] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-04 21:14:04] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-04 21:14:07] [valid] Ep. 1 : Up. 400000 : perplexity : 11.7128 : new best
[2024-07-05 05:15:24] Ep. 1 : Up. 410000 : Sen. 3,149,417,666 : Cost 3.12847328 : Time 29315.49s : 92246.58 words/s : gNorm 0.9919
[2024-07-05 05:15:24] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-05 05:15:29] Saving Adam parameters
[2024-07-05 05:15:37] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-05 05:15:51] [valid] Ep. 1 : Up. 410000 : perplexity : 11.7199 : stalled 1 times (last best: 11.7159)
[2024-07-05 05:19:57] Ep. 1 : Up. 410000 : Sen. 3,149,417,666 : Cost 3.12847018 : Time 29179.70s : 92675.88 words/s : gNorm 0.9981
[2024-07-05 05:19:58] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-05 05:20:02] Saving Adam parameters
[2024-07-05 05:20:10] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-05 05:20:24] [valid] Ep. 1 : Up. 410000 : perplexity : 11.7183 : stalled 1 times (last best: 11.7128)
[2024-07-05 13:24:10] Ep. 1 : Up. 420000 : Sen. 3,226,221,761 : Cost 3.12688541 : Time 29326.00s : 92295.28 words/s : gNorm 1.3686
[2024-07-05 13:24:10] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-05 13:24:15] Saving Adam parameters
[2024-07-05 13:24:23] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-05 13:24:37] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-05 13:24:40] [valid] Ep. 1 : Up. 420000 : perplexity : 11.7123 : new best
[2024-07-05 13:26:34] Ep. 1 : Up. 420000 : Sen. 3,226,221,761 : Cost 3.12692070 : Time 29196.12s : 92705.85 words/s : gNorm 1.3751
[2024-07-05 13:26:34] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-05 13:26:39] Saving Adam parameters
[2024-07-05 13:26:47] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-05 13:27:00] [valid] Ep. 1 : Up. 420000 : perplexity : 11.715 : stalled 2 times (last best: 11.7128)
[2024-07-05 21:31:54] Ep. 1 : Up. 430000 : Sen. 3,303,065,513 : Cost 3.12678051 : Time 29263.58s : 92421.58 words/s : gNorm 1.0830
[2024-07-05 21:31:54] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-05 21:31:59] Saving Adam parameters
[2024-07-05 21:32:06] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-05 21:32:20] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-05 21:32:23] [valid] Ep. 1 : Up. 430000 : perplexity : 11.7023 : new best
[2024-07-05 21:33:39] Ep. 1 : Up. 430000 : Sen. 3,303,065,513 : Cost 3.12687325 : Time 29225.42s : 92542.25 words/s : gNorm 1.0905
[2024-07-05 21:33:39] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-05 21:33:44] Saving Adam parameters
[2024-07-05 21:33:52] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-05 21:34:06] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-05 21:34:08] [valid] Ep. 1 : Up. 430000 : perplexity : 11.7034 : new best
[2024-07-06 05:40:45] Ep. 1 : Up. 440000 : Sen. 3,379,937,312 : Cost 3.12674499 : Time 29331.64s : 92314.21 words/s : gNorm 1.6571
[2024-07-06 05:40:45] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-06 05:40:50] Ep. 1 : Up. 440000 : Sen. 3,379,937,312 : Cost 3.12685537 : Time 29231.11s : 92631.69 words/s : gNorm 1.6499
[2024-07-06 05:40:50] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-06 05:40:51] Saving Adam parameters
[2024-07-06 05:40:55] Saving Adam parameters
[2024-07-06 05:40:58] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-06 05:41:03] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-06 05:41:11] Error: Unhandled exception of type 'St13runtime_error': npz_save: error saving to file: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-06 05:41:11] Error: Aborted from void unhandledException() in /scratch/project_462000088/lumi-marian/src/common/logging.cpp:120

[CALL STACK]
[0x15d8365]                                                           
[0x14aa5e7d3bfa]                                                       + 0xb0bfa
[0x14aa5e7d3c65]                                                       + 0xb0c65
[0x14aa5e7d3eb7]                                                       + 0xb0eb7
[0x168479c]                                                           
[0x1685149]                                                           
[0x1b18027]                                                           
[0x1b152bf]                                                           
[0x1b14d29]                                                           
[0x1afd919]                                                           
[0x1afd0b3]                                                           
[0x155dbe1]                                                           
[0x150ecb9]                                                           
[0x1514904]                                                           
[0x14aa5e1d024d]    __libc_start_main                                  + 0xef
[0x150e7aa]                                                           

[2024-07-06 05:41:12] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-06 05:41:15] [valid] Ep. 1 : Up. 440000 : perplexity : 11.6935 : new best
[2024-07-06 13:48:48] Ep. 1 : Up. 450000 : Sen. 3,456,680,468 : Cost 3.12525511 : Time 29282.77s : 92286.18 words/s : gNorm 1.4370
[2024-07-06 13:48:48] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-06 13:48:53] Saving Adam parameters
[2024-07-06 13:49:01] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-06 13:49:15] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-06 13:49:17] [valid] Ep. 1 : Up. 450000 : perplexity : 11.6879 : new best
[2024-07-07 08:26:26] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-07 08:26:26] [marian] Running on nid007944 as process 61503 with command line:
[2024-07-07 08:26:26] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-07 08:26:27] [config] after: 0e
[2024-07-07 08:26:27] [config] after-batches: 0
[2024-07-07 08:26:27] [config] after-epochs: 0
[2024-07-07 08:26:27] [config] all-caps-every: 0
[2024-07-07 08:26:27] [config] allow-unk: true
[2024-07-07 08:26:27] [config] authors: false
[2024-07-07 08:26:27] [config] beam-size: 6
[2024-07-07 08:26:27] [config] bert-class-symbol: "[CLS]"
[2024-07-07 08:26:27] [config] bert-mask-symbol: "[MASK]"
[2024-07-07 08:26:27] [config] bert-masking-fraction: 0.15
[2024-07-07 08:26:27] [config] bert-sep-symbol: "[SEP]"
[2024-07-07 08:26:27] [config] bert-train-type-embeddings: true
[2024-07-07 08:26:27] [config] bert-type-vocab-size: 2
[2024-07-07 08:26:27] [config] build-info: ""
[2024-07-07 08:26:27] [config] char-conv-filters-num:
[2024-07-07 08:26:27] [config]   - 200
[2024-07-07 08:26:27] [config]   - 200
[2024-07-07 08:26:27] [config]   - 250
[2024-07-07 08:26:27] [config]   - 250
[2024-07-07 08:26:27] [config]   - 300
[2024-07-07 08:26:27] [config]   - 300
[2024-07-07 08:26:27] [config]   - 300
[2024-07-07 08:26:27] [config]   - 300
[2024-07-07 08:26:27] [config] char-conv-filters-widths:
[2024-07-07 08:26:27] [config]   - 1
[2024-07-07 08:26:27] [config]   - 2
[2024-07-07 08:26:27] [config]   - 3
[2024-07-07 08:26:27] [config]   - 4
[2024-07-07 08:26:27] [config]   - 5
[2024-07-07 08:26:27] [config]   - 6
[2024-07-07 08:26:27] [config]   - 7
[2024-07-07 08:26:27] [config]   - 8
[2024-07-07 08:26:27] [config] char-highway: 4
[2024-07-07 08:26:27] [config] char-stride: 5
[2024-07-07 08:26:27] [config] check-gradient-nan: false
[2024-07-07 08:26:27] [config] check-nan: false
[2024-07-07 08:26:27] [config] cite: false
[2024-07-07 08:26:27] [config] clip-norm: 0
[2024-07-07 08:26:27] [config] cost-scaling:
[2024-07-07 08:26:27] [config]   []
[2024-07-07 08:26:27] [config] cost-type: ce-mean-words
[2024-07-07 08:26:27] [config] cpu-threads: 0
[2024-07-07 08:26:27] [config] data-threads: 8
[2024-07-07 08:26:27] [config] data-weighting: ""
[2024-07-07 08:26:27] [config] data-weighting-type: sentence
[2024-07-07 08:26:27] [config] dec-cell: gru
[2024-07-07 08:26:27] [config] dec-cell-base-depth: 2
[2024-07-07 08:26:27] [config] dec-cell-high-depth: 1
[2024-07-07 08:26:27] [config] dec-depth: 6
[2024-07-07 08:26:27] [config] devices:
[2024-07-07 08:26:27] [config]   - 0
[2024-07-07 08:26:27] [config]   - 1
[2024-07-07 08:26:27] [config]   - 2
[2024-07-07 08:26:27] [config]   - 3
[2024-07-07 08:26:27] [config]   - 4
[2024-07-07 08:26:27] [config]   - 5
[2024-07-07 08:26:27] [config]   - 6
[2024-07-07 08:26:27] [config]   - 7
[2024-07-07 08:26:27] [config] dim-emb: 1024
[2024-07-07 08:26:27] [config] dim-rnn: 1024
[2024-07-07 08:26:27] [config] dim-vocabs:
[2024-07-07 08:26:27] [config]   - 69666
[2024-07-07 08:26:27] [config]   - 69666
[2024-07-07 08:26:27] [config] disp-first: 10
[2024-07-07 08:26:27] [config] disp-freq: 10000
[2024-07-07 08:26:27] [config] disp-label-counts: true
[2024-07-07 08:26:27] [config] dropout-rnn: 0
[2024-07-07 08:26:27] [config] dropout-src: 0
[2024-07-07 08:26:27] [config] dropout-trg: 0
[2024-07-07 08:26:27] [config] dump-config: ""
[2024-07-07 08:26:27] [config] dynamic-gradient-scaling:
[2024-07-07 08:26:27] [config]   []
[2024-07-07 08:26:27] [config] early-stopping: 20
[2024-07-07 08:26:27] [config] early-stopping-on: first
[2024-07-07 08:26:27] [config] embedding-fix-src: false
[2024-07-07 08:26:27] [config] embedding-fix-trg: false
[2024-07-07 08:26:27] [config] embedding-normalization: false
[2024-07-07 08:26:27] [config] embedding-vectors:
[2024-07-07 08:26:27] [config]   []
[2024-07-07 08:26:27] [config] enc-cell: gru
[2024-07-07 08:26:27] [config] enc-cell-depth: 1
[2024-07-07 08:26:27] [config] enc-depth: 6
[2024-07-07 08:26:27] [config] enc-type: bidirectional
[2024-07-07 08:26:27] [config] english-title-case-every: 0
[2024-07-07 08:26:27] [config] exponential-smoothing: 0.0001
[2024-07-07 08:26:27] [config] factor-weight: 1
[2024-07-07 08:26:27] [config] factors-combine: sum
[2024-07-07 08:26:27] [config] factors-dim-emb: 0
[2024-07-07 08:26:27] [config] gradient-checkpointing: false
[2024-07-07 08:26:27] [config] gradient-norm-average-window: 100
[2024-07-07 08:26:27] [config] guided-alignment: none
[2024-07-07 08:26:27] [config] guided-alignment-cost: ce
[2024-07-07 08:26:27] [config] guided-alignment-weight: 0.1
[2024-07-07 08:26:27] [config] ignore-model-config: false
[2024-07-07 08:26:27] [config] input-types:
[2024-07-07 08:26:27] [config]   []
[2024-07-07 08:26:27] [config] interpolate-env-vars: false
[2024-07-07 08:26:27] [config] keep-best: true
[2024-07-07 08:26:27] [config] label-smoothing: 0.1
[2024-07-07 08:26:27] [config] layer-normalization: false
[2024-07-07 08:26:27] [config] learn-rate: 0.0002
[2024-07-07 08:26:27] [config] lemma-dependency: ""
[2024-07-07 08:26:27] [config] lemma-dim-emb: 0
[2024-07-07 08:26:27] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-07 08:26:27] [config] log-level: info
[2024-07-07 08:26:27] [config] log-time-zone: ""
[2024-07-07 08:26:27] [config] logical-epoch:
[2024-07-07 08:26:27] [config]   - 1e
[2024-07-07 08:26:27] [config]   - 0
[2024-07-07 08:26:27] [config] lr-decay: 0
[2024-07-07 08:26:27] [config] lr-decay-freq: 50000
[2024-07-07 08:26:27] [config] lr-decay-inv-sqrt:
[2024-07-07 08:26:27] [config]   - 8000
[2024-07-07 08:26:27] [config] lr-decay-repeat-warmup: false
[2024-07-07 08:26:27] [config] lr-decay-reset-optimizer: false
[2024-07-07 08:26:27] [config] lr-decay-start:
[2024-07-07 08:26:27] [config]   - 10
[2024-07-07 08:26:27] [config]   - 1
[2024-07-07 08:26:27] [config] lr-decay-strategy: epoch+stalled
[2024-07-07 08:26:27] [config] lr-report: false
[2024-07-07 08:26:27] [config] lr-warmup: 8000
[2024-07-07 08:26:27] [config] lr-warmup-at-reload: false
[2024-07-07 08:26:27] [config] lr-warmup-cycle: true
[2024-07-07 08:26:27] [config] lr-warmup-start-rate: 0
[2024-07-07 08:26:27] [config] max-length: 100
[2024-07-07 08:26:27] [config] max-length-crop: false
[2024-07-07 08:26:27] [config] max-length-factor: 3
[2024-07-07 08:26:27] [config] maxi-batch: 1000
[2024-07-07 08:26:27] [config] maxi-batch-sort: trg
[2024-07-07 08:26:27] [config] mini-batch: 1000
[2024-07-07 08:26:27] [config] mini-batch-fit: true
[2024-07-07 08:26:27] [config] mini-batch-fit-step: 10
[2024-07-07 08:26:27] [config] mini-batch-round-up: true
[2024-07-07 08:26:27] [config] mini-batch-track-lr: false
[2024-07-07 08:26:27] [config] mini-batch-warmup: 0
[2024-07-07 08:26:27] [config] mini-batch-words: 0
[2024-07-07 08:26:27] [config] mini-batch-words-ref: 0
[2024-07-07 08:26:27] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-07 08:26:27] [config] multi-loss-type: sum
[2024-07-07 08:26:27] [config] n-best: false
[2024-07-07 08:26:27] [config] no-nccl: false
[2024-07-07 08:26:27] [config] no-reload: false
[2024-07-07 08:26:27] [config] no-restore-corpus: false
[2024-07-07 08:26:27] [config] normalize: 1
[2024-07-07 08:26:27] [config] normalize-gradient: false
[2024-07-07 08:26:27] [config] num-devices: 0
[2024-07-07 08:26:27] [config] optimizer: adam
[2024-07-07 08:26:27] [config] optimizer-delay: 10
[2024-07-07 08:26:27] [config] optimizer-params:
[2024-07-07 08:26:27] [config]   - 0.9
[2024-07-07 08:26:27] [config]   - 0.998
[2024-07-07 08:26:27] [config]   - 1e-09
[2024-07-07 08:26:27] [config] output-omit-bias: false
[2024-07-07 08:26:27] [config] overwrite: true
[2024-07-07 08:26:27] [config] precision:
[2024-07-07 08:26:27] [config]   - float32
[2024-07-07 08:26:27] [config]   - float32
[2024-07-07 08:26:27] [config] pretrained-model: ""
[2024-07-07 08:26:27] [config] quantize-biases: false
[2024-07-07 08:26:27] [config] quantize-bits: 0
[2024-07-07 08:26:27] [config] quantize-log-based: false
[2024-07-07 08:26:27] [config] quantize-optimization-steps: 0
[2024-07-07 08:26:27] [config] quiet: false
[2024-07-07 08:26:27] [config] quiet-translation: false
[2024-07-07 08:26:27] [config] relative-paths: false
[2024-07-07 08:26:27] [config] right-left: false
[2024-07-07 08:26:27] [config] save-freq: 10000
[2024-07-07 08:26:27] [config] seed: 2222
[2024-07-07 08:26:27] [config] sentencepiece-alphas:
[2024-07-07 08:26:27] [config]   []
[2024-07-07 08:26:27] [config] sentencepiece-max-lines: 2000000
[2024-07-07 08:26:27] [config] sentencepiece-options: ""
[2024-07-07 08:26:27] [config] sharding: local
[2024-07-07 08:26:27] [config] shuffle: batches
[2024-07-07 08:26:27] [config] shuffle-in-ram: false
[2024-07-07 08:26:27] [config] sigterm: save-and-exit
[2024-07-07 08:26:27] [config] skip: false
[2024-07-07 08:26:27] [config] sqlite: ""
[2024-07-07 08:26:27] [config] sqlite-drop: false
[2024-07-07 08:26:27] [config] sync-freq: 200u
[2024-07-07 08:26:27] [config] sync-sgd: true
[2024-07-07 08:26:27] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-07 08:26:27] [config] tied-embeddings: false
[2024-07-07 08:26:27] [config] tied-embeddings-all: true
[2024-07-07 08:26:27] [config] tied-embeddings-src: false
[2024-07-07 08:26:27] [config] train-embedder-rank:
[2024-07-07 08:26:27] [config]   []
[2024-07-07 08:26:27] [config] train-sets:
[2024-07-07 08:26:27] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-07 08:26:27] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-07 08:26:27] [config] transformer-aan-activation: swish
[2024-07-07 08:26:27] [config] transformer-aan-depth: 2
[2024-07-07 08:26:27] [config] transformer-aan-nogate: false
[2024-07-07 08:26:27] [config] transformer-decoder-autoreg: self-attention
[2024-07-07 08:26:27] [config] transformer-decoder-dim-ffn: 0
[2024-07-07 08:26:27] [config] transformer-decoder-ffn-depth: 0
[2024-07-07 08:26:27] [config] transformer-depth-scaling: false
[2024-07-07 08:26:27] [config] transformer-dim-aan: 2048
[2024-07-07 08:26:27] [config] transformer-dim-ffn: 4096
[2024-07-07 08:26:27] [config] transformer-dropout: 0.1
[2024-07-07 08:26:27] [config] transformer-dropout-attention: 0
[2024-07-07 08:26:27] [config] transformer-dropout-ffn: 0
[2024-07-07 08:26:27] [config] transformer-ffn-activation: relu
[2024-07-07 08:26:27] [config] transformer-ffn-depth: 2
[2024-07-07 08:26:27] [config] transformer-guided-alignment-layer: last
[2024-07-07 08:26:27] [config] transformer-heads: 16
[2024-07-07 08:26:27] [config] transformer-no-projection: false
[2024-07-07 08:26:27] [config] transformer-pool: false
[2024-07-07 08:26:27] [config] transformer-postprocess: dan
[2024-07-07 08:26:27] [config] transformer-postprocess-emb: d
[2024-07-07 08:26:27] [config] transformer-postprocess-top: ""
[2024-07-07 08:26:27] [config] transformer-preprocess: ""
[2024-07-07 08:26:27] [config] transformer-rnn-projection: false
[2024-07-07 08:26:27] [config] transformer-tied-layers:
[2024-07-07 08:26:27] [config]   []
[2024-07-07 08:26:27] [config] transformer-train-position-embeddings: false
[2024-07-07 08:26:27] [config] tsv: false
[2024-07-07 08:26:27] [config] tsv-fields: 0
[2024-07-07 08:26:27] [config] type: transformer
[2024-07-07 08:26:27] [config] ulr: false
[2024-07-07 08:26:27] [config] ulr-dim-emb: 0
[2024-07-07 08:26:27] [config] ulr-dropout: 0
[2024-07-07 08:26:27] [config] ulr-keys-vectors: ""
[2024-07-07 08:26:27] [config] ulr-query-vectors: ""
[2024-07-07 08:26:27] [config] ulr-softmax-temperature: 1
[2024-07-07 08:26:27] [config] ulr-trainable-transformation: false
[2024-07-07 08:26:27] [config] unlikelihood-loss: false
[2024-07-07 08:26:27] [config] valid-freq: 10000
[2024-07-07 08:26:27] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-07 08:26:27] [config] valid-max-length: 100
[2024-07-07 08:26:27] [config] valid-metrics:
[2024-07-07 08:26:27] [config]   - perplexity
[2024-07-07 08:26:27] [config] valid-mini-batch: 16
[2024-07-07 08:26:27] [config] valid-reset-stalled: false
[2024-07-07 08:26:27] [config] valid-script-args:
[2024-07-07 08:26:27] [config]   []
[2024-07-07 08:26:27] [config] valid-script-path: ""
[2024-07-07 08:26:27] [config] valid-sets:
[2024-07-07 08:26:27] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-07 08:26:27] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-07 08:26:27] [config] valid-translation-output: ""
[2024-07-07 08:26:27] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-07 08:26:27] [config] vocabs:
[2024-07-07 08:26:27] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-07 08:26:27] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-07 08:26:27] [config] word-penalty: 0
[2024-07-07 08:26:27] [config] word-scores: false
[2024-07-07 08:26:27] [config] workspace: 20000
[2024-07-07 08:26:27] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-07 08:26:27] Using synchronous SGD
[2024-07-07 08:26:27] [comm] Compiled without MPI support. Running as a single process on nid007944
[2024-07-07 08:26:27] Synced seed 2222
[2024-07-07 08:26:27] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-07 08:26:28] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-07 08:26:28] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-07 08:26:28] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-07 08:26:28] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-07 08:26:30] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-07 08:26:30] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-07 08:26:30] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-07 08:26:30] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-07 08:26:30] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-07 08:26:30] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-07 08:26:30] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-07 08:26:30] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-07 08:26:30] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-07 08:26:32] [comm] Using global sharding
[2024-07-07 08:26:33] [comm] NCCLCommunicators constructed successfully
[2024-07-07 08:26:33] [training] Using 8 GPUs
[2024-07-07 08:26:33] [logits] Applying loss function for 1 factor(s)
[2024-07-07 08:26:33] [memory] Reserving 945 MB, device gpu0
[2024-07-07 08:26:38] [memory] Reserving 945 MB, device gpu0
[2024-07-07 08:27:12] [batching] Done. Typical MB size is 699,120 target words
[2024-07-07 08:27:12] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-07 08:27:12] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-07 08:27:12] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-07 08:27:12] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-07 08:27:12] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-07 08:27:12] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-07 08:27:12] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-07 08:27:12] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-07 08:27:12] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-07 08:27:12] [comm] Using global sharding
[2024-07-07 08:27:13] [comm] NCCLCommunicators constructed successfully
[2024-07-07 08:27:13] [training] Using 8 GPUs
[2024-07-07 08:27:13] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-07 08:27:31] Allocating memory for general optimizer shards
[2024-07-07 08:27:31] [memory] Reserving 118 MB, device gpu0
[2024-07-07 08:27:31] [memory] Reserving 118 MB, device gpu1
[2024-07-07 08:27:31] [memory] Reserving 118 MB, device gpu2
[2024-07-07 08:27:31] [memory] Reserving 118 MB, device gpu3
[2024-07-07 08:27:31] [memory] Reserving 118 MB, device gpu4
[2024-07-07 08:27:31] [memory] Reserving 118 MB, device gpu5
[2024-07-07 08:27:31] [memory] Reserving 118 MB, device gpu6
[2024-07-07 08:27:31] [memory] Reserving 118 MB, device gpu7
[2024-07-07 08:27:31] Loading Adam parameters
[2024-07-07 08:27:33] [memory] Reserving 236 MB, device gpu0
[2024-07-07 08:27:33] [memory] Reserving 236 MB, device gpu1
[2024-07-07 08:27:33] [memory] Reserving 236 MB, device gpu2
[2024-07-07 08:27:33] [memory] Reserving 236 MB, device gpu3
[2024-07-07 08:27:33] [memory] Reserving 236 MB, device gpu4
[2024-07-07 08:27:34] [memory] Reserving 236 MB, device gpu5
[2024-07-07 08:27:34] [memory] Reserving 236 MB, device gpu6
[2024-07-07 08:27:34] [memory] Reserving 236 MB, device gpu7
[2024-07-07 08:27:34] [memory] Reserving 945 MB, device gpu0
[2024-07-07 08:27:34] [memory] Reserving 945 MB, device gpu1
[2024-07-07 08:27:35] [memory] Reserving 945 MB, device gpu2
[2024-07-07 08:27:35] [memory] Reserving 945 MB, device gpu3
[2024-07-07 08:27:35] [memory] Reserving 945 MB, device gpu4
[2024-07-07 08:27:35] [memory] Reserving 945 MB, device gpu5
[2024-07-07 08:27:35] [memory] Reserving 945 MB, device gpu6
[2024-07-07 08:27:35] [memory] Reserving 945 MB, device gpu7
[2024-07-07 08:27:36] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-07 08:27:36] [data] Restoring the corpus state to epoch 1, batch 450000
[2024-07-07 15:58:07] Training started
[2024-07-07 15:58:07] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-07 15:58:15] [memory] Reserving 945 MB, device gpu0
[2024-07-07 15:58:32] [memory] Reserving 945 MB, device gpu3
[2024-07-07 15:58:32] [memory] Reserving 945 MB, device gpu2
[2024-07-07 15:58:32] [memory] Reserving 945 MB, device gpu6
[2024-07-07 15:58:32] [memory] Reserving 945 MB, device gpu4
[2024-07-07 15:58:32] [memory] Reserving 945 MB, device gpu1
[2024-07-07 15:58:33] [memory] Reserving 945 MB, device gpu7
[2024-07-07 15:58:33] [memory] Reserving 945 MB, device gpu5
[2024-07-07 15:58:36] Parameter type float32, optimization type float32, casting types false
[2024-07-07 23:59:04] Ep. 1 : Up. 460000 : Sen. 3,533,525,465 : Cost 3.12434411 : Time 55911.33s : 48373.47 words/s : gNorm 1.0218
[2024-07-07 23:59:04] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-07 23:59:09] Saving Adam parameters
[2024-07-07 23:59:17] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-07 23:59:31] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-07 23:59:33] [valid] Ep. 1 : Up. 460000 : perplexity : 11.6847 : new best
[2024-07-08 08:00:36] Ep. 1 : Up. 470000 : Sen. 3,610,332,086 : Cost 3.12380981 : Time 28892.55s : 93666.45 words/s : gNorm 1.0736
[2024-07-08 08:00:36] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-08 08:00:41] Saving Adam parameters
[2024-07-08 08:00:49] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-08 08:01:03] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-08 08:01:05] [valid] Ep. 1 : Up. 470000 : perplexity : 11.6822 : new best
[2024-07-08 16:01:17] Ep. 1 : Up. 480000 : Sen. 3,687,166,195 : Cost 3.12455130 : Time 28840.18s : 93738.37 words/s : gNorm 1.5100
[2024-07-08 16:01:17] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-08 16:01:22] Saving Adam parameters
[2024-07-08 16:01:29] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-08 16:01:44] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-08 16:01:46] [valid] Ep. 1 : Up. 480000 : perplexity : 11.679 : new best
[2024-07-09 00:02:41] Ep. 1 : Up. 490000 : Sen. 3,764,016,374 : Cost 3.12261915 : Time 28883.98s : 93739.53 words/s : gNorm 1.2928
[2024-07-09 00:02:41] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-09 00:02:45] Saving Adam parameters
[2024-07-09 00:02:53] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-09 00:03:07] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-09 00:03:10] [valid] Ep. 1 : Up. 490000 : perplexity : 11.6749 : new best
[2024-07-09 08:03:16] Ep. 1 : Up. 500000 : Sen. 3,840,880,265 : Cost 3.12164116 : Time 28834.99s : 93863.32 words/s : gNorm 0.9664
[2024-07-09 08:03:16] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-09 08:03:21] Saving Adam parameters
[2024-07-09 08:03:28] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-09 08:03:42] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-09 08:03:45] [valid] Ep. 1 : Up. 500000 : perplexity : 11.6663 : new best
[2024-07-09 16:04:25] Ep. 1 : Up. 510000 : Sen. 3,917,713,438 : Cost 3.12175298 : Time 28869.54s : 93667.95 words/s : gNorm 1.6640
[2024-07-09 16:04:25] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-09 16:04:30] Saving Adam parameters
[2024-07-09 16:04:38] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-09 16:04:52] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-09 16:04:54] [valid] Ep. 1 : Up. 510000 : perplexity : 11.6624 : new best
[2024-07-10 00:05:34] Ep. 1 : Up. 520000 : Sen. 3,994,578,601 : Cost 3.12170887 : Time 28868.80s : 93814.17 words/s : gNorm 1.3256
[2024-07-10 00:05:34] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-10 00:05:39] Saving Adam parameters
[2024-07-10 00:05:47] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-10 00:06:01] [valid] Ep. 1 : Up. 520000 : perplexity : 11.6632 : stalled 1 times (last best: 11.6624)
[2024-07-10 08:07:00] Ep. 1 : Up. 530000 : Sen. 4,071,446,434 : Cost 3.12022781 : Time 28885.36s : 93687.72 words/s : gNorm 1.0941
[2024-07-10 08:07:00] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-10 08:07:05] Saving Adam parameters
[2024-07-10 08:07:13] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-10 08:07:27] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-10 08:07:29] [valid] Ep. 1 : Up. 530000 : perplexity : 11.6587 : new best
[2024-07-11 11:07:55] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-11 11:07:55] [marian] Running on nid005094 as process 51528 with command line:
[2024-07-11 11:07:55] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-11 11:07:57] [config] after: 0e
[2024-07-11 11:07:57] [config] after-batches: 0
[2024-07-11 11:07:57] [config] after-epochs: 0
[2024-07-11 11:07:57] [config] all-caps-every: 0
[2024-07-11 11:07:57] [config] allow-unk: true
[2024-07-11 11:07:57] [config] authors: false
[2024-07-11 11:07:57] [config] beam-size: 6
[2024-07-11 11:07:57] [config] bert-class-symbol: "[CLS]"
[2024-07-11 11:07:57] [config] bert-mask-symbol: "[MASK]"
[2024-07-11 11:07:57] [config] bert-masking-fraction: 0.15
[2024-07-11 11:07:57] [config] bert-sep-symbol: "[SEP]"
[2024-07-11 11:07:57] [config] bert-train-type-embeddings: true
[2024-07-11 11:07:57] [config] bert-type-vocab-size: 2
[2024-07-11 11:07:57] [config] build-info: ""
[2024-07-11 11:07:57] [config] char-conv-filters-num:
[2024-07-11 11:07:57] [config]   - 200
[2024-07-11 11:07:57] [config]   - 200
[2024-07-11 11:07:57] [config]   - 250
[2024-07-11 11:07:57] [config]   - 250
[2024-07-11 11:07:57] [config]   - 300
[2024-07-11 11:07:57] [config]   - 300
[2024-07-11 11:07:57] [config]   - 300
[2024-07-11 11:07:57] [config]   - 300
[2024-07-11 11:07:57] [config] char-conv-filters-widths:
[2024-07-11 11:07:57] [config]   - 1
[2024-07-11 11:07:57] [config]   - 2
[2024-07-11 11:07:57] [config]   - 3
[2024-07-11 11:07:57] [config]   - 4
[2024-07-11 11:07:57] [config]   - 5
[2024-07-11 11:07:57] [config]   - 6
[2024-07-11 11:07:57] [config]   - 7
[2024-07-11 11:07:57] [config]   - 8
[2024-07-11 11:07:57] [config] char-highway: 4
[2024-07-11 11:07:57] [config] char-stride: 5
[2024-07-11 11:07:57] [config] check-gradient-nan: false
[2024-07-11 11:07:57] [config] check-nan: false
[2024-07-11 11:07:57] [config] cite: false
[2024-07-11 11:07:57] [config] clip-norm: 0
[2024-07-11 11:07:57] [config] cost-scaling:
[2024-07-11 11:07:57] [config]   []
[2024-07-11 11:07:57] [config] cost-type: ce-mean-words
[2024-07-11 11:07:57] [config] cpu-threads: 0
[2024-07-11 11:07:57] [config] data-threads: 8
[2024-07-11 11:07:57] [config] data-weighting: ""
[2024-07-11 11:07:57] [config] data-weighting-type: sentence
[2024-07-11 11:07:57] [config] dec-cell: gru
[2024-07-11 11:07:57] [config] dec-cell-base-depth: 2
[2024-07-11 11:07:57] [config] dec-cell-high-depth: 1
[2024-07-11 11:07:57] [config] dec-depth: 6
[2024-07-11 11:07:57] [config] devices:
[2024-07-11 11:07:57] [config]   - 0
[2024-07-11 11:07:57] [config]   - 1
[2024-07-11 11:07:57] [config]   - 2
[2024-07-11 11:07:57] [config]   - 3
[2024-07-11 11:07:57] [config]   - 4
[2024-07-11 11:07:57] [config]   - 5
[2024-07-11 11:07:57] [config]   - 6
[2024-07-11 11:07:57] [config]   - 7
[2024-07-11 11:07:57] [config] dim-emb: 1024
[2024-07-11 11:07:57] [config] dim-rnn: 1024
[2024-07-11 11:07:57] [config] dim-vocabs:
[2024-07-11 11:07:57] [config]   - 69666
[2024-07-11 11:07:57] [config]   - 69666
[2024-07-11 11:07:57] [config] disp-first: 10
[2024-07-11 11:07:57] [config] disp-freq: 10000
[2024-07-11 11:07:57] [config] disp-label-counts: true
[2024-07-11 11:07:57] [config] dropout-rnn: 0
[2024-07-11 11:07:57] [config] dropout-src: 0
[2024-07-11 11:07:57] [config] dropout-trg: 0
[2024-07-11 11:07:57] [config] dump-config: ""
[2024-07-11 11:07:57] [config] dynamic-gradient-scaling:
[2024-07-11 11:07:57] [config]   []
[2024-07-11 11:07:57] [config] early-stopping: 20
[2024-07-11 11:07:57] [config] early-stopping-on: first
[2024-07-11 11:07:57] [config] embedding-fix-src: false
[2024-07-11 11:07:57] [config] embedding-fix-trg: false
[2024-07-11 11:07:57] [config] embedding-normalization: false
[2024-07-11 11:07:57] [config] embedding-vectors:
[2024-07-11 11:07:57] [config]   []
[2024-07-11 11:07:57] [config] enc-cell: gru
[2024-07-11 11:07:57] [config] enc-cell-depth: 1
[2024-07-11 11:07:57] [config] enc-depth: 6
[2024-07-11 11:07:57] [config] enc-type: bidirectional
[2024-07-11 11:07:57] [config] english-title-case-every: 0
[2024-07-11 11:07:57] [config] exponential-smoothing: 0.0001
[2024-07-11 11:07:57] [config] factor-weight: 1
[2024-07-11 11:07:57] [config] factors-combine: sum
[2024-07-11 11:07:57] [config] factors-dim-emb: 0
[2024-07-11 11:07:57] [config] gradient-checkpointing: false
[2024-07-11 11:07:57] [config] gradient-norm-average-window: 100
[2024-07-11 11:07:57] [config] guided-alignment: none
[2024-07-11 11:07:57] [config] guided-alignment-cost: ce
[2024-07-11 11:07:57] [config] guided-alignment-weight: 0.1
[2024-07-11 11:07:57] [config] ignore-model-config: false
[2024-07-11 11:07:57] [config] input-types:
[2024-07-11 11:07:57] [config]   []
[2024-07-11 11:07:57] [config] interpolate-env-vars: false
[2024-07-11 11:07:57] [config] keep-best: true
[2024-07-11 11:07:57] [config] label-smoothing: 0.1
[2024-07-11 11:07:57] [config] layer-normalization: false
[2024-07-11 11:07:57] [config] learn-rate: 0.0002
[2024-07-11 11:07:57] [config] lemma-dependency: ""
[2024-07-11 11:07:57] [config] lemma-dim-emb: 0
[2024-07-11 11:07:57] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-11 11:07:57] [config] log-level: info
[2024-07-11 11:07:57] [config] log-time-zone: ""
[2024-07-11 11:07:57] [config] logical-epoch:
[2024-07-11 11:07:57] [config]   - 1e
[2024-07-11 11:07:57] [config]   - 0
[2024-07-11 11:07:57] [config] lr-decay: 0
[2024-07-11 11:07:57] [config] lr-decay-freq: 50000
[2024-07-11 11:07:57] [config] lr-decay-inv-sqrt:
[2024-07-11 11:07:57] [config]   - 8000
[2024-07-11 11:07:57] [config] lr-decay-repeat-warmup: false
[2024-07-11 11:07:57] [config] lr-decay-reset-optimizer: false
[2024-07-11 11:07:57] [config] lr-decay-start:
[2024-07-11 11:07:57] [config]   - 10
[2024-07-11 11:07:57] [config]   - 1
[2024-07-11 11:07:57] [config] lr-decay-strategy: epoch+stalled
[2024-07-11 11:07:57] [config] lr-report: false
[2024-07-11 11:07:57] [config] lr-warmup: 8000
[2024-07-11 11:07:57] [config] lr-warmup-at-reload: false
[2024-07-11 11:07:57] [config] lr-warmup-cycle: true
[2024-07-11 11:07:57] [config] lr-warmup-start-rate: 0
[2024-07-11 11:07:57] [config] max-length: 100
[2024-07-11 11:07:57] [config] max-length-crop: false
[2024-07-11 11:07:57] [config] max-length-factor: 3
[2024-07-11 11:07:57] [config] maxi-batch: 1000
[2024-07-11 11:07:57] [config] maxi-batch-sort: trg
[2024-07-11 11:07:57] [config] mini-batch: 1000
[2024-07-11 11:07:57] [config] mini-batch-fit: true
[2024-07-11 11:07:57] [config] mini-batch-fit-step: 10
[2024-07-11 11:07:57] [config] mini-batch-round-up: true
[2024-07-11 11:07:57] [config] mini-batch-track-lr: false
[2024-07-11 11:07:57] [config] mini-batch-warmup: 0
[2024-07-11 11:07:57] [config] mini-batch-words: 0
[2024-07-11 11:07:57] [config] mini-batch-words-ref: 0
[2024-07-11 11:07:57] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-11 11:07:57] [config] multi-loss-type: sum
[2024-07-11 11:07:57] [config] n-best: false
[2024-07-11 11:07:57] [config] no-nccl: false
[2024-07-11 11:07:57] [config] no-reload: false
[2024-07-11 11:07:57] [config] no-restore-corpus: false
[2024-07-11 11:07:57] [config] normalize: 1
[2024-07-11 11:07:57] [config] normalize-gradient: false
[2024-07-11 11:07:57] [config] num-devices: 0
[2024-07-11 11:07:57] [config] optimizer: adam
[2024-07-11 11:07:57] [config] optimizer-delay: 10
[2024-07-11 11:07:57] [config] optimizer-params:
[2024-07-11 11:07:57] [config]   - 0.9
[2024-07-11 11:07:57] [config]   - 0.998
[2024-07-11 11:07:57] [config]   - 1e-09
[2024-07-11 11:07:57] [config] output-omit-bias: false
[2024-07-11 11:07:57] [config] overwrite: true
[2024-07-11 11:07:57] [config] precision:
[2024-07-11 11:07:57] [config]   - float32
[2024-07-11 11:07:57] [config]   - float32
[2024-07-11 11:07:57] [config] pretrained-model: ""
[2024-07-11 11:07:57] [config] quantize-biases: false
[2024-07-11 11:07:57] [config] quantize-bits: 0
[2024-07-11 11:07:57] [config] quantize-log-based: false
[2024-07-11 11:07:57] [config] quantize-optimization-steps: 0
[2024-07-11 11:07:57] [config] quiet: false
[2024-07-11 11:07:57] [config] quiet-translation: false
[2024-07-11 11:07:57] [config] relative-paths: false
[2024-07-11 11:07:57] [config] right-left: false
[2024-07-11 11:07:57] [config] save-freq: 10000
[2024-07-11 11:07:57] [config] seed: 2222
[2024-07-11 11:07:57] [config] sentencepiece-alphas:
[2024-07-11 11:07:57] [config]   []
[2024-07-11 11:07:57] [config] sentencepiece-max-lines: 2000000
[2024-07-11 11:07:57] [config] sentencepiece-options: ""
[2024-07-11 11:07:57] [config] sharding: local
[2024-07-11 11:07:57] [config] shuffle: batches
[2024-07-11 11:07:57] [config] shuffle-in-ram: false
[2024-07-11 11:07:57] [config] sigterm: save-and-exit
[2024-07-11 11:07:57] [config] skip: false
[2024-07-11 11:07:57] [config] sqlite: ""
[2024-07-11 11:07:57] [config] sqlite-drop: false
[2024-07-11 11:07:57] [config] sync-freq: 200u
[2024-07-11 11:07:57] [config] sync-sgd: true
[2024-07-11 11:07:57] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-11 11:07:57] [config] tied-embeddings: false
[2024-07-11 11:07:57] [config] tied-embeddings-all: true
[2024-07-11 11:07:57] [config] tied-embeddings-src: false
[2024-07-11 11:07:57] [config] train-embedder-rank:
[2024-07-11 11:07:57] [config]   []
[2024-07-11 11:07:57] [config] train-sets:
[2024-07-11 11:07:57] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-11 11:07:57] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-11 11:07:57] [config] transformer-aan-activation: swish
[2024-07-11 11:07:57] [config] transformer-aan-depth: 2
[2024-07-11 11:07:57] [config] transformer-aan-nogate: false
[2024-07-11 11:07:57] [config] transformer-decoder-autoreg: self-attention
[2024-07-11 11:07:57] [config] transformer-decoder-dim-ffn: 0
[2024-07-11 11:07:57] [config] transformer-decoder-ffn-depth: 0
[2024-07-11 11:07:57] [config] transformer-depth-scaling: false
[2024-07-11 11:07:57] [config] transformer-dim-aan: 2048
[2024-07-11 11:07:57] [config] transformer-dim-ffn: 4096
[2024-07-11 11:07:57] [config] transformer-dropout: 0.1
[2024-07-11 11:07:57] [config] transformer-dropout-attention: 0
[2024-07-11 11:07:57] [config] transformer-dropout-ffn: 0
[2024-07-11 11:07:57] [config] transformer-ffn-activation: relu
[2024-07-11 11:07:57] [config] transformer-ffn-depth: 2
[2024-07-11 11:07:57] [config] transformer-guided-alignment-layer: last
[2024-07-11 11:07:57] [config] transformer-heads: 16
[2024-07-11 11:07:57] [config] transformer-no-projection: false
[2024-07-11 11:07:57] [config] transformer-pool: false
[2024-07-11 11:07:57] [config] transformer-postprocess: dan
[2024-07-11 11:07:57] [config] transformer-postprocess-emb: d
[2024-07-11 11:07:57] [config] transformer-postprocess-top: ""
[2024-07-11 11:07:57] [config] transformer-preprocess: ""
[2024-07-11 11:07:57] [config] transformer-rnn-projection: false
[2024-07-11 11:07:57] [config] transformer-tied-layers:
[2024-07-11 11:07:57] [config]   []
[2024-07-11 11:07:57] [config] transformer-train-position-embeddings: false
[2024-07-11 11:07:57] [config] tsv: false
[2024-07-11 11:07:57] [config] tsv-fields: 0
[2024-07-11 11:07:57] [config] type: transformer
[2024-07-11 11:07:57] [config] ulr: false
[2024-07-11 11:07:57] [config] ulr-dim-emb: 0
[2024-07-11 11:07:57] [config] ulr-dropout: 0
[2024-07-11 11:07:57] [config] ulr-keys-vectors: ""
[2024-07-11 11:07:57] [config] ulr-query-vectors: ""
[2024-07-11 11:07:57] [config] ulr-softmax-temperature: 1
[2024-07-11 11:07:57] [config] ulr-trainable-transformation: false
[2024-07-11 11:07:57] [config] unlikelihood-loss: false
[2024-07-11 11:07:57] [config] valid-freq: 10000
[2024-07-11 11:07:57] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-11 11:07:57] [config] valid-max-length: 100
[2024-07-11 11:07:57] [config] valid-metrics:
[2024-07-11 11:07:57] [config]   - perplexity
[2024-07-11 11:07:57] [config] valid-mini-batch: 16
[2024-07-11 11:07:57] [config] valid-reset-stalled: false
[2024-07-11 11:07:57] [config] valid-script-args:
[2024-07-11 11:07:57] [config]   []
[2024-07-11 11:07:57] [config] valid-script-path: ""
[2024-07-11 11:07:57] [config] valid-sets:
[2024-07-11 11:07:57] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-11 11:07:57] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-11 11:07:57] [config] valid-translation-output: ""
[2024-07-11 11:07:57] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-11 11:07:57] [config] vocabs:
[2024-07-11 11:07:57] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-11 11:07:57] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-11 11:07:57] [config] word-penalty: 0
[2024-07-11 11:07:57] [config] word-scores: false
[2024-07-11 11:07:57] [config] workspace: 20000
[2024-07-11 11:07:57] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-11 11:07:57] Using synchronous SGD
[2024-07-11 11:07:57] [comm] Compiled without MPI support. Running as a single process on nid005094
[2024-07-11 11:07:57] Synced seed 2222
[2024-07-11 11:07:57] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-11 11:07:57] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-11 11:07:57] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-11 11:07:58] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-11 11:07:58] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-11 11:07:59] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-11 11:07:59] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-11 11:07:59] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-11 11:07:59] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-11 11:07:59] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-11 11:07:59] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-11 11:07:59] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-11 11:07:59] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-11 11:07:59] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-11 11:08:01] [comm] Using global sharding
[2024-07-11 11:08:02] [comm] NCCLCommunicators constructed successfully
[2024-07-11 11:08:02] [training] Using 8 GPUs
[2024-07-11 11:08:02] [logits] Applying loss function for 1 factor(s)
[2024-07-11 11:08:02] [memory] Reserving 945 MB, device gpu0
[2024-07-11 11:08:08] [memory] Reserving 945 MB, device gpu0
[2024-07-11 11:08:42] [batching] Done. Typical MB size is 699,120 target words
[2024-07-11 11:08:42] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-11 11:08:42] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-11 11:08:42] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-11 11:08:42] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-11 11:08:42] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-11 11:08:42] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-11 11:08:42] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-11 11:08:42] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-11 11:08:42] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-11 11:08:42] [comm] Using global sharding
[2024-07-11 11:08:43] [comm] NCCLCommunicators constructed successfully
[2024-07-11 11:08:43] [training] Using 8 GPUs
[2024-07-11 11:08:43] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-11 11:09:09] Allocating memory for general optimizer shards
[2024-07-11 11:09:09] [memory] Reserving 118 MB, device gpu0
[2024-07-11 11:09:09] [memory] Reserving 118 MB, device gpu1
[2024-07-11 11:09:09] [memory] Reserving 118 MB, device gpu2
[2024-07-11 11:09:09] [memory] Reserving 118 MB, device gpu3
[2024-07-11 11:09:09] [memory] Reserving 118 MB, device gpu4
[2024-07-11 11:09:09] [memory] Reserving 118 MB, device gpu5
[2024-07-11 11:09:09] [memory] Reserving 118 MB, device gpu6
[2024-07-11 11:09:09] [memory] Reserving 118 MB, device gpu7
[2024-07-11 11:09:09] Loading Adam parameters
[2024-07-11 11:09:11] [memory] Reserving 236 MB, device gpu0
[2024-07-11 11:09:11] [memory] Reserving 236 MB, device gpu1
[2024-07-11 11:09:11] [memory] Reserving 236 MB, device gpu2
[2024-07-11 11:09:12] [memory] Reserving 236 MB, device gpu3
[2024-07-11 11:09:12] [memory] Reserving 236 MB, device gpu4
[2024-07-11 11:09:12] [memory] Reserving 236 MB, device gpu5
[2024-07-11 11:09:12] [memory] Reserving 236 MB, device gpu6
[2024-07-11 11:09:12] [memory] Reserving 236 MB, device gpu7
[2024-07-11 11:09:13] [memory] Reserving 945 MB, device gpu0
[2024-07-11 11:09:13] [memory] Reserving 945 MB, device gpu1
[2024-07-11 11:09:13] [memory] Reserving 945 MB, device gpu2
[2024-07-11 11:09:13] [memory] Reserving 945 MB, device gpu3
[2024-07-11 11:09:14] [memory] Reserving 945 MB, device gpu4
[2024-07-11 11:09:14] [memory] Reserving 945 MB, device gpu5
[2024-07-11 11:09:14] [memory] Reserving 945 MB, device gpu6
[2024-07-11 11:09:14] [memory] Reserving 945 MB, device gpu7
[2024-07-11 11:09:15] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-11 11:09:15] [data] Restoring the corpus state to epoch 1, batch 530000
[2024-07-11 20:27:52] Training started
[2024-07-11 20:27:52] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-11 20:28:00] [memory] Reserving 945 MB, device gpu0
[2024-07-11 20:28:18] [memory] Reserving 945 MB, device gpu4
[2024-07-11 20:28:18] [memory] Reserving 945 MB, device gpu3
[2024-07-11 20:28:18] [memory] Reserving 945 MB, device gpu5
[2024-07-11 20:28:18] [memory] Reserving 945 MB, device gpu7
[2024-07-11 20:28:18] [memory] Reserving 945 MB, device gpu6
[2024-07-11 20:28:18] [memory] Reserving 945 MB, device gpu2
[2024-07-11 20:28:18] [memory] Reserving 945 MB, device gpu1
[2024-07-11 20:28:22] Parameter type float32, optimization type float32, casting types false
[2024-07-12 04:30:20] Ep. 1 : Up. 540000 : Sen. 4,148,225,080 : Cost 3.11956167 : Time 62497.89s : 43245.82 words/s : gNorm 0.9918
[2024-07-12 04:30:20] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-12 04:30:25] Saving Adam parameters
[2024-07-12 04:30:32] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-12 04:30:46] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-12 04:30:49] [valid] Ep. 1 : Up. 540000 : perplexity : 11.6559 : new best
[2024-07-12 12:33:29] Ep. 1 : Up. 550000 : Sen. 4,225,081,797 : Cost 3.11924505 : Time 28989.20s : 93336.20 words/s : gNorm 1.4451
[2024-07-12 12:33:29] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-12 12:33:34] Saving Adam parameters
[2024-07-12 12:33:42] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-12 12:33:55] [valid] Ep. 1 : Up. 550000 : perplexity : 11.6743 : stalled 1 times (last best: 11.6559)
[2024-07-12 20:36:16] Ep. 1 : Up. 560000 : Sen. 4,301,868,134 : Cost 3.11960006 : Time 28966.60s : 93343.55 words/s : gNorm 1.1627
[2024-07-12 20:36:16] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-12 20:36:20] Saving Adam parameters
[2024-07-12 20:36:28] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-12 20:36:42] [valid] Ep. 1 : Up. 560000 : perplexity : 11.6626 : stalled 2 times (last best: 11.6559)
[2024-07-13 04:39:06] Ep. 1 : Up. 570000 : Sen. 4,378,706,537 : Cost 3.11799955 : Time 28970.44s : 93395.34 words/s : gNorm 1.3340
[2024-07-13 04:39:06] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-13 04:39:11] Saving Adam parameters
[2024-07-13 04:39:19] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-13 04:39:32] [valid] Ep. 1 : Up. 570000 : perplexity : 11.6714 : stalled 3 times (last best: 11.6559)
[2024-07-13 12:42:11] Ep. 1 : Up. 580000 : Sen. 4,455,491,704 : Cost 3.11736488 : Time 28984.60s : 93310.93 words/s : gNorm 1.2745
[2024-07-13 12:42:11] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-13 12:42:16] Saving Adam parameters
[2024-07-13 12:42:23] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-13 12:42:37] [valid] Ep. 1 : Up. 580000 : perplexity : 11.6829 : stalled 4 times (last best: 11.6559)
[2024-07-13 20:44:35] Ep. 1 : Up. 590000 : Sen. 4,532,249,791 : Cost 3.11710525 : Time 28943.69s : 93383.47 words/s : gNorm 1.1339
[2024-07-13 20:44:35] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-13 20:44:39] Saving Adam parameters
[2024-07-13 20:44:47] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-13 20:45:01] [valid] Ep. 1 : Up. 590000 : perplexity : 11.6681 : stalled 5 times (last best: 11.6559)
[2024-07-14 04:46:28] Ep. 1 : Up. 600000 : Sen. 4,609,078,225 : Cost 3.11743164 : Time 28913.13s : 93547.17 words/s : gNorm 1.6145
[2024-07-14 04:46:28] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-14 04:46:33] Saving Adam parameters
[2024-07-14 04:46:40] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-14 04:46:54] [valid] Ep. 1 : Up. 600000 : perplexity : 11.6748 : stalled 6 times (last best: 11.6559)
[2024-07-14 11:09:23] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-14 11:09:23] [marian] Running on nid005068 as process 7470 with command line:
[2024-07-14 11:09:23] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-14 11:09:25] [config] after: 0e
[2024-07-14 11:09:25] [config] after-batches: 0
[2024-07-14 11:09:25] [config] after-epochs: 0
[2024-07-14 11:09:25] [config] all-caps-every: 0
[2024-07-14 11:09:25] [config] allow-unk: true
[2024-07-14 11:09:25] [config] authors: false
[2024-07-14 11:09:25] [config] beam-size: 6
[2024-07-14 11:09:25] [config] bert-class-symbol: "[CLS]"
[2024-07-14 11:09:25] [config] bert-mask-symbol: "[MASK]"
[2024-07-14 11:09:25] [config] bert-masking-fraction: 0.15
[2024-07-14 11:09:25] [config] bert-sep-symbol: "[SEP]"
[2024-07-14 11:09:25] [config] bert-train-type-embeddings: true
[2024-07-14 11:09:25] [config] bert-type-vocab-size: 2
[2024-07-14 11:09:25] [config] build-info: ""
[2024-07-14 11:09:25] [config] char-conv-filters-num:
[2024-07-14 11:09:25] [config]   - 200
[2024-07-14 11:09:25] [config]   - 200
[2024-07-14 11:09:25] [config]   - 250
[2024-07-14 11:09:25] [config]   - 250
[2024-07-14 11:09:25] [config]   - 300
[2024-07-14 11:09:25] [config]   - 300
[2024-07-14 11:09:25] [config]   - 300
[2024-07-14 11:09:25] [config]   - 300
[2024-07-14 11:09:25] [config] char-conv-filters-widths:
[2024-07-14 11:09:25] [config]   - 1
[2024-07-14 11:09:25] [config]   - 2
[2024-07-14 11:09:25] [config]   - 3
[2024-07-14 11:09:25] [config]   - 4
[2024-07-14 11:09:25] [config]   - 5
[2024-07-14 11:09:25] [config]   - 6
[2024-07-14 11:09:25] [config]   - 7
[2024-07-14 11:09:25] [config]   - 8
[2024-07-14 11:09:25] [config] char-highway: 4
[2024-07-14 11:09:25] [config] char-stride: 5
[2024-07-14 11:09:25] [config] check-gradient-nan: false
[2024-07-14 11:09:25] [config] check-nan: false
[2024-07-14 11:09:25] [config] cite: false
[2024-07-14 11:09:25] [config] clip-norm: 0
[2024-07-14 11:09:25] [config] cost-scaling:
[2024-07-14 11:09:25] [config]   []
[2024-07-14 11:09:25] [config] cost-type: ce-mean-words
[2024-07-14 11:09:25] [config] cpu-threads: 0
[2024-07-14 11:09:25] [config] data-threads: 8
[2024-07-14 11:09:25] [config] data-weighting: ""
[2024-07-14 11:09:25] [config] data-weighting-type: sentence
[2024-07-14 11:09:25] [config] dec-cell: gru
[2024-07-14 11:09:25] [config] dec-cell-base-depth: 2
[2024-07-14 11:09:25] [config] dec-cell-high-depth: 1
[2024-07-14 11:09:25] [config] dec-depth: 6
[2024-07-14 11:09:25] [config] devices:
[2024-07-14 11:09:25] [config]   - 0
[2024-07-14 11:09:25] [config]   - 1
[2024-07-14 11:09:25] [config]   - 2
[2024-07-14 11:09:25] [config]   - 3
[2024-07-14 11:09:25] [config]   - 4
[2024-07-14 11:09:25] [config]   - 5
[2024-07-14 11:09:25] [config]   - 6
[2024-07-14 11:09:25] [config]   - 7
[2024-07-14 11:09:25] [config] dim-emb: 1024
[2024-07-14 11:09:25] [config] dim-rnn: 1024
[2024-07-14 11:09:25] [config] dim-vocabs:
[2024-07-14 11:09:25] [config]   - 69666
[2024-07-14 11:09:25] [config]   - 69666
[2024-07-14 11:09:25] [config] disp-first: 10
[2024-07-14 11:09:25] [config] disp-freq: 10000
[2024-07-14 11:09:25] [config] disp-label-counts: true
[2024-07-14 11:09:25] [config] dropout-rnn: 0
[2024-07-14 11:09:25] [config] dropout-src: 0
[2024-07-14 11:09:25] [config] dropout-trg: 0
[2024-07-14 11:09:25] [config] dump-config: ""
[2024-07-14 11:09:25] [config] dynamic-gradient-scaling:
[2024-07-14 11:09:25] [config]   []
[2024-07-14 11:09:25] [config] early-stopping: 20
[2024-07-14 11:09:25] [config] early-stopping-on: first
[2024-07-14 11:09:25] [config] embedding-fix-src: false
[2024-07-14 11:09:25] [config] embedding-fix-trg: false
[2024-07-14 11:09:25] [config] embedding-normalization: false
[2024-07-14 11:09:25] [config] embedding-vectors:
[2024-07-14 11:09:25] [config]   []
[2024-07-14 11:09:25] [config] enc-cell: gru
[2024-07-14 11:09:25] [config] enc-cell-depth: 1
[2024-07-14 11:09:25] [config] enc-depth: 6
[2024-07-14 11:09:25] [config] enc-type: bidirectional
[2024-07-14 11:09:25] [config] english-title-case-every: 0
[2024-07-14 11:09:25] [config] exponential-smoothing: 0.0001
[2024-07-14 11:09:25] [config] factor-weight: 1
[2024-07-14 11:09:25] [config] factors-combine: sum
[2024-07-14 11:09:25] [config] factors-dim-emb: 0
[2024-07-14 11:09:25] [config] gradient-checkpointing: false
[2024-07-14 11:09:25] [config] gradient-norm-average-window: 100
[2024-07-14 11:09:25] [config] guided-alignment: none
[2024-07-14 11:09:25] [config] guided-alignment-cost: ce
[2024-07-14 11:09:25] [config] guided-alignment-weight: 0.1
[2024-07-14 11:09:25] [config] ignore-model-config: false
[2024-07-14 11:09:25] [config] input-types:
[2024-07-14 11:09:25] [config]   []
[2024-07-14 11:09:25] [config] interpolate-env-vars: false
[2024-07-14 11:09:25] [config] keep-best: true
[2024-07-14 11:09:25] [config] label-smoothing: 0.1
[2024-07-14 11:09:25] [config] layer-normalization: false
[2024-07-14 11:09:25] [config] learn-rate: 0.0002
[2024-07-14 11:09:25] [config] lemma-dependency: ""
[2024-07-14 11:09:25] [config] lemma-dim-emb: 0
[2024-07-14 11:09:25] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-14 11:09:25] [config] log-level: info
[2024-07-14 11:09:25] [config] log-time-zone: ""
[2024-07-14 11:09:25] [config] logical-epoch:
[2024-07-14 11:09:25] [config]   - 1e
[2024-07-14 11:09:25] [config]   - 0
[2024-07-14 11:09:25] [config] lr-decay: 0
[2024-07-14 11:09:25] [config] lr-decay-freq: 50000
[2024-07-14 11:09:25] [config] lr-decay-inv-sqrt:
[2024-07-14 11:09:25] [config]   - 8000
[2024-07-14 11:09:25] [config] lr-decay-repeat-warmup: false
[2024-07-14 11:09:25] [config] lr-decay-reset-optimizer: false
[2024-07-14 11:09:25] [config] lr-decay-start:
[2024-07-14 11:09:25] [config]   - 10
[2024-07-14 11:09:25] [config]   - 1
[2024-07-14 11:09:25] [config] lr-decay-strategy: epoch+stalled
[2024-07-14 11:09:25] [config] lr-report: false
[2024-07-14 11:09:25] [config] lr-warmup: 8000
[2024-07-14 11:09:25] [config] lr-warmup-at-reload: false
[2024-07-14 11:09:25] [config] lr-warmup-cycle: true
[2024-07-14 11:09:25] [config] lr-warmup-start-rate: 0
[2024-07-14 11:09:25] [config] max-length: 100
[2024-07-14 11:09:25] [config] max-length-crop: false
[2024-07-14 11:09:25] [config] max-length-factor: 3
[2024-07-14 11:09:25] [config] maxi-batch: 1000
[2024-07-14 11:09:25] [config] maxi-batch-sort: trg
[2024-07-14 11:09:25] [config] mini-batch: 1000
[2024-07-14 11:09:25] [config] mini-batch-fit: true
[2024-07-14 11:09:25] [config] mini-batch-fit-step: 10
[2024-07-14 11:09:25] [config] mini-batch-round-up: true
[2024-07-14 11:09:25] [config] mini-batch-track-lr: false
[2024-07-14 11:09:25] [config] mini-batch-warmup: 0
[2024-07-14 11:09:25] [config] mini-batch-words: 0
[2024-07-14 11:09:25] [config] mini-batch-words-ref: 0
[2024-07-14 11:09:25] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-14 11:09:25] [config] multi-loss-type: sum
[2024-07-14 11:09:25] [config] n-best: false
[2024-07-14 11:09:25] [config] no-nccl: false
[2024-07-14 11:09:25] [config] no-reload: false
[2024-07-14 11:09:25] [config] no-restore-corpus: false
[2024-07-14 11:09:25] [config] normalize: 1
[2024-07-14 11:09:25] [config] normalize-gradient: false
[2024-07-14 11:09:25] [config] num-devices: 0
[2024-07-14 11:09:25] [config] optimizer: adam
[2024-07-14 11:09:25] [config] optimizer-delay: 10
[2024-07-14 11:09:25] [config] optimizer-params:
[2024-07-14 11:09:25] [config]   - 0.9
[2024-07-14 11:09:25] [config]   - 0.998
[2024-07-14 11:09:25] [config]   - 1e-09
[2024-07-14 11:09:25] [config] output-omit-bias: false
[2024-07-14 11:09:25] [config] overwrite: true
[2024-07-14 11:09:25] [config] precision:
[2024-07-14 11:09:25] [config]   - float32
[2024-07-14 11:09:25] [config]   - float32
[2024-07-14 11:09:25] [config] pretrained-model: ""
[2024-07-14 11:09:25] [config] quantize-biases: false
[2024-07-14 11:09:25] [config] quantize-bits: 0
[2024-07-14 11:09:25] [config] quantize-log-based: false
[2024-07-14 11:09:25] [config] quantize-optimization-steps: 0
[2024-07-14 11:09:25] [config] quiet: false
[2024-07-14 11:09:25] [config] quiet-translation: false
[2024-07-14 11:09:25] [config] relative-paths: false
[2024-07-14 11:09:25] [config] right-left: false
[2024-07-14 11:09:25] [config] save-freq: 10000
[2024-07-14 11:09:25] [config] seed: 2222
[2024-07-14 11:09:25] [config] sentencepiece-alphas:
[2024-07-14 11:09:25] [config]   []
[2024-07-14 11:09:25] [config] sentencepiece-max-lines: 2000000
[2024-07-14 11:09:25] [config] sentencepiece-options: ""
[2024-07-14 11:09:25] [config] sharding: local
[2024-07-14 11:09:25] [config] shuffle: batches
[2024-07-14 11:09:25] [config] shuffle-in-ram: false
[2024-07-14 11:09:25] [config] sigterm: save-and-exit
[2024-07-14 11:09:25] [config] skip: false
[2024-07-14 11:09:25] [config] sqlite: ""
[2024-07-14 11:09:25] [config] sqlite-drop: false
[2024-07-14 11:09:25] [config] sync-freq: 200u
[2024-07-14 11:09:25] [config] sync-sgd: true
[2024-07-14 11:09:25] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-14 11:09:25] [config] tied-embeddings: false
[2024-07-14 11:09:25] [config] tied-embeddings-all: true
[2024-07-14 11:09:25] [config] tied-embeddings-src: false
[2024-07-14 11:09:25] [config] train-embedder-rank:
[2024-07-14 11:09:25] [config]   []
[2024-07-14 11:09:25] [config] train-sets:
[2024-07-14 11:09:25] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-14 11:09:25] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-14 11:09:25] [config] transformer-aan-activation: swish
[2024-07-14 11:09:25] [config] transformer-aan-depth: 2
[2024-07-14 11:09:25] [config] transformer-aan-nogate: false
[2024-07-14 11:09:25] [config] transformer-decoder-autoreg: self-attention
[2024-07-14 11:09:25] [config] transformer-decoder-dim-ffn: 0
[2024-07-14 11:09:25] [config] transformer-decoder-ffn-depth: 0
[2024-07-14 11:09:25] [config] transformer-depth-scaling: false
[2024-07-14 11:09:25] [config] transformer-dim-aan: 2048
[2024-07-14 11:09:25] [config] transformer-dim-ffn: 4096
[2024-07-14 11:09:25] [config] transformer-dropout: 0.1
[2024-07-14 11:09:25] [config] transformer-dropout-attention: 0
[2024-07-14 11:09:25] [config] transformer-dropout-ffn: 0
[2024-07-14 11:09:25] [config] transformer-ffn-activation: relu
[2024-07-14 11:09:25] [config] transformer-ffn-depth: 2
[2024-07-14 11:09:25] [config] transformer-guided-alignment-layer: last
[2024-07-14 11:09:25] [config] transformer-heads: 16
[2024-07-14 11:09:25] [config] transformer-no-projection: false
[2024-07-14 11:09:25] [config] transformer-pool: false
[2024-07-14 11:09:25] [config] transformer-postprocess: dan
[2024-07-14 11:09:25] [config] transformer-postprocess-emb: d
[2024-07-14 11:09:25] [config] transformer-postprocess-top: ""
[2024-07-14 11:09:25] [config] transformer-preprocess: ""
[2024-07-14 11:09:25] [config] transformer-rnn-projection: false
[2024-07-14 11:09:25] [config] transformer-tied-layers:
[2024-07-14 11:09:25] [config]   []
[2024-07-14 11:09:25] [config] transformer-train-position-embeddings: false
[2024-07-14 11:09:25] [config] tsv: false
[2024-07-14 11:09:25] [config] tsv-fields: 0
[2024-07-14 11:09:25] [config] type: transformer
[2024-07-14 11:09:25] [config] ulr: false
[2024-07-14 11:09:25] [config] ulr-dim-emb: 0
[2024-07-14 11:09:25] [config] ulr-dropout: 0
[2024-07-14 11:09:25] [config] ulr-keys-vectors: ""
[2024-07-14 11:09:25] [config] ulr-query-vectors: ""
[2024-07-14 11:09:25] [config] ulr-softmax-temperature: 1
[2024-07-14 11:09:25] [config] ulr-trainable-transformation: false
[2024-07-14 11:09:25] [config] unlikelihood-loss: false
[2024-07-14 11:09:25] [config] valid-freq: 10000
[2024-07-14 11:09:25] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-14 11:09:25] [config] valid-max-length: 100
[2024-07-14 11:09:25] [config] valid-metrics:
[2024-07-14 11:09:25] [config]   - perplexity
[2024-07-14 11:09:25] [config] valid-mini-batch: 16
[2024-07-14 11:09:25] [config] valid-reset-stalled: false
[2024-07-14 11:09:25] [config] valid-script-args:
[2024-07-14 11:09:25] [config]   []
[2024-07-14 11:09:25] [config] valid-script-path: ""
[2024-07-14 11:09:25] [config] valid-sets:
[2024-07-14 11:09:25] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-14 11:09:25] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-14 11:09:25] [config] valid-translation-output: ""
[2024-07-14 11:09:25] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-14 11:09:25] [config] vocabs:
[2024-07-14 11:09:25] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-14 11:09:25] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-14 11:09:25] [config] word-penalty: 0
[2024-07-14 11:09:25] [config] word-scores: false
[2024-07-14 11:09:25] [config] workspace: 20000
[2024-07-14 11:09:25] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-14 11:09:25] Using synchronous SGD
[2024-07-14 11:09:25] [comm] Compiled without MPI support. Running as a single process on nid005068
[2024-07-14 11:09:25] Synced seed 2222
[2024-07-14 11:09:25] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-14 11:09:25] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-14 11:09:25] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-14 11:09:25] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-14 11:09:26] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-14 11:09:27] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-14 11:09:27] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-14 11:09:27] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-14 11:09:27] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-14 11:09:27] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-14 11:09:27] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-14 11:09:27] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-14 11:09:27] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-14 11:09:27] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-14 11:09:29] [comm] Using global sharding
[2024-07-14 11:09:30] [comm] NCCLCommunicators constructed successfully
[2024-07-14 11:09:30] [training] Using 8 GPUs
[2024-07-14 11:09:30] [logits] Applying loss function for 1 factor(s)
[2024-07-14 11:09:30] [memory] Reserving 945 MB, device gpu0
[2024-07-14 11:09:35] [memory] Reserving 945 MB, device gpu0
[2024-07-14 11:10:09] [batching] Done. Typical MB size is 699,120 target words
[2024-07-14 11:10:10] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-14 11:10:10] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-14 11:10:10] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-14 11:10:10] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-14 11:10:10] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-14 11:10:10] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-14 11:10:10] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-14 11:10:10] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-14 11:10:10] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-14 11:10:10] [comm] Using global sharding
[2024-07-14 11:10:10] [comm] NCCLCommunicators constructed successfully
[2024-07-14 11:10:10] [training] Using 8 GPUs
[2024-07-14 11:10:10] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-14 11:10:28] Allocating memory for general optimizer shards
[2024-07-14 11:10:28] [memory] Reserving 118 MB, device gpu0
[2024-07-14 11:10:28] [memory] Reserving 118 MB, device gpu1
[2024-07-14 11:10:28] [memory] Reserving 118 MB, device gpu2
[2024-07-14 11:10:28] [memory] Reserving 118 MB, device gpu3
[2024-07-14 11:10:28] [memory] Reserving 118 MB, device gpu4
[2024-07-14 11:10:28] [memory] Reserving 118 MB, device gpu5
[2024-07-14 11:10:29] [memory] Reserving 118 MB, device gpu6
[2024-07-14 11:10:29] [memory] Reserving 118 MB, device gpu7
[2024-07-14 11:10:29] Loading Adam parameters
[2024-07-14 11:10:30] [memory] Reserving 236 MB, device gpu0
[2024-07-14 11:10:31] [memory] Reserving 236 MB, device gpu1
[2024-07-14 11:10:31] [memory] Reserving 236 MB, device gpu2
[2024-07-14 11:10:31] [memory] Reserving 236 MB, device gpu3
[2024-07-14 11:10:31] [memory] Reserving 236 MB, device gpu4
[2024-07-14 11:10:31] [memory] Reserving 236 MB, device gpu5
[2024-07-14 11:10:32] [memory] Reserving 236 MB, device gpu6
[2024-07-14 11:10:32] [memory] Reserving 236 MB, device gpu7
[2024-07-14 11:10:32] [memory] Reserving 945 MB, device gpu0
[2024-07-14 11:10:32] [memory] Reserving 945 MB, device gpu1
[2024-07-14 11:10:33] [memory] Reserving 945 MB, device gpu2
[2024-07-14 11:10:33] [memory] Reserving 945 MB, device gpu3
[2024-07-14 11:10:33] [memory] Reserving 945 MB, device gpu4
[2024-07-14 11:10:34] [memory] Reserving 945 MB, device gpu5
[2024-07-14 11:10:34] [memory] Reserving 945 MB, device gpu6
[2024-07-14 11:10:34] [memory] Reserving 945 MB, device gpu7
[2024-07-14 11:10:35] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-14 11:10:35] [data] Restoring the corpus state to epoch 1, batch 600000
[2024-07-14 21:34:38] Training started
[2024-07-14 21:34:39] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-14 21:34:53] [memory] Reserving 945 MB, device gpu0
[2024-07-14 21:35:03] [memory] Reserving 945 MB, device gpu6
[2024-07-14 21:35:03] [memory] Reserving 945 MB, device gpu1
[2024-07-14 21:35:03] [memory] Reserving 945 MB, device gpu7
[2024-07-14 21:35:03] [memory] Reserving 945 MB, device gpu2
[2024-07-14 21:35:03] [memory] Reserving 945 MB, device gpu3
[2024-07-14 21:35:03] [memory] Reserving 945 MB, device gpu4
[2024-07-14 21:35:03] [memory] Reserving 945 MB, device gpu5
[2024-07-14 21:35:08] Parameter type float32, optimization type float32, casting types false
[2024-07-15 05:37:01] Ep. 1 : Up. 610000 : Sen. 4,685,840,157 : Cost 3.11583686 : Time 66410.89s : 40722.27 words/s : gNorm 1.4934
[2024-07-15 05:37:01] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-15 05:37:05] Saving Adam parameters
[2024-07-15 05:37:13] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-15 05:37:27] [valid] Ep. 1 : Up. 610000 : perplexity : 11.6562 : stalled 6 times (last best: 11.6559)
[2024-07-15 13:39:08] Ep. 1 : Up. 620000 : Sen. 4,762,598,304 : Cost 3.11497569 : Time 28926.88s : 93413.68 words/s : gNorm 1.9964
[2024-07-15 13:39:08] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-15 13:39:12] Saving Adam parameters
[2024-07-15 13:39:20] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-15 13:39:34] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-15 13:39:36] [valid] Ep. 1 : Up. 620000 : perplexity : 11.642 : new best
[2024-07-15 21:42:04] Ep. 1 : Up. 630000 : Sen. 4,839,427,555 : Cost 3.11510444 : Time 28976.09s : 93365.24 words/s : gNorm 1.6159
[2024-07-15 21:42:04] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-15 21:42:08] Saving Adam parameters
[2024-07-15 21:42:16] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-15 21:42:30] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-15 21:42:33] [valid] Ep. 1 : Up. 630000 : perplexity : 11.629 : new best
[2024-07-16 05:44:57] Ep. 1 : Up. 640000 : Sen. 4,916,278,586 : Cost 3.11548877 : Time 28973.29s : 93415.30 words/s : gNorm 1.2950
[2024-07-16 05:44:57] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-16 05:45:02] Saving Adam parameters
[2024-07-16 05:45:10] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-16 05:45:24] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-16 05:45:26] [valid] Ep. 1 : Up. 640000 : perplexity : 11.6192 : new best
[2024-07-16 13:47:06] Ep. 1 : Up. 650000 : Sen. 4,993,083,161 : Cost 3.11404610 : Time 28928.54s : 93430.31 words/s : gNorm 1.2895
[2024-07-16 13:47:06] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-16 13:47:11] Saving Adam parameters
[2024-07-16 13:47:19] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-16 13:47:32] [valid] Ep. 1 : Up. 650000 : perplexity : 11.6193 : stalled 1 times (last best: 11.6192)
[2024-07-16 21:49:26] Ep. 1 : Up. 660000 : Sen. 5,069,906,949 : Cost 3.11307716 : Time 28940.73s : 93521.05 words/s : gNorm 1.1463
[2024-07-16 21:49:27] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-16 21:49:31] Saving Adam parameters
[2024-07-16 21:49:39] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-16 21:49:53] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-16 21:49:56] [valid] Ep. 1 : Up. 660000 : perplexity : 11.6159 : new best
[2024-07-17 05:52:26] Ep. 1 : Up. 670000 : Sen. 5,146,747,804 : Cost 3.11332440 : Time 28979.89s : 93346.09 words/s : gNorm 1.2294
[2024-07-17 05:52:27] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-17 05:52:31] Saving Adam parameters
[2024-07-17 05:52:39] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-17 05:52:53] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-17 05:52:56] [valid] Ep. 1 : Up. 670000 : perplexity : 11.6124 : new best
[2024-07-18 16:08:20] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-18 16:08:20] [marian] Running on nid007881 as process 11733 with command line:
[2024-07-18 16:08:20] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-18 16:08:21] [config] after: 0e
[2024-07-18 16:08:21] [config] after-batches: 0
[2024-07-18 16:08:21] [config] after-epochs: 0
[2024-07-18 16:08:21] [config] all-caps-every: 0
[2024-07-18 16:08:21] [config] allow-unk: true
[2024-07-18 16:08:21] [config] authors: false
[2024-07-18 16:08:21] [config] beam-size: 6
[2024-07-18 16:08:21] [config] bert-class-symbol: "[CLS]"
[2024-07-18 16:08:21] [config] bert-mask-symbol: "[MASK]"
[2024-07-18 16:08:21] [config] bert-masking-fraction: 0.15
[2024-07-18 16:08:21] [config] bert-sep-symbol: "[SEP]"
[2024-07-18 16:08:21] [config] bert-train-type-embeddings: true
[2024-07-18 16:08:21] [config] bert-type-vocab-size: 2
[2024-07-18 16:08:21] [config] build-info: ""
[2024-07-18 16:08:21] [config] char-conv-filters-num:
[2024-07-18 16:08:21] [config]   - 200
[2024-07-18 16:08:21] [config]   - 200
[2024-07-18 16:08:21] [config]   - 250
[2024-07-18 16:08:21] [config]   - 250
[2024-07-18 16:08:21] [config]   - 300
[2024-07-18 16:08:21] [config]   - 300
[2024-07-18 16:08:21] [config]   - 300
[2024-07-18 16:08:21] [config]   - 300
[2024-07-18 16:08:21] [config] char-conv-filters-widths:
[2024-07-18 16:08:21] [config]   - 1
[2024-07-18 16:08:21] [config]   - 2
[2024-07-18 16:08:21] [config]   - 3
[2024-07-18 16:08:21] [config]   - 4
[2024-07-18 16:08:21] [config]   - 5
[2024-07-18 16:08:21] [config]   - 6
[2024-07-18 16:08:21] [config]   - 7
[2024-07-18 16:08:21] [config]   - 8
[2024-07-18 16:08:21] [config] char-highway: 4
[2024-07-18 16:08:21] [config] char-stride: 5
[2024-07-18 16:08:21] [config] check-gradient-nan: false
[2024-07-18 16:08:21] [config] check-nan: false
[2024-07-18 16:08:21] [config] cite: false
[2024-07-18 16:08:21] [config] clip-norm: 0
[2024-07-18 16:08:21] [config] cost-scaling:
[2024-07-18 16:08:21] [config]   []
[2024-07-18 16:08:21] [config] cost-type: ce-mean-words
[2024-07-18 16:08:21] [config] cpu-threads: 0
[2024-07-18 16:08:21] [config] data-threads: 8
[2024-07-18 16:08:21] [config] data-weighting: ""
[2024-07-18 16:08:21] [config] data-weighting-type: sentence
[2024-07-18 16:08:21] [config] dec-cell: gru
[2024-07-18 16:08:21] [config] dec-cell-base-depth: 2
[2024-07-18 16:08:21] [config] dec-cell-high-depth: 1
[2024-07-18 16:08:21] [config] dec-depth: 6
[2024-07-18 16:08:21] [config] devices:
[2024-07-18 16:08:21] [config]   - 0
[2024-07-18 16:08:21] [config]   - 1
[2024-07-18 16:08:21] [config]   - 2
[2024-07-18 16:08:21] [config]   - 3
[2024-07-18 16:08:21] [config]   - 4
[2024-07-18 16:08:21] [config]   - 5
[2024-07-18 16:08:21] [config]   - 6
[2024-07-18 16:08:21] [config]   - 7
[2024-07-18 16:08:21] [config] dim-emb: 1024
[2024-07-18 16:08:21] [config] dim-rnn: 1024
[2024-07-18 16:08:21] [config] dim-vocabs:
[2024-07-18 16:08:21] [config]   - 69666
[2024-07-18 16:08:21] [config]   - 69666
[2024-07-18 16:08:21] [config] disp-first: 10
[2024-07-18 16:08:21] [config] disp-freq: 10000
[2024-07-18 16:08:21] [config] disp-label-counts: true
[2024-07-18 16:08:21] [config] dropout-rnn: 0
[2024-07-18 16:08:21] [config] dropout-src: 0
[2024-07-18 16:08:21] [config] dropout-trg: 0
[2024-07-18 16:08:21] [config] dump-config: ""
[2024-07-18 16:08:21] [config] dynamic-gradient-scaling:
[2024-07-18 16:08:21] [config]   []
[2024-07-18 16:08:21] [config] early-stopping: 20
[2024-07-18 16:08:21] [config] early-stopping-on: first
[2024-07-18 16:08:21] [config] embedding-fix-src: false
[2024-07-18 16:08:21] [config] embedding-fix-trg: false
[2024-07-18 16:08:21] [config] embedding-normalization: false
[2024-07-18 16:08:21] [config] embedding-vectors:
[2024-07-18 16:08:21] [config]   []
[2024-07-18 16:08:21] [config] enc-cell: gru
[2024-07-18 16:08:21] [config] enc-cell-depth: 1
[2024-07-18 16:08:21] [config] enc-depth: 6
[2024-07-18 16:08:21] [config] enc-type: bidirectional
[2024-07-18 16:08:21] [config] english-title-case-every: 0
[2024-07-18 16:08:21] [config] exponential-smoothing: 0.0001
[2024-07-18 16:08:21] [config] factor-weight: 1
[2024-07-18 16:08:21] [config] factors-combine: sum
[2024-07-18 16:08:21] [config] factors-dim-emb: 0
[2024-07-18 16:08:21] [config] gradient-checkpointing: false
[2024-07-18 16:08:21] [config] gradient-norm-average-window: 100
[2024-07-18 16:08:21] [config] guided-alignment: none
[2024-07-18 16:08:21] [config] guided-alignment-cost: ce
[2024-07-18 16:08:21] [config] guided-alignment-weight: 0.1
[2024-07-18 16:08:21] [config] ignore-model-config: false
[2024-07-18 16:08:21] [config] input-types:
[2024-07-18 16:08:21] [config]   []
[2024-07-18 16:08:21] [config] interpolate-env-vars: false
[2024-07-18 16:08:21] [config] keep-best: true
[2024-07-18 16:08:21] [config] label-smoothing: 0.1
[2024-07-18 16:08:21] [config] layer-normalization: false
[2024-07-18 16:08:21] [config] learn-rate: 0.0002
[2024-07-18 16:08:21] [config] lemma-dependency: ""
[2024-07-18 16:08:21] [config] lemma-dim-emb: 0
[2024-07-18 16:08:21] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-18 16:08:21] [config] log-level: info
[2024-07-18 16:08:21] [config] log-time-zone: ""
[2024-07-18 16:08:21] [config] logical-epoch:
[2024-07-18 16:08:21] [config]   - 1e
[2024-07-18 16:08:21] [config]   - 0
[2024-07-18 16:08:21] [config] lr-decay: 0
[2024-07-18 16:08:21] [config] lr-decay-freq: 50000
[2024-07-18 16:08:21] [config] lr-decay-inv-sqrt:
[2024-07-18 16:08:21] [config]   - 8000
[2024-07-18 16:08:21] [config] lr-decay-repeat-warmup: false
[2024-07-18 16:08:21] [config] lr-decay-reset-optimizer: false
[2024-07-18 16:08:21] [config] lr-decay-start:
[2024-07-18 16:08:21] [config]   - 10
[2024-07-18 16:08:21] [config]   - 1
[2024-07-18 16:08:21] [config] lr-decay-strategy: epoch+stalled
[2024-07-18 16:08:21] [config] lr-report: false
[2024-07-18 16:08:21] [config] lr-warmup: 8000
[2024-07-18 16:08:21] [config] lr-warmup-at-reload: false
[2024-07-18 16:08:21] [config] lr-warmup-cycle: true
[2024-07-18 16:08:21] [config] lr-warmup-start-rate: 0
[2024-07-18 16:08:21] [config] max-length: 100
[2024-07-18 16:08:21] [config] max-length-crop: false
[2024-07-18 16:08:21] [config] max-length-factor: 3
[2024-07-18 16:08:21] [config] maxi-batch: 1000
[2024-07-18 16:08:21] [config] maxi-batch-sort: trg
[2024-07-18 16:08:21] [config] mini-batch: 1000
[2024-07-18 16:08:21] [config] mini-batch-fit: true
[2024-07-18 16:08:21] [config] mini-batch-fit-step: 10
[2024-07-18 16:08:21] [config] mini-batch-round-up: true
[2024-07-18 16:08:21] [config] mini-batch-track-lr: false
[2024-07-18 16:08:21] [config] mini-batch-warmup: 0
[2024-07-18 16:08:21] [config] mini-batch-words: 0
[2024-07-18 16:08:21] [config] mini-batch-words-ref: 0
[2024-07-18 16:08:21] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-18 16:08:21] [config] multi-loss-type: sum
[2024-07-18 16:08:21] [config] n-best: false
[2024-07-18 16:08:21] [config] no-nccl: false
[2024-07-18 16:08:21] [config] no-reload: false
[2024-07-18 16:08:21] [config] no-restore-corpus: false
[2024-07-18 16:08:21] [config] normalize: 1
[2024-07-18 16:08:21] [config] normalize-gradient: false
[2024-07-18 16:08:21] [config] num-devices: 0
[2024-07-18 16:08:21] [config] optimizer: adam
[2024-07-18 16:08:21] [config] optimizer-delay: 10
[2024-07-18 16:08:21] [config] optimizer-params:
[2024-07-18 16:08:21] [config]   - 0.9
[2024-07-18 16:08:21] [config]   - 0.998
[2024-07-18 16:08:21] [config]   - 1e-09
[2024-07-18 16:08:21] [config] output-omit-bias: false
[2024-07-18 16:08:21] [config] overwrite: true
[2024-07-18 16:08:21] [config] precision:
[2024-07-18 16:08:21] [config]   - float32
[2024-07-18 16:08:21] [config]   - float32
[2024-07-18 16:08:21] [config] pretrained-model: ""
[2024-07-18 16:08:21] [config] quantize-biases: false
[2024-07-18 16:08:21] [config] quantize-bits: 0
[2024-07-18 16:08:21] [config] quantize-log-based: false
[2024-07-18 16:08:21] [config] quantize-optimization-steps: 0
[2024-07-18 16:08:21] [config] quiet: false
[2024-07-18 16:08:21] [config] quiet-translation: false
[2024-07-18 16:08:21] [config] relative-paths: false
[2024-07-18 16:08:21] [config] right-left: false
[2024-07-18 16:08:21] [config] save-freq: 10000
[2024-07-18 16:08:21] [config] seed: 2222
[2024-07-18 16:08:21] [config] sentencepiece-alphas:
[2024-07-18 16:08:21] [config]   []
[2024-07-18 16:08:21] [config] sentencepiece-max-lines: 2000000
[2024-07-18 16:08:21] [config] sentencepiece-options: ""
[2024-07-18 16:08:21] [config] sharding: local
[2024-07-18 16:08:21] [config] shuffle: batches
[2024-07-18 16:08:21] [config] shuffle-in-ram: false
[2024-07-18 16:08:21] [config] sigterm: save-and-exit
[2024-07-18 16:08:21] [config] skip: false
[2024-07-18 16:08:21] [config] sqlite: ""
[2024-07-18 16:08:21] [config] sqlite-drop: false
[2024-07-18 16:08:21] [config] sync-freq: 200u
[2024-07-18 16:08:21] [config] sync-sgd: true
[2024-07-18 16:08:21] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-18 16:08:21] [config] tied-embeddings: false
[2024-07-18 16:08:21] [config] tied-embeddings-all: true
[2024-07-18 16:08:21] [config] tied-embeddings-src: false
[2024-07-18 16:08:21] [config] train-embedder-rank:
[2024-07-18 16:08:21] [config]   []
[2024-07-18 16:08:21] [config] train-sets:
[2024-07-18 16:08:21] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-18 16:08:21] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-18 16:08:21] [config] transformer-aan-activation: swish
[2024-07-18 16:08:21] [config] transformer-aan-depth: 2
[2024-07-18 16:08:21] [config] transformer-aan-nogate: false
[2024-07-18 16:08:21] [config] transformer-decoder-autoreg: self-attention
[2024-07-18 16:08:21] [config] transformer-decoder-dim-ffn: 0
[2024-07-18 16:08:21] [config] transformer-decoder-ffn-depth: 0
[2024-07-18 16:08:21] [config] transformer-depth-scaling: false
[2024-07-18 16:08:21] [config] transformer-dim-aan: 2048
[2024-07-18 16:08:21] [config] transformer-dim-ffn: 4096
[2024-07-18 16:08:21] [config] transformer-dropout: 0.1
[2024-07-18 16:08:21] [config] transformer-dropout-attention: 0
[2024-07-18 16:08:21] [config] transformer-dropout-ffn: 0
[2024-07-18 16:08:21] [config] transformer-ffn-activation: relu
[2024-07-18 16:08:21] [config] transformer-ffn-depth: 2
[2024-07-18 16:08:21] [config] transformer-guided-alignment-layer: last
[2024-07-18 16:08:21] [config] transformer-heads: 16
[2024-07-18 16:08:21] [config] transformer-no-projection: false
[2024-07-18 16:08:21] [config] transformer-pool: false
[2024-07-18 16:08:21] [config] transformer-postprocess: dan
[2024-07-18 16:08:21] [config] transformer-postprocess-emb: d
[2024-07-18 16:08:21] [config] transformer-postprocess-top: ""
[2024-07-18 16:08:21] [config] transformer-preprocess: ""
[2024-07-18 16:08:21] [config] transformer-rnn-projection: false
[2024-07-18 16:08:21] [config] transformer-tied-layers:
[2024-07-18 16:08:21] [config]   []
[2024-07-18 16:08:21] [config] transformer-train-position-embeddings: false
[2024-07-18 16:08:21] [config] tsv: false
[2024-07-18 16:08:21] [config] tsv-fields: 0
[2024-07-18 16:08:21] [config] type: transformer
[2024-07-18 16:08:21] [config] ulr: false
[2024-07-18 16:08:21] [config] ulr-dim-emb: 0
[2024-07-18 16:08:21] [config] ulr-dropout: 0
[2024-07-18 16:08:21] [config] ulr-keys-vectors: ""
[2024-07-18 16:08:21] [config] ulr-query-vectors: ""
[2024-07-18 16:08:21] [config] ulr-softmax-temperature: 1
[2024-07-18 16:08:21] [config] ulr-trainable-transformation: false
[2024-07-18 16:08:21] [config] unlikelihood-loss: false
[2024-07-18 16:08:21] [config] valid-freq: 10000
[2024-07-18 16:08:21] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-18 16:08:21] [config] valid-max-length: 100
[2024-07-18 16:08:21] [config] valid-metrics:
[2024-07-18 16:08:21] [config]   - perplexity
[2024-07-18 16:08:21] [config] valid-mini-batch: 16
[2024-07-18 16:08:21] [config] valid-reset-stalled: false
[2024-07-18 16:08:21] [config] valid-script-args:
[2024-07-18 16:08:21] [config]   []
[2024-07-18 16:08:21] [config] valid-script-path: ""
[2024-07-18 16:08:21] [config] valid-sets:
[2024-07-18 16:08:21] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-18 16:08:21] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-18 16:08:21] [config] valid-translation-output: ""
[2024-07-18 16:08:21] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-18 16:08:21] [config] vocabs:
[2024-07-18 16:08:21] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-18 16:08:21] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-18 16:08:21] [config] word-penalty: 0
[2024-07-18 16:08:21] [config] word-scores: false
[2024-07-18 16:08:21] [config] workspace: 20000
[2024-07-18 16:08:21] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-18 16:08:21] Using synchronous SGD
[2024-07-18 16:08:21] [comm] Compiled without MPI support. Running as a single process on nid007881
[2024-07-18 16:08:21] Synced seed 2222
[2024-07-18 16:08:21] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-18 16:08:22] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-18 16:08:22] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-18 16:08:22] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-18 16:08:22] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-18 16:08:23] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-18 16:08:23] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-18 16:08:23] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-18 16:08:23] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-18 16:08:23] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-18 16:08:23] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-18 16:08:23] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-18 16:08:23] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-18 16:08:23] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-18 16:08:27] [comm] Using global sharding
[2024-07-18 16:08:28] [comm] NCCLCommunicators constructed successfully
[2024-07-18 16:08:28] [training] Using 8 GPUs
[2024-07-18 16:08:28] [logits] Applying loss function for 1 factor(s)
[2024-07-18 16:08:28] [memory] Reserving 945 MB, device gpu0
[2024-07-18 16:08:33] [memory] Reserving 945 MB, device gpu0
[2024-07-18 16:09:08] [batching] Done. Typical MB size is 699,120 target words
[2024-07-18 16:09:08] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-18 16:09:08] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-18 16:09:08] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-18 16:09:08] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-18 16:09:08] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-18 16:09:08] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-18 16:09:08] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-18 16:09:08] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-18 16:09:08] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-18 16:09:08] [comm] Using global sharding
[2024-07-18 16:09:09] [comm] NCCLCommunicators constructed successfully
[2024-07-18 16:09:09] [training] Using 8 GPUs
[2024-07-18 16:09:09] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-18 16:09:26] Allocating memory for general optimizer shards
[2024-07-18 16:09:26] [memory] Reserving 118 MB, device gpu0
[2024-07-18 16:09:26] [memory] Reserving 118 MB, device gpu1
[2024-07-18 16:09:26] [memory] Reserving 118 MB, device gpu2
[2024-07-18 16:09:26] [memory] Reserving 118 MB, device gpu3
[2024-07-18 16:09:26] [memory] Reserving 118 MB, device gpu4
[2024-07-18 16:09:26] [memory] Reserving 118 MB, device gpu5
[2024-07-18 16:09:26] [memory] Reserving 118 MB, device gpu6
[2024-07-18 16:09:26] [memory] Reserving 118 MB, device gpu7
[2024-07-18 16:09:26] Loading Adam parameters
[2024-07-18 16:09:28] [memory] Reserving 236 MB, device gpu0
[2024-07-18 16:09:28] [memory] Reserving 236 MB, device gpu1
[2024-07-18 16:09:29] [memory] Reserving 236 MB, device gpu2
[2024-07-18 16:09:29] [memory] Reserving 236 MB, device gpu3
[2024-07-18 16:09:29] [memory] Reserving 236 MB, device gpu4
[2024-07-18 16:09:29] [memory] Reserving 236 MB, device gpu5
[2024-07-18 16:09:29] [memory] Reserving 236 MB, device gpu6
[2024-07-18 16:09:29] [memory] Reserving 236 MB, device gpu7
[2024-07-18 16:09:30] [memory] Reserving 945 MB, device gpu0
[2024-07-18 16:09:30] [memory] Reserving 945 MB, device gpu1
[2024-07-18 16:09:30] [memory] Reserving 945 MB, device gpu2
[2024-07-18 16:09:31] [memory] Reserving 945 MB, device gpu3
[2024-07-18 16:09:31] [memory] Reserving 945 MB, device gpu4
[2024-07-18 16:09:31] [memory] Reserving 945 MB, device gpu5
[2024-07-18 16:09:31] [memory] Reserving 945 MB, device gpu6
[2024-07-18 16:09:31] [memory] Reserving 945 MB, device gpu7
[2024-07-18 16:09:32] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-18 16:09:32] [data] Restoring the corpus state to epoch 1, batch 670000
[2024-07-19 03:57:48] Training started
[2024-07-19 03:57:49] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-19 03:58:03] [memory] Reserving 945 MB, device gpu0
[2024-07-19 03:58:14] [memory] Reserving 945 MB, device gpu1
[2024-07-19 03:58:14] [memory] Reserving 945 MB, device gpu7
[2024-07-19 03:58:14] [memory] Reserving 945 MB, device gpu4
[2024-07-19 03:58:14] [memory] Reserving 945 MB, device gpu2
[2024-07-19 03:58:14] [memory] Reserving 945 MB, device gpu3
[2024-07-19 03:58:14] [memory] Reserving 945 MB, device gpu5
[2024-07-19 03:58:14] [memory] Reserving 945 MB, device gpu6
[2024-07-19 03:58:19] Parameter type float32, optimization type float32, casting types false
[2024-07-19 12:02:03] Ep. 1 : Up. 680000 : Sen. 5,223,573,232 : Cost 3.11351943 : Time 71575.62s : 37775.66 words/s : gNorm 1.7490
[2024-07-19 12:02:03] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-19 12:02:08] Saving Adam parameters
[2024-07-19 12:02:16] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-19 12:02:30] [valid] Ep. 1 : Up. 680000 : perplexity : 11.6169 : stalled 1 times (last best: 11.6159)
[2024-07-19 20:06:39] Ep. 1 : Up. 690000 : Sen. 5,300,475,763 : Cost 3.11233258 : Time 29075.17s : 93075.21 words/s : gNorm 1.2971
[2024-07-19 20:06:39] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-19 20:06:43] Saving Adam parameters
[2024-07-19 20:06:51] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-19 20:07:05] [valid] Ep. 1 : Up. 690000 : perplexity : 11.6211 : stalled 2 times (last best: 11.6159)
[2024-07-20 04:12:04] Ep. 1 : Up. 700000 : Sen. 5,377,329,132 : Cost 3.11122727 : Time 29125.54s : 93018.41 words/s : gNorm 1.4280
[2024-07-20 04:12:04] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-20 04:12:09] Saving Adam parameters
[2024-07-20 04:12:17] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-20 04:12:31] [valid] Ep. 1 : Up. 700000 : perplexity : 11.6166 : stalled 3 times (last best: 11.6159)
[2024-07-20 12:16:43] Ep. 1 : Up. 710000 : Sen. 5,454,171,093 : Cost 3.11129546 : Time 29078.39s : 93051.88 words/s : gNorm 1.2987
[2024-07-20 12:16:43] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-20 12:16:47] Saving Adam parameters
[2024-07-20 12:16:55] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-20 12:17:09] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-20 12:17:12] [valid] Ep. 1 : Up. 710000 : perplexity : 11.6091 : new best
[2024-07-20 20:21:43] Ep. 1 : Up. 720000 : Sen. 5,530,995,759 : Cost 3.11171412 : Time 29100.69s : 93017.55 words/s : gNorm 1.2538
[2024-07-20 20:21:43] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-20 20:21:48] Saving Adam parameters
[2024-07-20 20:21:56] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-20 20:22:10] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-20 20:22:13] [valid] Ep. 1 : Up. 720000 : perplexity : 11.6026 : new best
[2024-07-21 04:25:46] Ep. 1 : Up. 730000 : Sen. 5,607,805,566 : Cost 3.11036849 : Time 29042.42s : 93104.63 words/s : gNorm 0.9358
[2024-07-21 04:25:46] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-21 04:25:51] Saving Adam parameters
[2024-07-21 04:25:58] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-21 04:26:12] [valid] Ep. 1 : Up. 730000 : perplexity : 11.6102 : stalled 1 times (last best: 11.6026)
[2024-07-21 12:30:34] Ep. 1 : Up. 740000 : Sen. 5,684,657,204 : Cost 3.10988736 : Time 29087.72s : 92976.36 words/s : gNorm 1.0398
[2024-07-21 12:30:34] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-21 12:30:38] Saving Adam parameters
[2024-07-21 12:30:46] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-21 12:31:00] [valid] Ep. 1 : Up. 740000 : perplexity : 11.6027 : stalled 2 times (last best: 11.6026)
[2024-07-21 16:10:43] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-21 16:10:43] [marian] Running on nid007871 as process 49962 with command line:
[2024-07-21 16:10:43] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-21 16:10:44] [config] after: 0e
[2024-07-21 16:10:44] [config] after-batches: 0
[2024-07-21 16:10:44] [config] after-epochs: 0
[2024-07-21 16:10:44] [config] all-caps-every: 0
[2024-07-21 16:10:44] [config] allow-unk: true
[2024-07-21 16:10:44] [config] authors: false
[2024-07-21 16:10:44] [config] beam-size: 6
[2024-07-21 16:10:44] [config] bert-class-symbol: "[CLS]"
[2024-07-21 16:10:44] [config] bert-mask-symbol: "[MASK]"
[2024-07-21 16:10:44] [config] bert-masking-fraction: 0.15
[2024-07-21 16:10:44] [config] bert-sep-symbol: "[SEP]"
[2024-07-21 16:10:44] [config] bert-train-type-embeddings: true
[2024-07-21 16:10:44] [config] bert-type-vocab-size: 2
[2024-07-21 16:10:44] [config] build-info: ""
[2024-07-21 16:10:44] [config] char-conv-filters-num:
[2024-07-21 16:10:44] [config]   - 200
[2024-07-21 16:10:44] [config]   - 200
[2024-07-21 16:10:44] [config]   - 250
[2024-07-21 16:10:44] [config]   - 250
[2024-07-21 16:10:44] [config]   - 300
[2024-07-21 16:10:44] [config]   - 300
[2024-07-21 16:10:44] [config]   - 300
[2024-07-21 16:10:44] [config]   - 300
[2024-07-21 16:10:44] [config] char-conv-filters-widths:
[2024-07-21 16:10:44] [config]   - 1
[2024-07-21 16:10:44] [config]   - 2
[2024-07-21 16:10:44] [config]   - 3
[2024-07-21 16:10:44] [config]   - 4
[2024-07-21 16:10:44] [config]   - 5
[2024-07-21 16:10:44] [config]   - 6
[2024-07-21 16:10:44] [config]   - 7
[2024-07-21 16:10:44] [config]   - 8
[2024-07-21 16:10:44] [config] char-highway: 4
[2024-07-21 16:10:44] [config] char-stride: 5
[2024-07-21 16:10:44] [config] check-gradient-nan: false
[2024-07-21 16:10:44] [config] check-nan: false
[2024-07-21 16:10:44] [config] cite: false
[2024-07-21 16:10:44] [config] clip-norm: 0
[2024-07-21 16:10:44] [config] cost-scaling:
[2024-07-21 16:10:44] [config]   []
[2024-07-21 16:10:44] [config] cost-type: ce-mean-words
[2024-07-21 16:10:44] [config] cpu-threads: 0
[2024-07-21 16:10:44] [config] data-threads: 8
[2024-07-21 16:10:44] [config] data-weighting: ""
[2024-07-21 16:10:44] [config] data-weighting-type: sentence
[2024-07-21 16:10:44] [config] dec-cell: gru
[2024-07-21 16:10:44] [config] dec-cell-base-depth: 2
[2024-07-21 16:10:44] [config] dec-cell-high-depth: 1
[2024-07-21 16:10:44] [config] dec-depth: 6
[2024-07-21 16:10:44] [config] devices:
[2024-07-21 16:10:44] [config]   - 0
[2024-07-21 16:10:44] [config]   - 1
[2024-07-21 16:10:44] [config]   - 2
[2024-07-21 16:10:44] [config]   - 3
[2024-07-21 16:10:44] [config]   - 4
[2024-07-21 16:10:44] [config]   - 5
[2024-07-21 16:10:44] [config]   - 6
[2024-07-21 16:10:44] [config]   - 7
[2024-07-21 16:10:44] [config] dim-emb: 1024
[2024-07-21 16:10:44] [config] dim-rnn: 1024
[2024-07-21 16:10:44] [config] dim-vocabs:
[2024-07-21 16:10:44] [config]   - 69666
[2024-07-21 16:10:44] [config]   - 69666
[2024-07-21 16:10:44] [config] disp-first: 10
[2024-07-21 16:10:44] [config] disp-freq: 10000
[2024-07-21 16:10:44] [config] disp-label-counts: true
[2024-07-21 16:10:44] [config] dropout-rnn: 0
[2024-07-21 16:10:44] [config] dropout-src: 0
[2024-07-21 16:10:44] [config] dropout-trg: 0
[2024-07-21 16:10:44] [config] dump-config: ""
[2024-07-21 16:10:44] [config] dynamic-gradient-scaling:
[2024-07-21 16:10:44] [config]   []
[2024-07-21 16:10:44] [config] early-stopping: 20
[2024-07-21 16:10:44] [config] early-stopping-on: first
[2024-07-21 16:10:44] [config] embedding-fix-src: false
[2024-07-21 16:10:44] [config] embedding-fix-trg: false
[2024-07-21 16:10:44] [config] embedding-normalization: false
[2024-07-21 16:10:44] [config] embedding-vectors:
[2024-07-21 16:10:44] [config]   []
[2024-07-21 16:10:44] [config] enc-cell: gru
[2024-07-21 16:10:44] [config] enc-cell-depth: 1
[2024-07-21 16:10:44] [config] enc-depth: 6
[2024-07-21 16:10:44] [config] enc-type: bidirectional
[2024-07-21 16:10:44] [config] english-title-case-every: 0
[2024-07-21 16:10:44] [config] exponential-smoothing: 0.0001
[2024-07-21 16:10:44] [config] factor-weight: 1
[2024-07-21 16:10:44] [config] factors-combine: sum
[2024-07-21 16:10:44] [config] factors-dim-emb: 0
[2024-07-21 16:10:44] [config] gradient-checkpointing: false
[2024-07-21 16:10:44] [config] gradient-norm-average-window: 100
[2024-07-21 16:10:44] [config] guided-alignment: none
[2024-07-21 16:10:44] [config] guided-alignment-cost: ce
[2024-07-21 16:10:44] [config] guided-alignment-weight: 0.1
[2024-07-21 16:10:44] [config] ignore-model-config: false
[2024-07-21 16:10:44] [config] input-types:
[2024-07-21 16:10:44] [config]   []
[2024-07-21 16:10:44] [config] interpolate-env-vars: false
[2024-07-21 16:10:44] [config] keep-best: true
[2024-07-21 16:10:44] [config] label-smoothing: 0.1
[2024-07-21 16:10:44] [config] layer-normalization: false
[2024-07-21 16:10:44] [config] learn-rate: 0.0002
[2024-07-21 16:10:44] [config] lemma-dependency: ""
[2024-07-21 16:10:44] [config] lemma-dim-emb: 0
[2024-07-21 16:10:44] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-21 16:10:44] [config] log-level: info
[2024-07-21 16:10:44] [config] log-time-zone: ""
[2024-07-21 16:10:44] [config] logical-epoch:
[2024-07-21 16:10:44] [config]   - 1e
[2024-07-21 16:10:44] [config]   - 0
[2024-07-21 16:10:44] [config] lr-decay: 0
[2024-07-21 16:10:44] [config] lr-decay-freq: 50000
[2024-07-21 16:10:44] [config] lr-decay-inv-sqrt:
[2024-07-21 16:10:44] [config]   - 8000
[2024-07-21 16:10:44] [config] lr-decay-repeat-warmup: false
[2024-07-21 16:10:44] [config] lr-decay-reset-optimizer: false
[2024-07-21 16:10:44] [config] lr-decay-start:
[2024-07-21 16:10:44] [config]   - 10
[2024-07-21 16:10:44] [config]   - 1
[2024-07-21 16:10:44] [config] lr-decay-strategy: epoch+stalled
[2024-07-21 16:10:44] [config] lr-report: false
[2024-07-21 16:10:44] [config] lr-warmup: 8000
[2024-07-21 16:10:44] [config] lr-warmup-at-reload: false
[2024-07-21 16:10:44] [config] lr-warmup-cycle: true
[2024-07-21 16:10:44] [config] lr-warmup-start-rate: 0
[2024-07-21 16:10:44] [config] max-length: 100
[2024-07-21 16:10:44] [config] max-length-crop: false
[2024-07-21 16:10:44] [config] max-length-factor: 3
[2024-07-21 16:10:44] [config] maxi-batch: 1000
[2024-07-21 16:10:44] [config] maxi-batch-sort: trg
[2024-07-21 16:10:44] [config] mini-batch: 1000
[2024-07-21 16:10:44] [config] mini-batch-fit: true
[2024-07-21 16:10:44] [config] mini-batch-fit-step: 10
[2024-07-21 16:10:44] [config] mini-batch-round-up: true
[2024-07-21 16:10:44] [config] mini-batch-track-lr: false
[2024-07-21 16:10:44] [config] mini-batch-warmup: 0
[2024-07-21 16:10:44] [config] mini-batch-words: 0
[2024-07-21 16:10:44] [config] mini-batch-words-ref: 0
[2024-07-21 16:10:44] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-21 16:10:44] [config] multi-loss-type: sum
[2024-07-21 16:10:44] [config] n-best: false
[2024-07-21 16:10:44] [config] no-nccl: false
[2024-07-21 16:10:44] [config] no-reload: false
[2024-07-21 16:10:44] [config] no-restore-corpus: false
[2024-07-21 16:10:44] [config] normalize: 1
[2024-07-21 16:10:44] [config] normalize-gradient: false
[2024-07-21 16:10:44] [config] num-devices: 0
[2024-07-21 16:10:44] [config] optimizer: adam
[2024-07-21 16:10:44] [config] optimizer-delay: 10
[2024-07-21 16:10:44] [config] optimizer-params:
[2024-07-21 16:10:44] [config]   - 0.9
[2024-07-21 16:10:44] [config]   - 0.998
[2024-07-21 16:10:44] [config]   - 1e-09
[2024-07-21 16:10:44] [config] output-omit-bias: false
[2024-07-21 16:10:44] [config] overwrite: true
[2024-07-21 16:10:44] [config] precision:
[2024-07-21 16:10:44] [config]   - float32
[2024-07-21 16:10:44] [config]   - float32
[2024-07-21 16:10:44] [config] pretrained-model: ""
[2024-07-21 16:10:44] [config] quantize-biases: false
[2024-07-21 16:10:44] [config] quantize-bits: 0
[2024-07-21 16:10:44] [config] quantize-log-based: false
[2024-07-21 16:10:44] [config] quantize-optimization-steps: 0
[2024-07-21 16:10:44] [config] quiet: false
[2024-07-21 16:10:44] [config] quiet-translation: false
[2024-07-21 16:10:44] [config] relative-paths: false
[2024-07-21 16:10:44] [config] right-left: false
[2024-07-21 16:10:44] [config] save-freq: 10000
[2024-07-21 16:10:44] [config] seed: 2222
[2024-07-21 16:10:44] [config] sentencepiece-alphas:
[2024-07-21 16:10:44] [config]   []
[2024-07-21 16:10:44] [config] sentencepiece-max-lines: 2000000
[2024-07-21 16:10:44] [config] sentencepiece-options: ""
[2024-07-21 16:10:44] [config] sharding: local
[2024-07-21 16:10:44] [config] shuffle: batches
[2024-07-21 16:10:44] [config] shuffle-in-ram: false
[2024-07-21 16:10:44] [config] sigterm: save-and-exit
[2024-07-21 16:10:44] [config] skip: false
[2024-07-21 16:10:44] [config] sqlite: ""
[2024-07-21 16:10:44] [config] sqlite-drop: false
[2024-07-21 16:10:44] [config] sync-freq: 200u
[2024-07-21 16:10:44] [config] sync-sgd: true
[2024-07-21 16:10:44] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-21 16:10:44] [config] tied-embeddings: false
[2024-07-21 16:10:44] [config] tied-embeddings-all: true
[2024-07-21 16:10:44] [config] tied-embeddings-src: false
[2024-07-21 16:10:44] [config] train-embedder-rank:
[2024-07-21 16:10:44] [config]   []
[2024-07-21 16:10:44] [config] train-sets:
[2024-07-21 16:10:44] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-21 16:10:44] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-21 16:10:44] [config] transformer-aan-activation: swish
[2024-07-21 16:10:44] [config] transformer-aan-depth: 2
[2024-07-21 16:10:44] [config] transformer-aan-nogate: false
[2024-07-21 16:10:44] [config] transformer-decoder-autoreg: self-attention
[2024-07-21 16:10:44] [config] transformer-decoder-dim-ffn: 0
[2024-07-21 16:10:44] [config] transformer-decoder-ffn-depth: 0
[2024-07-21 16:10:44] [config] transformer-depth-scaling: false
[2024-07-21 16:10:44] [config] transformer-dim-aan: 2048
[2024-07-21 16:10:44] [config] transformer-dim-ffn: 4096
[2024-07-21 16:10:44] [config] transformer-dropout: 0.1
[2024-07-21 16:10:44] [config] transformer-dropout-attention: 0
[2024-07-21 16:10:44] [config] transformer-dropout-ffn: 0
[2024-07-21 16:10:44] [config] transformer-ffn-activation: relu
[2024-07-21 16:10:44] [config] transformer-ffn-depth: 2
[2024-07-21 16:10:44] [config] transformer-guided-alignment-layer: last
[2024-07-21 16:10:44] [config] transformer-heads: 16
[2024-07-21 16:10:44] [config] transformer-no-projection: false
[2024-07-21 16:10:44] [config] transformer-pool: false
[2024-07-21 16:10:44] [config] transformer-postprocess: dan
[2024-07-21 16:10:44] [config] transformer-postprocess-emb: d
[2024-07-21 16:10:44] [config] transformer-postprocess-top: ""
[2024-07-21 16:10:44] [config] transformer-preprocess: ""
[2024-07-21 16:10:44] [config] transformer-rnn-projection: false
[2024-07-21 16:10:44] [config] transformer-tied-layers:
[2024-07-21 16:10:44] [config]   []
[2024-07-21 16:10:44] [config] transformer-train-position-embeddings: false
[2024-07-21 16:10:44] [config] tsv: false
[2024-07-21 16:10:44] [config] tsv-fields: 0
[2024-07-21 16:10:44] [config] type: transformer
[2024-07-21 16:10:44] [config] ulr: false
[2024-07-21 16:10:44] [config] ulr-dim-emb: 0
[2024-07-21 16:10:44] [config] ulr-dropout: 0
[2024-07-21 16:10:44] [config] ulr-keys-vectors: ""
[2024-07-21 16:10:44] [config] ulr-query-vectors: ""
[2024-07-21 16:10:44] [config] ulr-softmax-temperature: 1
[2024-07-21 16:10:44] [config] ulr-trainable-transformation: false
[2024-07-21 16:10:44] [config] unlikelihood-loss: false
[2024-07-21 16:10:44] [config] valid-freq: 10000
[2024-07-21 16:10:44] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-21 16:10:44] [config] valid-max-length: 100
[2024-07-21 16:10:44] [config] valid-metrics:
[2024-07-21 16:10:44] [config]   - perplexity
[2024-07-21 16:10:44] [config] valid-mini-batch: 16
[2024-07-21 16:10:44] [config] valid-reset-stalled: false
[2024-07-21 16:10:44] [config] valid-script-args:
[2024-07-21 16:10:44] [config]   []
[2024-07-21 16:10:44] [config] valid-script-path: ""
[2024-07-21 16:10:44] [config] valid-sets:
[2024-07-21 16:10:44] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-21 16:10:44] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-21 16:10:44] [config] valid-translation-output: ""
[2024-07-21 16:10:44] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-21 16:10:44] [config] vocabs:
[2024-07-21 16:10:44] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-21 16:10:44] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-21 16:10:44] [config] word-penalty: 0
[2024-07-21 16:10:44] [config] word-scores: false
[2024-07-21 16:10:44] [config] workspace: 20000
[2024-07-21 16:10:44] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-21 16:10:44] Using synchronous SGD
[2024-07-21 16:10:44] [comm] Compiled without MPI support. Running as a single process on nid007871
[2024-07-21 16:10:44] Synced seed 2222
[2024-07-21 16:10:44] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-21 16:10:45] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-21 16:10:45] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-21 16:10:45] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-21 16:10:45] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-21 16:10:49] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-21 16:10:49] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-21 16:10:49] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-21 16:10:49] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-21 16:10:49] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-21 16:10:49] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-21 16:10:49] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-21 16:10:49] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-21 16:10:49] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-21 16:10:52] [comm] Using global sharding
[2024-07-21 16:10:52] [comm] NCCLCommunicators constructed successfully
[2024-07-21 16:10:52] [training] Using 8 GPUs
[2024-07-21 16:10:53] [logits] Applying loss function for 1 factor(s)
[2024-07-21 16:10:53] [memory] Reserving 945 MB, device gpu0
[2024-07-21 16:10:58] [memory] Reserving 945 MB, device gpu0
[2024-07-21 16:11:31] [batching] Done. Typical MB size is 699,120 target words
[2024-07-21 16:11:32] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-21 16:11:32] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-21 16:11:32] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-21 16:11:32] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-21 16:11:32] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-21 16:11:32] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-21 16:11:32] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-21 16:11:32] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-21 16:11:32] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-21 16:11:32] [comm] Using global sharding
[2024-07-21 16:11:32] [comm] NCCLCommunicators constructed successfully
[2024-07-21 16:11:32] [training] Using 8 GPUs
[2024-07-21 16:11:32] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-21 16:11:50] Allocating memory for general optimizer shards
[2024-07-21 16:11:50] [memory] Reserving 118 MB, device gpu0
[2024-07-21 16:11:50] [memory] Reserving 118 MB, device gpu1
[2024-07-21 16:11:50] [memory] Reserving 118 MB, device gpu2
[2024-07-21 16:11:50] [memory] Reserving 118 MB, device gpu3
[2024-07-21 16:11:50] [memory] Reserving 118 MB, device gpu4
[2024-07-21 16:11:50] [memory] Reserving 118 MB, device gpu5
[2024-07-21 16:11:50] [memory] Reserving 118 MB, device gpu6
[2024-07-21 16:11:50] [memory] Reserving 118 MB, device gpu7
[2024-07-21 16:11:51] Loading Adam parameters
[2024-07-21 16:11:52] [memory] Reserving 236 MB, device gpu0
[2024-07-21 16:11:53] [memory] Reserving 236 MB, device gpu1
[2024-07-21 16:11:53] [memory] Reserving 236 MB, device gpu2
[2024-07-21 16:11:53] [memory] Reserving 236 MB, device gpu3
[2024-07-21 16:11:53] [memory] Reserving 236 MB, device gpu4
[2024-07-21 16:11:53] [memory] Reserving 236 MB, device gpu5
[2024-07-21 16:11:53] [memory] Reserving 236 MB, device gpu6
[2024-07-21 16:11:54] [memory] Reserving 236 MB, device gpu7
[2024-07-21 16:11:54] [memory] Reserving 945 MB, device gpu0
[2024-07-21 16:11:54] [memory] Reserving 945 MB, device gpu1
[2024-07-21 16:11:54] [memory] Reserving 945 MB, device gpu2
[2024-07-21 16:11:55] [memory] Reserving 945 MB, device gpu3
[2024-07-21 16:11:55] [memory] Reserving 945 MB, device gpu4
[2024-07-21 16:11:55] [memory] Reserving 945 MB, device gpu5
[2024-07-21 16:11:55] [memory] Reserving 945 MB, device gpu6
[2024-07-21 16:11:56] [memory] Reserving 945 MB, device gpu7
[2024-07-21 16:11:56] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-21 16:11:56] [data] Restoring the corpus state to epoch 1, batch 740000
[2024-07-22 04:50:55] Training started
[2024-07-22 04:50:55] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-22 04:51:07] [memory] Reserving 945 MB, device gpu0
[2024-07-22 04:51:20] [memory] Reserving 945 MB, device gpu6
[2024-07-22 04:51:20] [memory] Reserving 945 MB, device gpu5
[2024-07-22 04:51:20] [memory] Reserving 945 MB, device gpu3
[2024-07-22 04:51:21] [memory] Reserving 945 MB, device gpu4
[2024-07-22 04:51:21] [memory] Reserving 945 MB, device gpu1
[2024-07-22 04:51:21] [memory] Reserving 945 MB, device gpu7
[2024-07-22 04:51:21] [memory] Reserving 945 MB, device gpu2
[2024-07-22 04:51:24] Parameter type float32, optimization type float32, casting types false
[2024-07-22 12:57:14] Ep. 1 : Up. 750000 : Sen. 5,761,453,491 : Cost 3.10966563 : Time 74742.26s : 36179.31 words/s : gNorm 1.7063
[2024-07-22 12:57:14] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-22 12:57:19] Saving Adam parameters
[2024-07-22 12:57:26] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-22 12:57:40] [valid] Ep. 1 : Up. 750000 : perplexity : 11.6033 : stalled 2 times (last best: 11.6026)
[2024-07-22 21:04:18] Ep. 1 : Up. 760000 : Sen. 5,838,399,804 : Cost 3.10999799 : Time 29223.80s : 92711.38 words/s : gNorm 1.2924
[2024-07-22 21:04:18] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-22 21:04:23] Saving Adam parameters
[2024-07-22 21:04:30] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-22 21:04:52] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-22 21:04:55] [valid] Ep. 1 : Up. 760000 : perplexity : 11.5885 : new best
[2024-07-23 05:09:47] Ep. 1 : Up. 770000 : Sen. 5,915,161,375 : Cost 3.10870028 : Time 29129.61s : 92720.33 words/s : gNorm 1.1366
[2024-07-23 05:09:47] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-23 05:09:52] Saving Adam parameters
[2024-07-23 05:10:00] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-23 05:10:14] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-23 05:10:17] [valid] Ep. 1 : Up. 770000 : perplexity : 11.5844 : new best
[2024-07-23 13:16:26] Ep. 1 : Up. 780000 : Sen. 5,991,949,911 : Cost 3.10805392 : Time 29198.90s : 92621.80 words/s : gNorm 1.4661
[2024-07-23 13:16:26] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-23 13:16:31] Saving Adam parameters
[2024-07-23 13:16:39] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-23 13:16:53] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-23 13:16:56] [valid] Ep. 1 : Up. 780000 : perplexity : 11.5785 : new best
[2024-07-23 21:22:24] Ep. 1 : Up. 790000 : Sen. 6,068,714,364 : Cost 3.10805821 : Time 29157.96s : 92751.61 words/s : gNorm 1.0901
[2024-07-23 21:22:24] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-23 21:22:29] Saving Adam parameters
[2024-07-23 21:22:37] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-23 21:22:51] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-23 21:22:53] [valid] Ep. 1 : Up. 790000 : perplexity : 11.5783 : new best
[2024-07-24 05:29:44] Ep. 1 : Up. 800000 : Sen. 6,145,567,626 : Cost 3.10829163 : Time 29239.94s : 92550.66 words/s : gNorm 1.3068
[2024-07-24 05:29:44] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-24 05:29:49] Saving Adam parameters
[2024-07-24 05:29:57] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-24 05:30:11] [valid] Ep. 1 : Up. 800000 : perplexity : 11.5863 : stalled 1 times (last best: 11.5783)
[2024-07-24 13:36:07] Ep. 1 : Up. 810000 : Sen. 6,222,407,540 : Cost 3.10695601 : Time 29182.88s : 92757.01 words/s : gNorm 1.1275
[2024-07-24 13:36:07] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-24 13:36:12] Saving Adam parameters
[2024-07-24 13:36:20] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-24 13:36:34] [valid] Ep. 1 : Up. 810000 : perplexity : 11.5903 : stalled 2 times (last best: 11.5783)
[2024-07-24 22:30:09] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-24 22:30:09] [marian] Running on nid007857 as process 67915 with command line:
[2024-07-24 22:30:09] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-24 22:30:11] [config] after: 0e
[2024-07-24 22:30:11] [config] after-batches: 0
[2024-07-24 22:30:11] [config] after-epochs: 0
[2024-07-24 22:30:11] [config] all-caps-every: 0
[2024-07-24 22:30:11] [config] allow-unk: true
[2024-07-24 22:30:11] [config] authors: false
[2024-07-24 22:30:11] [config] beam-size: 6
[2024-07-24 22:30:11] [config] bert-class-symbol: "[CLS]"
[2024-07-24 22:30:11] [config] bert-mask-symbol: "[MASK]"
[2024-07-24 22:30:11] [config] bert-masking-fraction: 0.15
[2024-07-24 22:30:11] [config] bert-sep-symbol: "[SEP]"
[2024-07-24 22:30:11] [config] bert-train-type-embeddings: true
[2024-07-24 22:30:11] [config] bert-type-vocab-size: 2
[2024-07-24 22:30:11] [config] build-info: ""
[2024-07-24 22:30:11] [config] char-conv-filters-num:
[2024-07-24 22:30:11] [config]   - 200
[2024-07-24 22:30:11] [config]   - 200
[2024-07-24 22:30:11] [config]   - 250
[2024-07-24 22:30:11] [config]   - 250
[2024-07-24 22:30:11] [config]   - 300
[2024-07-24 22:30:11] [config]   - 300
[2024-07-24 22:30:11] [config]   - 300
[2024-07-24 22:30:11] [config]   - 300
[2024-07-24 22:30:11] [config] char-conv-filters-widths:
[2024-07-24 22:30:11] [config]   - 1
[2024-07-24 22:30:11] [config]   - 2
[2024-07-24 22:30:11] [config]   - 3
[2024-07-24 22:30:11] [config]   - 4
[2024-07-24 22:30:11] [config]   - 5
[2024-07-24 22:30:11] [config]   - 6
[2024-07-24 22:30:11] [config]   - 7
[2024-07-24 22:30:11] [config]   - 8
[2024-07-24 22:30:11] [config] char-highway: 4
[2024-07-24 22:30:11] [config] char-stride: 5
[2024-07-24 22:30:11] [config] check-gradient-nan: false
[2024-07-24 22:30:11] [config] check-nan: false
[2024-07-24 22:30:11] [config] cite: false
[2024-07-24 22:30:11] [config] clip-norm: 0
[2024-07-24 22:30:11] [config] cost-scaling:
[2024-07-24 22:30:11] [config]   []
[2024-07-24 22:30:11] [config] cost-type: ce-mean-words
[2024-07-24 22:30:11] [config] cpu-threads: 0
[2024-07-24 22:30:11] [config] data-threads: 8
[2024-07-24 22:30:11] [config] data-weighting: ""
[2024-07-24 22:30:11] [config] data-weighting-type: sentence
[2024-07-24 22:30:11] [config] dec-cell: gru
[2024-07-24 22:30:11] [config] dec-cell-base-depth: 2
[2024-07-24 22:30:11] [config] dec-cell-high-depth: 1
[2024-07-24 22:30:11] [config] dec-depth: 6
[2024-07-24 22:30:11] [config] devices:
[2024-07-24 22:30:11] [config]   - 0
[2024-07-24 22:30:11] [config]   - 1
[2024-07-24 22:30:11] [config]   - 2
[2024-07-24 22:30:11] [config]   - 3
[2024-07-24 22:30:11] [config]   - 4
[2024-07-24 22:30:11] [config]   - 5
[2024-07-24 22:30:11] [config]   - 6
[2024-07-24 22:30:11] [config]   - 7
[2024-07-24 22:30:11] [config] dim-emb: 1024
[2024-07-24 22:30:11] [config] dim-rnn: 1024
[2024-07-24 22:30:11] [config] dim-vocabs:
[2024-07-24 22:30:11] [config]   - 69666
[2024-07-24 22:30:11] [config]   - 69666
[2024-07-24 22:30:11] [config] disp-first: 10
[2024-07-24 22:30:11] [config] disp-freq: 10000
[2024-07-24 22:30:11] [config] disp-label-counts: true
[2024-07-24 22:30:11] [config] dropout-rnn: 0
[2024-07-24 22:30:11] [config] dropout-src: 0
[2024-07-24 22:30:11] [config] dropout-trg: 0
[2024-07-24 22:30:11] [config] dump-config: ""
[2024-07-24 22:30:11] [config] dynamic-gradient-scaling:
[2024-07-24 22:30:11] [config]   []
[2024-07-24 22:30:11] [config] early-stopping: 20
[2024-07-24 22:30:11] [config] early-stopping-on: first
[2024-07-24 22:30:11] [config] embedding-fix-src: false
[2024-07-24 22:30:11] [config] embedding-fix-trg: false
[2024-07-24 22:30:11] [config] embedding-normalization: false
[2024-07-24 22:30:11] [config] embedding-vectors:
[2024-07-24 22:30:11] [config]   []
[2024-07-24 22:30:11] [config] enc-cell: gru
[2024-07-24 22:30:11] [config] enc-cell-depth: 1
[2024-07-24 22:30:11] [config] enc-depth: 6
[2024-07-24 22:30:11] [config] enc-type: bidirectional
[2024-07-24 22:30:11] [config] english-title-case-every: 0
[2024-07-24 22:30:11] [config] exponential-smoothing: 0.0001
[2024-07-24 22:30:11] [config] factor-weight: 1
[2024-07-24 22:30:11] [config] factors-combine: sum
[2024-07-24 22:30:11] [config] factors-dim-emb: 0
[2024-07-24 22:30:11] [config] gradient-checkpointing: false
[2024-07-24 22:30:11] [config] gradient-norm-average-window: 100
[2024-07-24 22:30:11] [config] guided-alignment: none
[2024-07-24 22:30:11] [config] guided-alignment-cost: ce
[2024-07-24 22:30:11] [config] guided-alignment-weight: 0.1
[2024-07-24 22:30:11] [config] ignore-model-config: false
[2024-07-24 22:30:11] [config] input-types:
[2024-07-24 22:30:11] [config]   []
[2024-07-24 22:30:11] [config] interpolate-env-vars: false
[2024-07-24 22:30:11] [config] keep-best: true
[2024-07-24 22:30:11] [config] label-smoothing: 0.1
[2024-07-24 22:30:11] [config] layer-normalization: false
[2024-07-24 22:30:11] [config] learn-rate: 0.0002
[2024-07-24 22:30:11] [config] lemma-dependency: ""
[2024-07-24 22:30:11] [config] lemma-dim-emb: 0
[2024-07-24 22:30:11] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-24 22:30:11] [config] log-level: info
[2024-07-24 22:30:11] [config] log-time-zone: ""
[2024-07-24 22:30:11] [config] logical-epoch:
[2024-07-24 22:30:11] [config]   - 1e
[2024-07-24 22:30:11] [config]   - 0
[2024-07-24 22:30:11] [config] lr-decay: 0
[2024-07-24 22:30:11] [config] lr-decay-freq: 50000
[2024-07-24 22:30:11] [config] lr-decay-inv-sqrt:
[2024-07-24 22:30:11] [config]   - 8000
[2024-07-24 22:30:11] [config] lr-decay-repeat-warmup: false
[2024-07-24 22:30:11] [config] lr-decay-reset-optimizer: false
[2024-07-24 22:30:11] [config] lr-decay-start:
[2024-07-24 22:30:11] [config]   - 10
[2024-07-24 22:30:11] [config]   - 1
[2024-07-24 22:30:11] [config] lr-decay-strategy: epoch+stalled
[2024-07-24 22:30:11] [config] lr-report: false
[2024-07-24 22:30:11] [config] lr-warmup: 8000
[2024-07-24 22:30:11] [config] lr-warmup-at-reload: false
[2024-07-24 22:30:11] [config] lr-warmup-cycle: true
[2024-07-24 22:30:11] [config] lr-warmup-start-rate: 0
[2024-07-24 22:30:11] [config] max-length: 100
[2024-07-24 22:30:11] [config] max-length-crop: false
[2024-07-24 22:30:11] [config] max-length-factor: 3
[2024-07-24 22:30:11] [config] maxi-batch: 1000
[2024-07-24 22:30:11] [config] maxi-batch-sort: trg
[2024-07-24 22:30:11] [config] mini-batch: 1000
[2024-07-24 22:30:11] [config] mini-batch-fit: true
[2024-07-24 22:30:11] [config] mini-batch-fit-step: 10
[2024-07-24 22:30:11] [config] mini-batch-round-up: true
[2024-07-24 22:30:11] [config] mini-batch-track-lr: false
[2024-07-24 22:30:11] [config] mini-batch-warmup: 0
[2024-07-24 22:30:11] [config] mini-batch-words: 0
[2024-07-24 22:30:11] [config] mini-batch-words-ref: 0
[2024-07-24 22:30:11] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-24 22:30:11] [config] multi-loss-type: sum
[2024-07-24 22:30:11] [config] n-best: false
[2024-07-24 22:30:11] [config] no-nccl: false
[2024-07-24 22:30:11] [config] no-reload: false
[2024-07-24 22:30:11] [config] no-restore-corpus: false
[2024-07-24 22:30:11] [config] normalize: 1
[2024-07-24 22:30:11] [config] normalize-gradient: false
[2024-07-24 22:30:11] [config] num-devices: 0
[2024-07-24 22:30:11] [config] optimizer: adam
[2024-07-24 22:30:11] [config] optimizer-delay: 10
[2024-07-24 22:30:11] [config] optimizer-params:
[2024-07-24 22:30:11] [config]   - 0.9
[2024-07-24 22:30:11] [config]   - 0.998
[2024-07-24 22:30:11] [config]   - 1e-09
[2024-07-24 22:30:11] [config] output-omit-bias: false
[2024-07-24 22:30:11] [config] overwrite: true
[2024-07-24 22:30:11] [config] precision:
[2024-07-24 22:30:11] [config]   - float32
[2024-07-24 22:30:11] [config]   - float32
[2024-07-24 22:30:11] [config] pretrained-model: ""
[2024-07-24 22:30:11] [config] quantize-biases: false
[2024-07-24 22:30:11] [config] quantize-bits: 0
[2024-07-24 22:30:11] [config] quantize-log-based: false
[2024-07-24 22:30:11] [config] quantize-optimization-steps: 0
[2024-07-24 22:30:11] [config] quiet: false
[2024-07-24 22:30:11] [config] quiet-translation: false
[2024-07-24 22:30:11] [config] relative-paths: false
[2024-07-24 22:30:11] [config] right-left: false
[2024-07-24 22:30:11] [config] save-freq: 10000
[2024-07-24 22:30:11] [config] seed: 2222
[2024-07-24 22:30:11] [config] sentencepiece-alphas:
[2024-07-24 22:30:11] [config]   []
[2024-07-24 22:30:11] [config] sentencepiece-max-lines: 2000000
[2024-07-24 22:30:11] [config] sentencepiece-options: ""
[2024-07-24 22:30:11] [config] sharding: local
[2024-07-24 22:30:11] [config] shuffle: batches
[2024-07-24 22:30:11] [config] shuffle-in-ram: false
[2024-07-24 22:30:11] [config] sigterm: save-and-exit
[2024-07-24 22:30:11] [config] skip: false
[2024-07-24 22:30:11] [config] sqlite: ""
[2024-07-24 22:30:11] [config] sqlite-drop: false
[2024-07-24 22:30:11] [config] sync-freq: 200u
[2024-07-24 22:30:11] [config] sync-sgd: true
[2024-07-24 22:30:11] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-24 22:30:11] [config] tied-embeddings: false
[2024-07-24 22:30:11] [config] tied-embeddings-all: true
[2024-07-24 22:30:11] [config] tied-embeddings-src: false
[2024-07-24 22:30:11] [config] train-embedder-rank:
[2024-07-24 22:30:11] [config]   []
[2024-07-24 22:30:11] [config] train-sets:
[2024-07-24 22:30:11] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-24 22:30:11] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-24 22:30:11] [config] transformer-aan-activation: swish
[2024-07-24 22:30:11] [config] transformer-aan-depth: 2
[2024-07-24 22:30:11] [config] transformer-aan-nogate: false
[2024-07-24 22:30:11] [config] transformer-decoder-autoreg: self-attention
[2024-07-24 22:30:11] [config] transformer-decoder-dim-ffn: 0
[2024-07-24 22:30:11] [config] transformer-decoder-ffn-depth: 0
[2024-07-24 22:30:11] [config] transformer-depth-scaling: false
[2024-07-24 22:30:11] [config] transformer-dim-aan: 2048
[2024-07-24 22:30:11] [config] transformer-dim-ffn: 4096
[2024-07-24 22:30:11] [config] transformer-dropout: 0.1
[2024-07-24 22:30:11] [config] transformer-dropout-attention: 0
[2024-07-24 22:30:11] [config] transformer-dropout-ffn: 0
[2024-07-24 22:30:11] [config] transformer-ffn-activation: relu
[2024-07-24 22:30:11] [config] transformer-ffn-depth: 2
[2024-07-24 22:30:11] [config] transformer-guided-alignment-layer: last
[2024-07-24 22:30:11] [config] transformer-heads: 16
[2024-07-24 22:30:11] [config] transformer-no-projection: false
[2024-07-24 22:30:11] [config] transformer-pool: false
[2024-07-24 22:30:11] [config] transformer-postprocess: dan
[2024-07-24 22:30:11] [config] transformer-postprocess-emb: d
[2024-07-24 22:30:11] [config] transformer-postprocess-top: ""
[2024-07-24 22:30:11] [config] transformer-preprocess: ""
[2024-07-24 22:30:11] [config] transformer-rnn-projection: false
[2024-07-24 22:30:11] [config] transformer-tied-layers:
[2024-07-24 22:30:11] [config]   []
[2024-07-24 22:30:11] [config] transformer-train-position-embeddings: false
[2024-07-24 22:30:11] [config] tsv: false
[2024-07-24 22:30:11] [config] tsv-fields: 0
[2024-07-24 22:30:11] [config] type: transformer
[2024-07-24 22:30:11] [config] ulr: false
[2024-07-24 22:30:11] [config] ulr-dim-emb: 0
[2024-07-24 22:30:11] [config] ulr-dropout: 0
[2024-07-24 22:30:11] [config] ulr-keys-vectors: ""
[2024-07-24 22:30:11] [config] ulr-query-vectors: ""
[2024-07-24 22:30:11] [config] ulr-softmax-temperature: 1
[2024-07-24 22:30:11] [config] ulr-trainable-transformation: false
[2024-07-24 22:30:11] [config] unlikelihood-loss: false
[2024-07-24 22:30:11] [config] valid-freq: 10000
[2024-07-24 22:30:11] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-24 22:30:11] [config] valid-max-length: 100
[2024-07-24 22:30:11] [config] valid-metrics:
[2024-07-24 22:30:11] [config]   - perplexity
[2024-07-24 22:30:11] [config] valid-mini-batch: 16
[2024-07-24 22:30:11] [config] valid-reset-stalled: false
[2024-07-24 22:30:11] [config] valid-script-args:
[2024-07-24 22:30:11] [config]   []
[2024-07-24 22:30:11] [config] valid-script-path: ""
[2024-07-24 22:30:11] [config] valid-sets:
[2024-07-24 22:30:11] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-24 22:30:11] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-24 22:30:11] [config] valid-translation-output: ""
[2024-07-24 22:30:11] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-24 22:30:11] [config] vocabs:
[2024-07-24 22:30:11] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-24 22:30:11] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-24 22:30:11] [config] word-penalty: 0
[2024-07-24 22:30:11] [config] word-scores: false
[2024-07-24 22:30:11] [config] workspace: 20000
[2024-07-24 22:30:11] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-24 22:30:11] Using synchronous SGD
[2024-07-24 22:30:11] [comm] Compiled without MPI support. Running as a single process on nid007857
[2024-07-24 22:30:11] Synced seed 2222
[2024-07-24 22:30:11] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-24 22:30:11] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-24 22:30:11] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-24 22:30:11] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-24 22:30:11] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-24 22:30:13] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-24 22:30:13] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-24 22:30:13] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-24 22:30:13] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-24 22:30:13] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-24 22:30:13] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-24 22:30:13] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-24 22:30:13] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-24 22:30:13] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-24 22:30:15] [comm] Using global sharding
[2024-07-24 22:30:16] [comm] NCCLCommunicators constructed successfully
[2024-07-24 22:30:16] [training] Using 8 GPUs
[2024-07-24 22:30:16] [logits] Applying loss function for 1 factor(s)
[2024-07-24 22:30:16] [memory] Reserving 945 MB, device gpu0
[2024-07-24 22:30:21] [memory] Reserving 945 MB, device gpu0
[2024-07-24 22:30:55] [batching] Done. Typical MB size is 699,120 target words
[2024-07-24 22:30:55] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-24 22:30:55] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-24 22:30:55] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-24 22:30:55] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-24 22:30:55] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-24 22:30:55] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-24 22:30:55] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-24 22:30:55] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-24 22:30:55] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-24 22:30:55] [comm] Using global sharding
[2024-07-24 22:30:56] [comm] NCCLCommunicators constructed successfully
[2024-07-24 22:30:56] [training] Using 8 GPUs
[2024-07-24 22:30:56] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-24 22:31:14] Allocating memory for general optimizer shards
[2024-07-24 22:31:14] [memory] Reserving 118 MB, device gpu0
[2024-07-24 22:31:14] [memory] Reserving 118 MB, device gpu1
[2024-07-24 22:31:14] [memory] Reserving 118 MB, device gpu2
[2024-07-24 22:31:14] [memory] Reserving 118 MB, device gpu3
[2024-07-24 22:31:14] [memory] Reserving 118 MB, device gpu4
[2024-07-24 22:31:14] [memory] Reserving 118 MB, device gpu5
[2024-07-24 22:31:14] [memory] Reserving 118 MB, device gpu6
[2024-07-24 22:31:14] [memory] Reserving 118 MB, device gpu7
[2024-07-24 22:31:14] Loading Adam parameters
[2024-07-24 22:31:16] [memory] Reserving 236 MB, device gpu0
[2024-07-24 22:31:16] [memory] Reserving 236 MB, device gpu1
[2024-07-24 22:31:16] [memory] Reserving 236 MB, device gpu2
[2024-07-24 22:31:16] [memory] Reserving 236 MB, device gpu3
[2024-07-24 22:31:16] [memory] Reserving 236 MB, device gpu4
[2024-07-24 22:31:17] [memory] Reserving 236 MB, device gpu5
[2024-07-24 22:31:17] [memory] Reserving 236 MB, device gpu6
[2024-07-24 22:31:17] [memory] Reserving 236 MB, device gpu7
[2024-07-24 22:31:17] [memory] Reserving 945 MB, device gpu0
[2024-07-24 22:31:18] [memory] Reserving 945 MB, device gpu1
[2024-07-24 22:31:18] [memory] Reserving 945 MB, device gpu2
[2024-07-24 22:31:18] [memory] Reserving 945 MB, device gpu3
[2024-07-24 22:31:19] [memory] Reserving 945 MB, device gpu4
[2024-07-24 22:31:19] [memory] Reserving 945 MB, device gpu5
[2024-07-24 22:31:19] [memory] Reserving 945 MB, device gpu6
[2024-07-24 22:31:19] [memory] Reserving 945 MB, device gpu7
[2024-07-24 22:31:20] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-24 22:31:20] [data] Restoring the corpus state to epoch 1, batch 810000
[2024-07-25 12:49:49] Training started
[2024-07-25 12:49:49] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-25 12:49:57] [memory] Reserving 945 MB, device gpu0
[2024-07-25 12:50:14] [memory] Reserving 945 MB, device gpu1
[2024-07-25 12:50:14] [memory] Reserving 945 MB, device gpu7
[2024-07-25 12:50:14] [memory] Reserving 945 MB, device gpu2
[2024-07-25 12:50:14] [memory] Reserving 945 MB, device gpu5
[2024-07-25 12:50:14] [memory] Reserving 945 MB, device gpu6
[2024-07-25 12:50:14] [memory] Reserving 945 MB, device gpu3
[2024-07-25 12:50:14] [memory] Reserving 945 MB, device gpu4
[2024-07-25 12:50:19] Parameter type float32, optimization type float32, casting types false
[2024-07-25 20:57:58] Ep. 1 : Up. 820000 : Sen. 6,299,356,292 : Cost 3.10648108 : Time 80823.44s : 33496.57 words/s : gNorm 1.3265
[2024-07-25 20:57:58] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-25 20:58:03] Saving Adam parameters
[2024-07-25 20:58:11] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-25 20:58:26] [valid] Ep. 1 : Up. 820000 : perplexity : 11.5884 : stalled 2 times (last best: 11.5783)
[2024-07-26 05:05:59] Ep. 1 : Up. 830000 : Sen. 6,376,187,114 : Cost 3.10641241 : Time 29280.94s : 92401.47 words/s : gNorm 1.4739
[2024-07-26 05:05:59] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-26 05:06:04] Saving Adam parameters
[2024-07-26 05:06:12] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-26 05:06:26] [valid] Ep. 1 : Up. 830000 : perplexity : 11.5908 : stalled 3 times (last best: 11.5783)
[2024-07-26 13:13:46] Ep. 1 : Up. 840000 : Sen. 6,453,068,279 : Cost 3.10686255 : Time 29266.57s : 92504.81 words/s : gNorm 1.1309
[2024-07-26 13:13:46] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-26 13:13:51] Saving Adam parameters
[2024-07-26 13:13:59] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-26 13:14:12] [valid] Ep. 1 : Up. 840000 : perplexity : 11.5898 : stalled 4 times (last best: 11.5783)
[2024-07-26 21:21:05] Ep. 1 : Up. 850000 : Sen. 6,529,885,866 : Cost 3.10566878 : Time 29238.88s : 92489.75 words/s : gNorm 1.5459
[2024-07-26 21:21:05] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-26 21:21:10] Saving Adam parameters
[2024-07-26 21:21:18] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-26 21:21:31] [valid] Ep. 1 : Up. 850000 : perplexity : 11.5892 : stalled 5 times (last best: 11.5783)
[2024-07-27 05:28:18] Ep. 1 : Up. 860000 : Sen. 6,606,694,935 : Cost 3.10497928 : Time 29233.13s : 92519.05 words/s : gNorm 1.2792
[2024-07-27 05:28:18] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-27 05:28:23] Saving Adam parameters
[2024-07-27 05:28:31] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-27 05:28:45] [valid] Ep. 1 : Up. 860000 : perplexity : 11.5942 : stalled 6 times (last best: 11.5783)
[2024-07-27 13:35:15] Ep. 1 : Up. 870000 : Sen. 6,683,520,934 : Cost 3.10492086 : Time 29216.44s : 92570.33 words/s : gNorm 1.2816
[2024-07-27 13:35:15] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-27 13:35:19] Saving Adam parameters
[2024-07-27 13:35:27] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-27 13:35:41] [valid] Ep. 1 : Up. 870000 : perplexity : 11.5854 : stalled 7 times (last best: 11.5783)
[2024-07-27 21:41:53] Ep. 1 : Up. 880000 : Sen. 6,760,234,783 : Cost 3.10517001 : Time 29198.59s : 92546.82 words/s : gNorm 1.3551
[2024-07-27 21:41:53] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-27 21:41:58] Saving Adam parameters
[2024-07-27 21:42:06] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-27 21:42:20] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-27 21:42:23] [valid] Ep. 1 : Up. 880000 : perplexity : 11.5772 : new best
[2024-07-28 00:32:01] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-28 00:32:01] [marian] Running on nid007860 as process 23870 with command line:
[2024-07-28 00:32:01] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-28 00:32:02] [config] after: 0e
[2024-07-28 00:32:02] [config] after-batches: 0
[2024-07-28 00:32:02] [config] after-epochs: 0
[2024-07-28 00:32:02] [config] all-caps-every: 0
[2024-07-28 00:32:02] [config] allow-unk: true
[2024-07-28 00:32:02] [config] authors: false
[2024-07-28 00:32:02] [config] beam-size: 6
[2024-07-28 00:32:02] [config] bert-class-symbol: "[CLS]"
[2024-07-28 00:32:02] [config] bert-mask-symbol: "[MASK]"
[2024-07-28 00:32:02] [config] bert-masking-fraction: 0.15
[2024-07-28 00:32:02] [config] bert-sep-symbol: "[SEP]"
[2024-07-28 00:32:02] [config] bert-train-type-embeddings: true
[2024-07-28 00:32:02] [config] bert-type-vocab-size: 2
[2024-07-28 00:32:02] [config] build-info: ""
[2024-07-28 00:32:02] [config] char-conv-filters-num:
[2024-07-28 00:32:02] [config]   - 200
[2024-07-28 00:32:02] [config]   - 200
[2024-07-28 00:32:02] [config]   - 250
[2024-07-28 00:32:02] [config]   - 250
[2024-07-28 00:32:02] [config]   - 300
[2024-07-28 00:32:02] [config]   - 300
[2024-07-28 00:32:02] [config]   - 300
[2024-07-28 00:32:02] [config]   - 300
[2024-07-28 00:32:02] [config] char-conv-filters-widths:
[2024-07-28 00:32:02] [config]   - 1
[2024-07-28 00:32:02] [config]   - 2
[2024-07-28 00:32:02] [config]   - 3
[2024-07-28 00:32:02] [config]   - 4
[2024-07-28 00:32:02] [config]   - 5
[2024-07-28 00:32:02] [config]   - 6
[2024-07-28 00:32:02] [config]   - 7
[2024-07-28 00:32:02] [config]   - 8
[2024-07-28 00:32:02] [config] char-highway: 4
[2024-07-28 00:32:02] [config] char-stride: 5
[2024-07-28 00:32:02] [config] check-gradient-nan: false
[2024-07-28 00:32:02] [config] check-nan: false
[2024-07-28 00:32:02] [config] cite: false
[2024-07-28 00:32:02] [config] clip-norm: 0
[2024-07-28 00:32:02] [config] cost-scaling:
[2024-07-28 00:32:02] [config]   []
[2024-07-28 00:32:02] [config] cost-type: ce-mean-words
[2024-07-28 00:32:02] [config] cpu-threads: 0
[2024-07-28 00:32:02] [config] data-threads: 8
[2024-07-28 00:32:02] [config] data-weighting: ""
[2024-07-28 00:32:02] [config] data-weighting-type: sentence
[2024-07-28 00:32:02] [config] dec-cell: gru
[2024-07-28 00:32:02] [config] dec-cell-base-depth: 2
[2024-07-28 00:32:02] [config] dec-cell-high-depth: 1
[2024-07-28 00:32:02] [config] dec-depth: 6
[2024-07-28 00:32:02] [config] devices:
[2024-07-28 00:32:02] [config]   - 0
[2024-07-28 00:32:02] [config]   - 1
[2024-07-28 00:32:02] [config]   - 2
[2024-07-28 00:32:02] [config]   - 3
[2024-07-28 00:32:02] [config]   - 4
[2024-07-28 00:32:02] [config]   - 5
[2024-07-28 00:32:02] [config]   - 6
[2024-07-28 00:32:02] [config]   - 7
[2024-07-28 00:32:02] [config] dim-emb: 1024
[2024-07-28 00:32:02] [config] dim-rnn: 1024
[2024-07-28 00:32:02] [config] dim-vocabs:
[2024-07-28 00:32:02] [config]   - 69666
[2024-07-28 00:32:02] [config]   - 69666
[2024-07-28 00:32:02] [config] disp-first: 10
[2024-07-28 00:32:02] [config] disp-freq: 10000
[2024-07-28 00:32:02] [config] disp-label-counts: true
[2024-07-28 00:32:02] [config] dropout-rnn: 0
[2024-07-28 00:32:02] [config] dropout-src: 0
[2024-07-28 00:32:02] [config] dropout-trg: 0
[2024-07-28 00:32:02] [config] dump-config: ""
[2024-07-28 00:32:02] [config] dynamic-gradient-scaling:
[2024-07-28 00:32:02] [config]   []
[2024-07-28 00:32:02] [config] early-stopping: 20
[2024-07-28 00:32:02] [config] early-stopping-on: first
[2024-07-28 00:32:02] [config] embedding-fix-src: false
[2024-07-28 00:32:02] [config] embedding-fix-trg: false
[2024-07-28 00:32:02] [config] embedding-normalization: false
[2024-07-28 00:32:02] [config] embedding-vectors:
[2024-07-28 00:32:02] [config]   []
[2024-07-28 00:32:02] [config] enc-cell: gru
[2024-07-28 00:32:02] [config] enc-cell-depth: 1
[2024-07-28 00:32:02] [config] enc-depth: 6
[2024-07-28 00:32:02] [config] enc-type: bidirectional
[2024-07-28 00:32:02] [config] english-title-case-every: 0
[2024-07-28 00:32:02] [config] exponential-smoothing: 0.0001
[2024-07-28 00:32:02] [config] factor-weight: 1
[2024-07-28 00:32:02] [config] factors-combine: sum
[2024-07-28 00:32:02] [config] factors-dim-emb: 0
[2024-07-28 00:32:02] [config] gradient-checkpointing: false
[2024-07-28 00:32:02] [config] gradient-norm-average-window: 100
[2024-07-28 00:32:02] [config] guided-alignment: none
[2024-07-28 00:32:02] [config] guided-alignment-cost: ce
[2024-07-28 00:32:02] [config] guided-alignment-weight: 0.1
[2024-07-28 00:32:02] [config] ignore-model-config: false
[2024-07-28 00:32:02] [config] input-types:
[2024-07-28 00:32:02] [config]   []
[2024-07-28 00:32:02] [config] interpolate-env-vars: false
[2024-07-28 00:32:02] [config] keep-best: true
[2024-07-28 00:32:02] [config] label-smoothing: 0.1
[2024-07-28 00:32:02] [config] layer-normalization: false
[2024-07-28 00:32:02] [config] learn-rate: 0.0002
[2024-07-28 00:32:02] [config] lemma-dependency: ""
[2024-07-28 00:32:02] [config] lemma-dim-emb: 0
[2024-07-28 00:32:02] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-28 00:32:02] [config] log-level: info
[2024-07-28 00:32:02] [config] log-time-zone: ""
[2024-07-28 00:32:02] [config] logical-epoch:
[2024-07-28 00:32:02] [config]   - 1e
[2024-07-28 00:32:02] [config]   - 0
[2024-07-28 00:32:02] [config] lr-decay: 0
[2024-07-28 00:32:02] [config] lr-decay-freq: 50000
[2024-07-28 00:32:02] [config] lr-decay-inv-sqrt:
[2024-07-28 00:32:02] [config]   - 8000
[2024-07-28 00:32:02] [config] lr-decay-repeat-warmup: false
[2024-07-28 00:32:02] [config] lr-decay-reset-optimizer: false
[2024-07-28 00:32:02] [config] lr-decay-start:
[2024-07-28 00:32:02] [config]   - 10
[2024-07-28 00:32:02] [config]   - 1
[2024-07-28 00:32:02] [config] lr-decay-strategy: epoch+stalled
[2024-07-28 00:32:02] [config] lr-report: false
[2024-07-28 00:32:02] [config] lr-warmup: 8000
[2024-07-28 00:32:02] [config] lr-warmup-at-reload: false
[2024-07-28 00:32:02] [config] lr-warmup-cycle: true
[2024-07-28 00:32:02] [config] lr-warmup-start-rate: 0
[2024-07-28 00:32:02] [config] max-length: 100
[2024-07-28 00:32:02] [config] max-length-crop: false
[2024-07-28 00:32:02] [config] max-length-factor: 3
[2024-07-28 00:32:02] [config] maxi-batch: 1000
[2024-07-28 00:32:02] [config] maxi-batch-sort: trg
[2024-07-28 00:32:02] [config] mini-batch: 1000
[2024-07-28 00:32:02] [config] mini-batch-fit: true
[2024-07-28 00:32:02] [config] mini-batch-fit-step: 10
[2024-07-28 00:32:02] [config] mini-batch-round-up: true
[2024-07-28 00:32:02] [config] mini-batch-track-lr: false
[2024-07-28 00:32:02] [config] mini-batch-warmup: 0
[2024-07-28 00:32:02] [config] mini-batch-words: 0
[2024-07-28 00:32:02] [config] mini-batch-words-ref: 0
[2024-07-28 00:32:02] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-28 00:32:02] [config] multi-loss-type: sum
[2024-07-28 00:32:02] [config] n-best: false
[2024-07-28 00:32:02] [config] no-nccl: false
[2024-07-28 00:32:02] [config] no-reload: false
[2024-07-28 00:32:02] [config] no-restore-corpus: false
[2024-07-28 00:32:02] [config] normalize: 1
[2024-07-28 00:32:02] [config] normalize-gradient: false
[2024-07-28 00:32:02] [config] num-devices: 0
[2024-07-28 00:32:02] [config] optimizer: adam
[2024-07-28 00:32:02] [config] optimizer-delay: 10
[2024-07-28 00:32:02] [config] optimizer-params:
[2024-07-28 00:32:02] [config]   - 0.9
[2024-07-28 00:32:02] [config]   - 0.998
[2024-07-28 00:32:02] [config]   - 1e-09
[2024-07-28 00:32:02] [config] output-omit-bias: false
[2024-07-28 00:32:02] [config] overwrite: true
[2024-07-28 00:32:02] [config] precision:
[2024-07-28 00:32:02] [config]   - float32
[2024-07-28 00:32:02] [config]   - float32
[2024-07-28 00:32:02] [config] pretrained-model: ""
[2024-07-28 00:32:02] [config] quantize-biases: false
[2024-07-28 00:32:02] [config] quantize-bits: 0
[2024-07-28 00:32:02] [config] quantize-log-based: false
[2024-07-28 00:32:02] [config] quantize-optimization-steps: 0
[2024-07-28 00:32:02] [config] quiet: false
[2024-07-28 00:32:02] [config] quiet-translation: false
[2024-07-28 00:32:02] [config] relative-paths: false
[2024-07-28 00:32:02] [config] right-left: false
[2024-07-28 00:32:02] [config] save-freq: 10000
[2024-07-28 00:32:02] [config] seed: 2222
[2024-07-28 00:32:02] [config] sentencepiece-alphas:
[2024-07-28 00:32:02] [config]   []
[2024-07-28 00:32:02] [config] sentencepiece-max-lines: 2000000
[2024-07-28 00:32:02] [config] sentencepiece-options: ""
[2024-07-28 00:32:02] [config] sharding: local
[2024-07-28 00:32:02] [config] shuffle: batches
[2024-07-28 00:32:02] [config] shuffle-in-ram: false
[2024-07-28 00:32:02] [config] sigterm: save-and-exit
[2024-07-28 00:32:02] [config] skip: false
[2024-07-28 00:32:02] [config] sqlite: ""
[2024-07-28 00:32:02] [config] sqlite-drop: false
[2024-07-28 00:32:02] [config] sync-freq: 200u
[2024-07-28 00:32:02] [config] sync-sgd: true
[2024-07-28 00:32:02] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-28 00:32:02] [config] tied-embeddings: false
[2024-07-28 00:32:02] [config] tied-embeddings-all: true
[2024-07-28 00:32:02] [config] tied-embeddings-src: false
[2024-07-28 00:32:02] [config] train-embedder-rank:
[2024-07-28 00:32:02] [config]   []
[2024-07-28 00:32:02] [config] train-sets:
[2024-07-28 00:32:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-28 00:32:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-28 00:32:02] [config] transformer-aan-activation: swish
[2024-07-28 00:32:02] [config] transformer-aan-depth: 2
[2024-07-28 00:32:02] [config] transformer-aan-nogate: false
[2024-07-28 00:32:02] [config] transformer-decoder-autoreg: self-attention
[2024-07-28 00:32:02] [config] transformer-decoder-dim-ffn: 0
[2024-07-28 00:32:02] [config] transformer-decoder-ffn-depth: 0
[2024-07-28 00:32:02] [config] transformer-depth-scaling: false
[2024-07-28 00:32:02] [config] transformer-dim-aan: 2048
[2024-07-28 00:32:02] [config] transformer-dim-ffn: 4096
[2024-07-28 00:32:02] [config] transformer-dropout: 0.1
[2024-07-28 00:32:02] [config] transformer-dropout-attention: 0
[2024-07-28 00:32:02] [config] transformer-dropout-ffn: 0
[2024-07-28 00:32:02] [config] transformer-ffn-activation: relu
[2024-07-28 00:32:02] [config] transformer-ffn-depth: 2
[2024-07-28 00:32:02] [config] transformer-guided-alignment-layer: last
[2024-07-28 00:32:02] [config] transformer-heads: 16
[2024-07-28 00:32:02] [config] transformer-no-projection: false
[2024-07-28 00:32:02] [config] transformer-pool: false
[2024-07-28 00:32:02] [config] transformer-postprocess: dan
[2024-07-28 00:32:02] [config] transformer-postprocess-emb: d
[2024-07-28 00:32:02] [config] transformer-postprocess-top: ""
[2024-07-28 00:32:02] [config] transformer-preprocess: ""
[2024-07-28 00:32:02] [config] transformer-rnn-projection: false
[2024-07-28 00:32:02] [config] transformer-tied-layers:
[2024-07-28 00:32:02] [config]   []
[2024-07-28 00:32:02] [config] transformer-train-position-embeddings: false
[2024-07-28 00:32:02] [config] tsv: false
[2024-07-28 00:32:02] [config] tsv-fields: 0
[2024-07-28 00:32:02] [config] type: transformer
[2024-07-28 00:32:02] [config] ulr: false
[2024-07-28 00:32:02] [config] ulr-dim-emb: 0
[2024-07-28 00:32:02] [config] ulr-dropout: 0
[2024-07-28 00:32:02] [config] ulr-keys-vectors: ""
[2024-07-28 00:32:02] [config] ulr-query-vectors: ""
[2024-07-28 00:32:02] [config] ulr-softmax-temperature: 1
[2024-07-28 00:32:02] [config] ulr-trainable-transformation: false
[2024-07-28 00:32:02] [config] unlikelihood-loss: false
[2024-07-28 00:32:02] [config] valid-freq: 10000
[2024-07-28 00:32:02] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-28 00:32:02] [config] valid-max-length: 100
[2024-07-28 00:32:02] [config] valid-metrics:
[2024-07-28 00:32:02] [config]   - perplexity
[2024-07-28 00:32:02] [config] valid-mini-batch: 16
[2024-07-28 00:32:02] [config] valid-reset-stalled: false
[2024-07-28 00:32:02] [config] valid-script-args:
[2024-07-28 00:32:02] [config]   []
[2024-07-28 00:32:02] [config] valid-script-path: ""
[2024-07-28 00:32:02] [config] valid-sets:
[2024-07-28 00:32:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-28 00:32:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-28 00:32:02] [config] valid-translation-output: ""
[2024-07-28 00:32:02] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-28 00:32:02] [config] vocabs:
[2024-07-28 00:32:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-28 00:32:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-28 00:32:02] [config] word-penalty: 0
[2024-07-28 00:32:02] [config] word-scores: false
[2024-07-28 00:32:02] [config] workspace: 20000
[2024-07-28 00:32:02] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-28 00:32:02] Using synchronous SGD
[2024-07-28 00:32:02] [comm] Compiled without MPI support. Running as a single process on nid007860
[2024-07-28 00:32:02] Synced seed 2222
[2024-07-28 00:32:02] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-28 00:32:03] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-28 00:32:03] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-28 00:32:03] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-28 00:32:03] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-28 00:32:04] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-28 00:32:04] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-28 00:32:04] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-28 00:32:04] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-28 00:32:04] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-28 00:32:04] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-28 00:32:04] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-28 00:32:04] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-28 00:32:04] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-28 00:32:07] [comm] Using global sharding
[2024-07-28 00:32:08] [comm] NCCLCommunicators constructed successfully
[2024-07-28 00:32:08] [training] Using 8 GPUs
[2024-07-28 00:32:08] [logits] Applying loss function for 1 factor(s)
[2024-07-28 00:32:08] [memory] Reserving 945 MB, device gpu0
[2024-07-28 00:32:12] [memory] Reserving 945 MB, device gpu0
[2024-07-28 00:32:46] [batching] Done. Typical MB size is 699,120 target words
[2024-07-28 00:32:46] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-28 00:32:46] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-28 00:32:46] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-28 00:32:46] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-28 00:32:46] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-28 00:32:46] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-28 00:32:46] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-28 00:32:46] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-28 00:32:46] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-28 00:32:47] [comm] Using global sharding
[2024-07-28 00:32:47] [comm] NCCLCommunicators constructed successfully
[2024-07-28 00:32:47] [training] Using 8 GPUs
[2024-07-28 00:32:47] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-28 00:33:05] Allocating memory for general optimizer shards
[2024-07-28 00:33:05] [memory] Reserving 118 MB, device gpu0
[2024-07-28 00:33:05] [memory] Reserving 118 MB, device gpu1
[2024-07-28 00:33:05] [memory] Reserving 118 MB, device gpu2
[2024-07-28 00:33:05] [memory] Reserving 118 MB, device gpu3
[2024-07-28 00:33:05] [memory] Reserving 118 MB, device gpu4
[2024-07-28 00:33:05] [memory] Reserving 118 MB, device gpu5
[2024-07-28 00:33:05] [memory] Reserving 118 MB, device gpu6
[2024-07-28 00:33:05] [memory] Reserving 118 MB, device gpu7
[2024-07-28 00:33:05] Loading Adam parameters
[2024-07-28 00:33:07] [memory] Reserving 236 MB, device gpu0
[2024-07-28 00:33:07] [memory] Reserving 236 MB, device gpu1
[2024-07-28 00:33:07] [memory] Reserving 236 MB, device gpu2
[2024-07-28 00:33:08] [memory] Reserving 236 MB, device gpu3
[2024-07-28 00:33:08] [memory] Reserving 236 MB, device gpu4
[2024-07-28 00:33:08] [memory] Reserving 236 MB, device gpu5
[2024-07-28 00:33:08] [memory] Reserving 236 MB, device gpu6
[2024-07-28 00:33:08] [memory] Reserving 236 MB, device gpu7
[2024-07-28 00:33:09] [memory] Reserving 945 MB, device gpu0
[2024-07-28 00:33:09] [memory] Reserving 945 MB, device gpu1
[2024-07-28 00:33:09] [memory] Reserving 945 MB, device gpu2
[2024-07-28 00:33:10] [memory] Reserving 945 MB, device gpu3
[2024-07-28 00:33:10] [memory] Reserving 945 MB, device gpu4
[2024-07-28 00:33:10] [memory] Reserving 945 MB, device gpu5
[2024-07-28 00:33:10] [memory] Reserving 945 MB, device gpu6
[2024-07-28 00:33:11] [memory] Reserving 945 MB, device gpu7
[2024-07-28 00:33:11] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-28 00:33:11] [data] Restoring the corpus state to epoch 1, batch 880000
[2024-07-28 16:12:01] Training started
[2024-07-28 16:12:01] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-28 16:12:09] [memory] Reserving 945 MB, device gpu0
[2024-07-28 16:12:26] [memory] Reserving 945 MB, device gpu6
[2024-07-28 16:12:26] [memory] Reserving 945 MB, device gpu4
[2024-07-28 16:12:26] [memory] Reserving 945 MB, device gpu7
[2024-07-28 16:12:26] [memory] Reserving 945 MB, device gpu5
[2024-07-28 16:12:26] [memory] Reserving 945 MB, device gpu1
[2024-07-28 16:12:27] [memory] Reserving 945 MB, device gpu2
[2024-07-28 16:12:27] [memory] Reserving 945 MB, device gpu3
[2024-07-28 16:12:30] Parameter type float32, optimization type float32, casting types false
[2024-07-29 00:20:47] Ep. 1 : Up. 890000 : Sen. 6,837,089,805 : Cost 3.10426807 : Time 85680.17s : 31589.15 words/s : gNorm 1.4239
[2024-07-29 00:20:47] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-29 00:20:51] Saving Adam parameters
[2024-07-29 00:20:59] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-29 00:21:13] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-29 00:21:16] [valid] Ep. 1 : Up. 890000 : perplexity : 11.5654 : new best
[2024-07-29 08:29:14] Ep. 1 : Up. 900000 : Sen. 6,913,967,624 : Cost 3.10347342 : Time 29307.44s : 92309.49 words/s : gNorm 1.1626
[2024-07-29 08:29:14] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-29 08:29:19] Saving Adam parameters
[2024-07-29 08:29:27] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-29 08:29:41] [valid] Ep. 1 : Up. 900000 : perplexity : 11.5667 : stalled 1 times (last best: 11.5654)
[2024-07-29 16:37:28] Ep. 1 : Up. 910000 : Sen. 6,990,812,631 : Cost 3.10354781 : Time 29293.74s : 92399.54 words/s : gNorm 1.1512
[2024-07-29 16:37:28] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-29 16:37:33] Saving Adam parameters
[2024-07-29 16:37:41] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-29 16:37:55] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-29 16:37:58] [valid] Ep. 1 : Up. 910000 : perplexity : 11.5549 : new best
[2024-07-30 00:46:30] Ep. 1 : Up. 920000 : Sen. 7,067,631,559 : Cost 3.10402608 : Time 29341.64s : 92231.90 words/s : gNorm 1.1179
[2024-07-30 00:46:30] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-30 00:46:34] Saving Adam parameters
[2024-07-30 00:46:42] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-30 00:46:56] [valid] Ep. 1 : Up. 920000 : perplexity : 11.558 : stalled 1 times (last best: 11.5549)
[2024-07-30 08:54:25] Ep. 1 : Up. 930000 : Sen. 7,144,373,271 : Cost 3.10297728 : Time 29275.88s : 92314.05 words/s : gNorm 1.0618
[2024-07-30 08:54:26] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-30 08:54:31] Saving Adam parameters
[2024-07-30 08:54:38] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-30 08:54:52] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-30 08:54:55] [valid] Ep. 1 : Up. 930000 : perplexity : 11.5433 : new best
[2024-07-30 17:02:30] Ep. 1 : Up. 940000 : Sen. 7,221,152,804 : Cost 3.10228634 : Time 29284.83s : 92320.85 words/s : gNorm 1.5977
[2024-07-30 17:02:30] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-30 17:02:35] Saving Adam parameters
[2024-07-30 17:02:43] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-30 17:02:57] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-07-30 17:03:00] [valid] Ep. 1 : Up. 940000 : perplexity : 11.5378 : new best
[2024-07-31 00:33:33] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-31 00:33:33] [marian] Running on nid005074 as process 73237 with command line:
[2024-07-31 00:33:33] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-07-31 00:33:34] [config] after: 0e
[2024-07-31 00:33:34] [config] after-batches: 0
[2024-07-31 00:33:34] [config] after-epochs: 0
[2024-07-31 00:33:34] [config] all-caps-every: 0
[2024-07-31 00:33:34] [config] allow-unk: true
[2024-07-31 00:33:34] [config] authors: false
[2024-07-31 00:33:34] [config] beam-size: 6
[2024-07-31 00:33:34] [config] bert-class-symbol: "[CLS]"
[2024-07-31 00:33:34] [config] bert-mask-symbol: "[MASK]"
[2024-07-31 00:33:34] [config] bert-masking-fraction: 0.15
[2024-07-31 00:33:34] [config] bert-sep-symbol: "[SEP]"
[2024-07-31 00:33:34] [config] bert-train-type-embeddings: true
[2024-07-31 00:33:34] [config] bert-type-vocab-size: 2
[2024-07-31 00:33:34] [config] build-info: ""
[2024-07-31 00:33:34] [config] char-conv-filters-num:
[2024-07-31 00:33:34] [config]   - 200
[2024-07-31 00:33:34] [config]   - 200
[2024-07-31 00:33:34] [config]   - 250
[2024-07-31 00:33:34] [config]   - 250
[2024-07-31 00:33:34] [config]   - 300
[2024-07-31 00:33:34] [config]   - 300
[2024-07-31 00:33:34] [config]   - 300
[2024-07-31 00:33:34] [config]   - 300
[2024-07-31 00:33:34] [config] char-conv-filters-widths:
[2024-07-31 00:33:34] [config]   - 1
[2024-07-31 00:33:34] [config]   - 2
[2024-07-31 00:33:34] [config]   - 3
[2024-07-31 00:33:34] [config]   - 4
[2024-07-31 00:33:34] [config]   - 5
[2024-07-31 00:33:34] [config]   - 6
[2024-07-31 00:33:34] [config]   - 7
[2024-07-31 00:33:34] [config]   - 8
[2024-07-31 00:33:34] [config] char-highway: 4
[2024-07-31 00:33:34] [config] char-stride: 5
[2024-07-31 00:33:34] [config] check-gradient-nan: false
[2024-07-31 00:33:34] [config] check-nan: false
[2024-07-31 00:33:34] [config] cite: false
[2024-07-31 00:33:34] [config] clip-norm: 0
[2024-07-31 00:33:34] [config] cost-scaling:
[2024-07-31 00:33:34] [config]   []
[2024-07-31 00:33:34] [config] cost-type: ce-mean-words
[2024-07-31 00:33:34] [config] cpu-threads: 0
[2024-07-31 00:33:34] [config] data-threads: 8
[2024-07-31 00:33:34] [config] data-weighting: ""
[2024-07-31 00:33:34] [config] data-weighting-type: sentence
[2024-07-31 00:33:34] [config] dec-cell: gru
[2024-07-31 00:33:34] [config] dec-cell-base-depth: 2
[2024-07-31 00:33:34] [config] dec-cell-high-depth: 1
[2024-07-31 00:33:34] [config] dec-depth: 6
[2024-07-31 00:33:34] [config] devices:
[2024-07-31 00:33:34] [config]   - 0
[2024-07-31 00:33:34] [config]   - 1
[2024-07-31 00:33:34] [config]   - 2
[2024-07-31 00:33:34] [config]   - 3
[2024-07-31 00:33:34] [config]   - 4
[2024-07-31 00:33:34] [config]   - 5
[2024-07-31 00:33:34] [config]   - 6
[2024-07-31 00:33:34] [config]   - 7
[2024-07-31 00:33:34] [config] dim-emb: 1024
[2024-07-31 00:33:34] [config] dim-rnn: 1024
[2024-07-31 00:33:34] [config] dim-vocabs:
[2024-07-31 00:33:34] [config]   - 69666
[2024-07-31 00:33:34] [config]   - 69666
[2024-07-31 00:33:34] [config] disp-first: 10
[2024-07-31 00:33:34] [config] disp-freq: 10000
[2024-07-31 00:33:34] [config] disp-label-counts: true
[2024-07-31 00:33:34] [config] dropout-rnn: 0
[2024-07-31 00:33:34] [config] dropout-src: 0
[2024-07-31 00:33:34] [config] dropout-trg: 0
[2024-07-31 00:33:34] [config] dump-config: ""
[2024-07-31 00:33:34] [config] dynamic-gradient-scaling:
[2024-07-31 00:33:34] [config]   []
[2024-07-31 00:33:34] [config] early-stopping: 20
[2024-07-31 00:33:34] [config] early-stopping-on: first
[2024-07-31 00:33:34] [config] embedding-fix-src: false
[2024-07-31 00:33:34] [config] embedding-fix-trg: false
[2024-07-31 00:33:34] [config] embedding-normalization: false
[2024-07-31 00:33:34] [config] embedding-vectors:
[2024-07-31 00:33:34] [config]   []
[2024-07-31 00:33:34] [config] enc-cell: gru
[2024-07-31 00:33:34] [config] enc-cell-depth: 1
[2024-07-31 00:33:34] [config] enc-depth: 6
[2024-07-31 00:33:34] [config] enc-type: bidirectional
[2024-07-31 00:33:34] [config] english-title-case-every: 0
[2024-07-31 00:33:34] [config] exponential-smoothing: 0.0001
[2024-07-31 00:33:34] [config] factor-weight: 1
[2024-07-31 00:33:34] [config] factors-combine: sum
[2024-07-31 00:33:34] [config] factors-dim-emb: 0
[2024-07-31 00:33:34] [config] gradient-checkpointing: false
[2024-07-31 00:33:34] [config] gradient-norm-average-window: 100
[2024-07-31 00:33:34] [config] guided-alignment: none
[2024-07-31 00:33:34] [config] guided-alignment-cost: ce
[2024-07-31 00:33:34] [config] guided-alignment-weight: 0.1
[2024-07-31 00:33:34] [config] ignore-model-config: false
[2024-07-31 00:33:34] [config] input-types:
[2024-07-31 00:33:34] [config]   []
[2024-07-31 00:33:34] [config] interpolate-env-vars: false
[2024-07-31 00:33:34] [config] keep-best: true
[2024-07-31 00:33:34] [config] label-smoothing: 0.1
[2024-07-31 00:33:34] [config] layer-normalization: false
[2024-07-31 00:33:34] [config] learn-rate: 0.0002
[2024-07-31 00:33:34] [config] lemma-dependency: ""
[2024-07-31 00:33:34] [config] lemma-dim-emb: 0
[2024-07-31 00:33:34] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-07-31 00:33:34] [config] log-level: info
[2024-07-31 00:33:34] [config] log-time-zone: ""
[2024-07-31 00:33:34] [config] logical-epoch:
[2024-07-31 00:33:34] [config]   - 1e
[2024-07-31 00:33:34] [config]   - 0
[2024-07-31 00:33:34] [config] lr-decay: 0
[2024-07-31 00:33:34] [config] lr-decay-freq: 50000
[2024-07-31 00:33:34] [config] lr-decay-inv-sqrt:
[2024-07-31 00:33:34] [config]   - 8000
[2024-07-31 00:33:34] [config] lr-decay-repeat-warmup: false
[2024-07-31 00:33:34] [config] lr-decay-reset-optimizer: false
[2024-07-31 00:33:34] [config] lr-decay-start:
[2024-07-31 00:33:34] [config]   - 10
[2024-07-31 00:33:34] [config]   - 1
[2024-07-31 00:33:34] [config] lr-decay-strategy: epoch+stalled
[2024-07-31 00:33:34] [config] lr-report: false
[2024-07-31 00:33:34] [config] lr-warmup: 8000
[2024-07-31 00:33:34] [config] lr-warmup-at-reload: false
[2024-07-31 00:33:34] [config] lr-warmup-cycle: true
[2024-07-31 00:33:34] [config] lr-warmup-start-rate: 0
[2024-07-31 00:33:34] [config] max-length: 100
[2024-07-31 00:33:34] [config] max-length-crop: false
[2024-07-31 00:33:34] [config] max-length-factor: 3
[2024-07-31 00:33:34] [config] maxi-batch: 1000
[2024-07-31 00:33:34] [config] maxi-batch-sort: trg
[2024-07-31 00:33:34] [config] mini-batch: 1000
[2024-07-31 00:33:34] [config] mini-batch-fit: true
[2024-07-31 00:33:34] [config] mini-batch-fit-step: 10
[2024-07-31 00:33:34] [config] mini-batch-round-up: true
[2024-07-31 00:33:34] [config] mini-batch-track-lr: false
[2024-07-31 00:33:34] [config] mini-batch-warmup: 0
[2024-07-31 00:33:34] [config] mini-batch-words: 0
[2024-07-31 00:33:34] [config] mini-batch-words-ref: 0
[2024-07-31 00:33:34] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-31 00:33:34] [config] multi-loss-type: sum
[2024-07-31 00:33:34] [config] n-best: false
[2024-07-31 00:33:34] [config] no-nccl: false
[2024-07-31 00:33:34] [config] no-reload: false
[2024-07-31 00:33:34] [config] no-restore-corpus: false
[2024-07-31 00:33:34] [config] normalize: 1
[2024-07-31 00:33:34] [config] normalize-gradient: false
[2024-07-31 00:33:34] [config] num-devices: 0
[2024-07-31 00:33:34] [config] optimizer: adam
[2024-07-31 00:33:34] [config] optimizer-delay: 10
[2024-07-31 00:33:34] [config] optimizer-params:
[2024-07-31 00:33:34] [config]   - 0.9
[2024-07-31 00:33:34] [config]   - 0.998
[2024-07-31 00:33:34] [config]   - 1e-09
[2024-07-31 00:33:34] [config] output-omit-bias: false
[2024-07-31 00:33:34] [config] overwrite: true
[2024-07-31 00:33:34] [config] precision:
[2024-07-31 00:33:34] [config]   - float32
[2024-07-31 00:33:34] [config]   - float32
[2024-07-31 00:33:34] [config] pretrained-model: ""
[2024-07-31 00:33:34] [config] quantize-biases: false
[2024-07-31 00:33:34] [config] quantize-bits: 0
[2024-07-31 00:33:34] [config] quantize-log-based: false
[2024-07-31 00:33:34] [config] quantize-optimization-steps: 0
[2024-07-31 00:33:34] [config] quiet: false
[2024-07-31 00:33:34] [config] quiet-translation: false
[2024-07-31 00:33:34] [config] relative-paths: false
[2024-07-31 00:33:34] [config] right-left: false
[2024-07-31 00:33:34] [config] save-freq: 10000
[2024-07-31 00:33:34] [config] seed: 2222
[2024-07-31 00:33:34] [config] sentencepiece-alphas:
[2024-07-31 00:33:34] [config]   []
[2024-07-31 00:33:34] [config] sentencepiece-max-lines: 2000000
[2024-07-31 00:33:34] [config] sentencepiece-options: ""
[2024-07-31 00:33:34] [config] sharding: local
[2024-07-31 00:33:34] [config] shuffle: batches
[2024-07-31 00:33:34] [config] shuffle-in-ram: false
[2024-07-31 00:33:34] [config] sigterm: save-and-exit
[2024-07-31 00:33:34] [config] skip: false
[2024-07-31 00:33:34] [config] sqlite: ""
[2024-07-31 00:33:34] [config] sqlite-drop: false
[2024-07-31 00:33:34] [config] sync-freq: 200u
[2024-07-31 00:33:34] [config] sync-sgd: true
[2024-07-31 00:33:34] [config] tempdir: /scratch/project_462000447/tmp
[2024-07-31 00:33:34] [config] tied-embeddings: false
[2024-07-31 00:33:34] [config] tied-embeddings-all: true
[2024-07-31 00:33:34] [config] tied-embeddings-src: false
[2024-07-31 00:33:34] [config] train-embedder-rank:
[2024-07-31 00:33:34] [config]   []
[2024-07-31 00:33:34] [config] train-sets:
[2024-07-31 00:33:34] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-07-31 00:33:34] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-07-31 00:33:34] [config] transformer-aan-activation: swish
[2024-07-31 00:33:34] [config] transformer-aan-depth: 2
[2024-07-31 00:33:34] [config] transformer-aan-nogate: false
[2024-07-31 00:33:34] [config] transformer-decoder-autoreg: self-attention
[2024-07-31 00:33:34] [config] transformer-decoder-dim-ffn: 0
[2024-07-31 00:33:34] [config] transformer-decoder-ffn-depth: 0
[2024-07-31 00:33:34] [config] transformer-depth-scaling: false
[2024-07-31 00:33:34] [config] transformer-dim-aan: 2048
[2024-07-31 00:33:34] [config] transformer-dim-ffn: 4096
[2024-07-31 00:33:34] [config] transformer-dropout: 0.1
[2024-07-31 00:33:34] [config] transformer-dropout-attention: 0
[2024-07-31 00:33:34] [config] transformer-dropout-ffn: 0
[2024-07-31 00:33:34] [config] transformer-ffn-activation: relu
[2024-07-31 00:33:34] [config] transformer-ffn-depth: 2
[2024-07-31 00:33:34] [config] transformer-guided-alignment-layer: last
[2024-07-31 00:33:34] [config] transformer-heads: 16
[2024-07-31 00:33:34] [config] transformer-no-projection: false
[2024-07-31 00:33:34] [config] transformer-pool: false
[2024-07-31 00:33:34] [config] transformer-postprocess: dan
[2024-07-31 00:33:34] [config] transformer-postprocess-emb: d
[2024-07-31 00:33:34] [config] transformer-postprocess-top: ""
[2024-07-31 00:33:34] [config] transformer-preprocess: ""
[2024-07-31 00:33:34] [config] transformer-rnn-projection: false
[2024-07-31 00:33:34] [config] transformer-tied-layers:
[2024-07-31 00:33:34] [config]   []
[2024-07-31 00:33:34] [config] transformer-train-position-embeddings: false
[2024-07-31 00:33:34] [config] tsv: false
[2024-07-31 00:33:34] [config] tsv-fields: 0
[2024-07-31 00:33:34] [config] type: transformer
[2024-07-31 00:33:34] [config] ulr: false
[2024-07-31 00:33:34] [config] ulr-dim-emb: 0
[2024-07-31 00:33:34] [config] ulr-dropout: 0
[2024-07-31 00:33:34] [config] ulr-keys-vectors: ""
[2024-07-31 00:33:34] [config] ulr-query-vectors: ""
[2024-07-31 00:33:34] [config] ulr-softmax-temperature: 1
[2024-07-31 00:33:34] [config] ulr-trainable-transformation: false
[2024-07-31 00:33:34] [config] unlikelihood-loss: false
[2024-07-31 00:33:34] [config] valid-freq: 10000
[2024-07-31 00:33:34] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-07-31 00:33:34] [config] valid-max-length: 100
[2024-07-31 00:33:34] [config] valid-metrics:
[2024-07-31 00:33:34] [config]   - perplexity
[2024-07-31 00:33:34] [config] valid-mini-batch: 16
[2024-07-31 00:33:34] [config] valid-reset-stalled: false
[2024-07-31 00:33:34] [config] valid-script-args:
[2024-07-31 00:33:34] [config]   []
[2024-07-31 00:33:34] [config] valid-script-path: ""
[2024-07-31 00:33:34] [config] valid-sets:
[2024-07-31 00:33:34] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-07-31 00:33:34] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-07-31 00:33:34] [config] valid-translation-output: ""
[2024-07-31 00:33:34] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-31 00:33:34] [config] vocabs:
[2024-07-31 00:33:34] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-31 00:33:34] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-31 00:33:34] [config] word-penalty: 0
[2024-07-31 00:33:34] [config] word-scores: false
[2024-07-31 00:33:34] [config] workspace: 20000
[2024-07-31 00:33:34] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-07-31 00:33:34] Using synchronous SGD
[2024-07-31 00:33:34] [comm] Compiled without MPI support. Running as a single process on nid005074
[2024-07-31 00:33:34] Synced seed 2222
[2024-07-31 00:33:34] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-31 00:33:35] [data] Setting vocabulary size for input 0 to 69,666
[2024-07-31 00:33:35] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-07-31 00:33:35] [data] Setting vocabulary size for input 1 to 69,666
[2024-07-31 00:33:35] [batching] Collecting statistics for batch fitting with step size 10
[2024-07-31 00:33:36] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-31 00:33:36] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-31 00:33:36] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-31 00:33:36] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-31 00:33:36] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-31 00:33:36] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-31 00:33:36] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-31 00:33:36] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-31 00:33:36] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-31 00:33:39] [comm] Using global sharding
[2024-07-31 00:33:40] [comm] NCCLCommunicators constructed successfully
[2024-07-31 00:33:40] [training] Using 8 GPUs
[2024-07-31 00:33:40] [logits] Applying loss function for 1 factor(s)
[2024-07-31 00:33:40] [memory] Reserving 945 MB, device gpu0
[2024-07-31 00:33:45] [memory] Reserving 945 MB, device gpu0
[2024-07-31 00:34:19] [batching] Done. Typical MB size is 699,120 target words
[2024-07-31 00:34:19] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-07-31 00:34:19] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-07-31 00:34:19] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-07-31 00:34:19] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-07-31 00:34:19] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-07-31 00:34:19] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-07-31 00:34:19] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-07-31 00:34:19] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-07-31 00:34:19] [comm] Using NCCL 3.2.12 for GPU communication
[2024-07-31 00:34:19] [comm] Using global sharding
[2024-07-31 00:34:20] [comm] NCCLCommunicators constructed successfully
[2024-07-31 00:34:20] [training] Using 8 GPUs
[2024-07-31 00:34:20] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-07-31 00:34:37] Allocating memory for general optimizer shards
[2024-07-31 00:34:37] [memory] Reserving 118 MB, device gpu0
[2024-07-31 00:34:37] [memory] Reserving 118 MB, device gpu1
[2024-07-31 00:34:37] [memory] Reserving 118 MB, device gpu2
[2024-07-31 00:34:38] [memory] Reserving 118 MB, device gpu3
[2024-07-31 00:34:38] [memory] Reserving 118 MB, device gpu4
[2024-07-31 00:34:38] [memory] Reserving 118 MB, device gpu5
[2024-07-31 00:34:38] [memory] Reserving 118 MB, device gpu6
[2024-07-31 00:34:38] [memory] Reserving 118 MB, device gpu7
[2024-07-31 00:34:38] Loading Adam parameters
[2024-07-31 00:34:40] [memory] Reserving 236 MB, device gpu0
[2024-07-31 00:34:40] [memory] Reserving 236 MB, device gpu1
[2024-07-31 00:34:40] [memory] Reserving 236 MB, device gpu2
[2024-07-31 00:34:40] [memory] Reserving 236 MB, device gpu3
[2024-07-31 00:34:40] [memory] Reserving 236 MB, device gpu4
[2024-07-31 00:34:40] [memory] Reserving 236 MB, device gpu5
[2024-07-31 00:34:41] [memory] Reserving 236 MB, device gpu6
[2024-07-31 00:34:41] [memory] Reserving 236 MB, device gpu7
[2024-07-31 00:34:41] [memory] Reserving 945 MB, device gpu0
[2024-07-31 00:34:41] [memory] Reserving 945 MB, device gpu1
[2024-07-31 00:34:42] [memory] Reserving 945 MB, device gpu2
[2024-07-31 00:34:42] [memory] Reserving 945 MB, device gpu3
[2024-07-31 00:34:42] [memory] Reserving 945 MB, device gpu4
[2024-07-31 00:34:42] [memory] Reserving 945 MB, device gpu5
[2024-07-31 00:34:43] [memory] Reserving 945 MB, device gpu6
[2024-07-31 00:34:43] [memory] Reserving 945 MB, device gpu7
[2024-07-31 00:34:43] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-07-31 00:34:44] [data] Restoring the corpus state to epoch 1, batch 940000
[2024-07-31 17:19:48] Training started
[2024-07-31 17:19:48] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-07-31 17:20:12] [memory] Reserving 945 MB, device gpu0
[2024-07-31 17:20:16] [memory] Reserving 945 MB, device gpu7
[2024-07-31 17:20:16] [memory] Reserving 945 MB, device gpu5
[2024-07-31 17:20:16] [memory] Reserving 945 MB, device gpu6
[2024-07-31 17:20:16] [memory] Reserving 945 MB, device gpu4
[2024-07-31 17:20:16] [memory] Reserving 945 MB, device gpu3
[2024-07-31 17:20:16] [memory] Reserving 945 MB, device gpu1
[2024-07-31 17:20:16] [memory] Reserving 945 MB, device gpu2
[2024-07-31 17:20:18] Parameter type float32, optimization type float32, casting types false
[2024-08-01 01:24:28] Ep. 1 : Up. 950000 : Sen. 7,298,028,003 : Cost 3.10236049 : Time 89408.73s : 30265.95 words/s : gNorm 1.5572
[2024-08-01 01:24:28] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-01 01:24:33] Saving Adam parameters
[2024-08-01 01:24:40] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-01 01:24:54] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-01 01:24:57] [valid] Ep. 1 : Up. 950000 : perplexity : 11.5361 : new best
[2024-08-01 09:28:35] Ep. 1 : Up. 960000 : Sen. 7,374,785,437 : Cost 3.10248089 : Time 29047.62s : 93036.65 words/s : gNorm 1.2357
[2024-08-01 09:28:36] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-01 09:28:40] Saving Adam parameters
[2024-08-01 09:28:48] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-01 09:29:02] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-01 09:29:05] [valid] Ep. 1 : Up. 960000 : perplexity : 11.5305 : new best
[2024-08-01 17:32:59] Ep. 1 : Up. 970000 : Sen. 7,451,581,475 : Cost 3.10125828 : Time 29063.25s : 93104.26 words/s : gNorm 1.7403
[2024-08-01 17:32:59] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-01 17:33:04] Saving Adam parameters
[2024-08-01 17:33:11] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-01 17:33:25] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-01 17:33:28] [valid] Ep. 1 : Up. 970000 : perplexity : 11.5278 : new best
[2024-08-02 01:37:25] Ep. 1 : Up. 980000 : Sen. 7,528,399,694 : Cost 3.10110474 : Time 29066.36s : 92931.70 words/s : gNorm 1.0022
[2024-08-02 01:37:25] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-02 01:37:30] Saving Adam parameters
[2024-08-02 01:37:38] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-02 01:37:52] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-02 01:37:55] [valid] Ep. 1 : Up. 980000 : perplexity : 11.5266 : new best
[2024-08-02 09:42:10] Ep. 1 : Up. 990000 : Sen. 7,605,279,860 : Cost 3.10075617 : Time 29084.46s : 93134.14 words/s : gNorm 1.8542
[2024-08-02 09:42:10] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-02 09:42:15] Saving Adam parameters
[2024-08-02 09:42:23] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-02 09:42:37] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-02 09:42:39] [valid] Ep. 1 : Up. 990000 : perplexity : 11.5256 : new best
[2024-08-02 18:10:33] Ep. 1 : Up. 1000000 : Sen. 7,682,057,479 : Cost 3.10098577 : Time 30503.43s : 88656.96 words/s : gNorm 2.6550
[2024-08-02 18:10:33] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-02 18:10:38] Saving Adam parameters
[2024-08-02 18:10:46] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-02 18:11:00] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-02 18:11:02] [valid] Ep. 1 : Up. 1000000 : perplexity : 11.5215 : new best
[2024-08-03 14:12:45] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-03 14:12:45] [marian] Running on nid005092 as process 94750 with command line:
[2024-08-03 14:12:45] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-08-03 14:12:47] [config] after: 0e
[2024-08-03 14:12:47] [config] after-batches: 0
[2024-08-03 14:12:47] [config] after-epochs: 0
[2024-08-03 14:12:47] [config] all-caps-every: 0
[2024-08-03 14:12:47] [config] allow-unk: true
[2024-08-03 14:12:47] [config] authors: false
[2024-08-03 14:12:47] [config] beam-size: 6
[2024-08-03 14:12:47] [config] bert-class-symbol: "[CLS]"
[2024-08-03 14:12:47] [config] bert-mask-symbol: "[MASK]"
[2024-08-03 14:12:47] [config] bert-masking-fraction: 0.15
[2024-08-03 14:12:47] [config] bert-sep-symbol: "[SEP]"
[2024-08-03 14:12:47] [config] bert-train-type-embeddings: true
[2024-08-03 14:12:47] [config] bert-type-vocab-size: 2
[2024-08-03 14:12:47] [config] build-info: ""
[2024-08-03 14:12:47] [config] char-conv-filters-num:
[2024-08-03 14:12:47] [config]   - 200
[2024-08-03 14:12:47] [config]   - 200
[2024-08-03 14:12:47] [config]   - 250
[2024-08-03 14:12:47] [config]   - 250
[2024-08-03 14:12:47] [config]   - 300
[2024-08-03 14:12:47] [config]   - 300
[2024-08-03 14:12:47] [config]   - 300
[2024-08-03 14:12:47] [config]   - 300
[2024-08-03 14:12:47] [config] char-conv-filters-widths:
[2024-08-03 14:12:47] [config]   - 1
[2024-08-03 14:12:47] [config]   - 2
[2024-08-03 14:12:47] [config]   - 3
[2024-08-03 14:12:47] [config]   - 4
[2024-08-03 14:12:47] [config]   - 5
[2024-08-03 14:12:47] [config]   - 6
[2024-08-03 14:12:47] [config]   - 7
[2024-08-03 14:12:47] [config]   - 8
[2024-08-03 14:12:47] [config] char-highway: 4
[2024-08-03 14:12:47] [config] char-stride: 5
[2024-08-03 14:12:47] [config] check-gradient-nan: false
[2024-08-03 14:12:47] [config] check-nan: false
[2024-08-03 14:12:47] [config] cite: false
[2024-08-03 14:12:47] [config] clip-norm: 0
[2024-08-03 14:12:47] [config] cost-scaling:
[2024-08-03 14:12:47] [config]   []
[2024-08-03 14:12:47] [config] cost-type: ce-mean-words
[2024-08-03 14:12:47] [config] cpu-threads: 0
[2024-08-03 14:12:47] [config] data-threads: 8
[2024-08-03 14:12:47] [config] data-weighting: ""
[2024-08-03 14:12:47] [config] data-weighting-type: sentence
[2024-08-03 14:12:47] [config] dec-cell: gru
[2024-08-03 14:12:47] [config] dec-cell-base-depth: 2
[2024-08-03 14:12:47] [config] dec-cell-high-depth: 1
[2024-08-03 14:12:47] [config] dec-depth: 6
[2024-08-03 14:12:47] [config] devices:
[2024-08-03 14:12:47] [config]   - 0
[2024-08-03 14:12:47] [config]   - 1
[2024-08-03 14:12:47] [config]   - 2
[2024-08-03 14:12:47] [config]   - 3
[2024-08-03 14:12:47] [config]   - 4
[2024-08-03 14:12:47] [config]   - 5
[2024-08-03 14:12:47] [config]   - 6
[2024-08-03 14:12:47] [config]   - 7
[2024-08-03 14:12:47] [config] dim-emb: 1024
[2024-08-03 14:12:47] [config] dim-rnn: 1024
[2024-08-03 14:12:47] [config] dim-vocabs:
[2024-08-03 14:12:47] [config]   - 69666
[2024-08-03 14:12:47] [config]   - 69666
[2024-08-03 14:12:47] [config] disp-first: 10
[2024-08-03 14:12:47] [config] disp-freq: 10000
[2024-08-03 14:12:47] [config] disp-label-counts: true
[2024-08-03 14:12:47] [config] dropout-rnn: 0
[2024-08-03 14:12:47] [config] dropout-src: 0
[2024-08-03 14:12:47] [config] dropout-trg: 0
[2024-08-03 14:12:47] [config] dump-config: ""
[2024-08-03 14:12:47] [config] dynamic-gradient-scaling:
[2024-08-03 14:12:47] [config]   []
[2024-08-03 14:12:47] [config] early-stopping: 20
[2024-08-03 14:12:47] [config] early-stopping-on: first
[2024-08-03 14:12:47] [config] embedding-fix-src: false
[2024-08-03 14:12:47] [config] embedding-fix-trg: false
[2024-08-03 14:12:47] [config] embedding-normalization: false
[2024-08-03 14:12:47] [config] embedding-vectors:
[2024-08-03 14:12:47] [config]   []
[2024-08-03 14:12:47] [config] enc-cell: gru
[2024-08-03 14:12:47] [config] enc-cell-depth: 1
[2024-08-03 14:12:47] [config] enc-depth: 6
[2024-08-03 14:12:47] [config] enc-type: bidirectional
[2024-08-03 14:12:47] [config] english-title-case-every: 0
[2024-08-03 14:12:47] [config] exponential-smoothing: 0.0001
[2024-08-03 14:12:47] [config] factor-weight: 1
[2024-08-03 14:12:47] [config] factors-combine: sum
[2024-08-03 14:12:47] [config] factors-dim-emb: 0
[2024-08-03 14:12:47] [config] gradient-checkpointing: false
[2024-08-03 14:12:47] [config] gradient-norm-average-window: 100
[2024-08-03 14:12:47] [config] guided-alignment: none
[2024-08-03 14:12:47] [config] guided-alignment-cost: ce
[2024-08-03 14:12:47] [config] guided-alignment-weight: 0.1
[2024-08-03 14:12:47] [config] ignore-model-config: false
[2024-08-03 14:12:47] [config] input-types:
[2024-08-03 14:12:47] [config]   []
[2024-08-03 14:12:47] [config] interpolate-env-vars: false
[2024-08-03 14:12:47] [config] keep-best: true
[2024-08-03 14:12:47] [config] label-smoothing: 0.1
[2024-08-03 14:12:47] [config] layer-normalization: false
[2024-08-03 14:12:47] [config] learn-rate: 0.0002
[2024-08-03 14:12:47] [config] lemma-dependency: ""
[2024-08-03 14:12:47] [config] lemma-dim-emb: 0
[2024-08-03 14:12:47] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-08-03 14:12:47] [config] log-level: info
[2024-08-03 14:12:47] [config] log-time-zone: ""
[2024-08-03 14:12:47] [config] logical-epoch:
[2024-08-03 14:12:47] [config]   - 1e
[2024-08-03 14:12:47] [config]   - 0
[2024-08-03 14:12:47] [config] lr-decay: 0
[2024-08-03 14:12:47] [config] lr-decay-freq: 50000
[2024-08-03 14:12:47] [config] lr-decay-inv-sqrt:
[2024-08-03 14:12:47] [config]   - 8000
[2024-08-03 14:12:47] [config] lr-decay-repeat-warmup: false
[2024-08-03 14:12:47] [config] lr-decay-reset-optimizer: false
[2024-08-03 14:12:47] [config] lr-decay-start:
[2024-08-03 14:12:47] [config]   - 10
[2024-08-03 14:12:47] [config]   - 1
[2024-08-03 14:12:47] [config] lr-decay-strategy: epoch+stalled
[2024-08-03 14:12:47] [config] lr-report: false
[2024-08-03 14:12:47] [config] lr-warmup: 8000
[2024-08-03 14:12:47] [config] lr-warmup-at-reload: false
[2024-08-03 14:12:47] [config] lr-warmup-cycle: true
[2024-08-03 14:12:47] [config] lr-warmup-start-rate: 0
[2024-08-03 14:12:47] [config] max-length: 100
[2024-08-03 14:12:47] [config] max-length-crop: false
[2024-08-03 14:12:47] [config] max-length-factor: 3
[2024-08-03 14:12:47] [config] maxi-batch: 1000
[2024-08-03 14:12:47] [config] maxi-batch-sort: trg
[2024-08-03 14:12:47] [config] mini-batch: 1000
[2024-08-03 14:12:47] [config] mini-batch-fit: true
[2024-08-03 14:12:47] [config] mini-batch-fit-step: 10
[2024-08-03 14:12:47] [config] mini-batch-round-up: true
[2024-08-03 14:12:47] [config] mini-batch-track-lr: false
[2024-08-03 14:12:47] [config] mini-batch-warmup: 0
[2024-08-03 14:12:47] [config] mini-batch-words: 0
[2024-08-03 14:12:47] [config] mini-batch-words-ref: 0
[2024-08-03 14:12:47] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-03 14:12:47] [config] multi-loss-type: sum
[2024-08-03 14:12:47] [config] n-best: false
[2024-08-03 14:12:47] [config] no-nccl: false
[2024-08-03 14:12:47] [config] no-reload: false
[2024-08-03 14:12:47] [config] no-restore-corpus: false
[2024-08-03 14:12:47] [config] normalize: 1
[2024-08-03 14:12:47] [config] normalize-gradient: false
[2024-08-03 14:12:47] [config] num-devices: 0
[2024-08-03 14:12:47] [config] optimizer: adam
[2024-08-03 14:12:47] [config] optimizer-delay: 10
[2024-08-03 14:12:47] [config] optimizer-params:
[2024-08-03 14:12:47] [config]   - 0.9
[2024-08-03 14:12:47] [config]   - 0.998
[2024-08-03 14:12:47] [config]   - 1e-09
[2024-08-03 14:12:47] [config] output-omit-bias: false
[2024-08-03 14:12:47] [config] overwrite: true
[2024-08-03 14:12:47] [config] precision:
[2024-08-03 14:12:47] [config]   - float32
[2024-08-03 14:12:47] [config]   - float32
[2024-08-03 14:12:47] [config] pretrained-model: ""
[2024-08-03 14:12:47] [config] quantize-biases: false
[2024-08-03 14:12:47] [config] quantize-bits: 0
[2024-08-03 14:12:47] [config] quantize-log-based: false
[2024-08-03 14:12:47] [config] quantize-optimization-steps: 0
[2024-08-03 14:12:47] [config] quiet: false
[2024-08-03 14:12:47] [config] quiet-translation: false
[2024-08-03 14:12:47] [config] relative-paths: false
[2024-08-03 14:12:47] [config] right-left: false
[2024-08-03 14:12:47] [config] save-freq: 10000
[2024-08-03 14:12:47] [config] seed: 2222
[2024-08-03 14:12:47] [config] sentencepiece-alphas:
[2024-08-03 14:12:47] [config]   []
[2024-08-03 14:12:47] [config] sentencepiece-max-lines: 2000000
[2024-08-03 14:12:47] [config] sentencepiece-options: ""
[2024-08-03 14:12:47] [config] sharding: local
[2024-08-03 14:12:47] [config] shuffle: batches
[2024-08-03 14:12:47] [config] shuffle-in-ram: false
[2024-08-03 14:12:47] [config] sigterm: save-and-exit
[2024-08-03 14:12:47] [config] skip: false
[2024-08-03 14:12:47] [config] sqlite: ""
[2024-08-03 14:12:47] [config] sqlite-drop: false
[2024-08-03 14:12:47] [config] sync-freq: 200u
[2024-08-03 14:12:47] [config] sync-sgd: true
[2024-08-03 14:12:47] [config] tempdir: /scratch/project_462000447/tmp
[2024-08-03 14:12:47] [config] tied-embeddings: false
[2024-08-03 14:12:47] [config] tied-embeddings-all: true
[2024-08-03 14:12:47] [config] tied-embeddings-src: false
[2024-08-03 14:12:47] [config] train-embedder-rank:
[2024-08-03 14:12:47] [config]   []
[2024-08-03 14:12:47] [config] train-sets:
[2024-08-03 14:12:47] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-08-03 14:12:47] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-08-03 14:12:47] [config] transformer-aan-activation: swish
[2024-08-03 14:12:47] [config] transformer-aan-depth: 2
[2024-08-03 14:12:47] [config] transformer-aan-nogate: false
[2024-08-03 14:12:47] [config] transformer-decoder-autoreg: self-attention
[2024-08-03 14:12:47] [config] transformer-decoder-dim-ffn: 0
[2024-08-03 14:12:47] [config] transformer-decoder-ffn-depth: 0
[2024-08-03 14:12:47] [config] transformer-depth-scaling: false
[2024-08-03 14:12:47] [config] transformer-dim-aan: 2048
[2024-08-03 14:12:47] [config] transformer-dim-ffn: 4096
[2024-08-03 14:12:47] [config] transformer-dropout: 0.1
[2024-08-03 14:12:47] [config] transformer-dropout-attention: 0
[2024-08-03 14:12:47] [config] transformer-dropout-ffn: 0
[2024-08-03 14:12:47] [config] transformer-ffn-activation: relu
[2024-08-03 14:12:47] [config] transformer-ffn-depth: 2
[2024-08-03 14:12:47] [config] transformer-guided-alignment-layer: last
[2024-08-03 14:12:47] [config] transformer-heads: 16
[2024-08-03 14:12:47] [config] transformer-no-projection: false
[2024-08-03 14:12:47] [config] transformer-pool: false
[2024-08-03 14:12:47] [config] transformer-postprocess: dan
[2024-08-03 14:12:47] [config] transformer-postprocess-emb: d
[2024-08-03 14:12:47] [config] transformer-postprocess-top: ""
[2024-08-03 14:12:47] [config] transformer-preprocess: ""
[2024-08-03 14:12:47] [config] transformer-rnn-projection: false
[2024-08-03 14:12:47] [config] transformer-tied-layers:
[2024-08-03 14:12:47] [config]   []
[2024-08-03 14:12:47] [config] transformer-train-position-embeddings: false
[2024-08-03 14:12:47] [config] tsv: false
[2024-08-03 14:12:47] [config] tsv-fields: 0
[2024-08-03 14:12:47] [config] type: transformer
[2024-08-03 14:12:47] [config] ulr: false
[2024-08-03 14:12:47] [config] ulr-dim-emb: 0
[2024-08-03 14:12:47] [config] ulr-dropout: 0
[2024-08-03 14:12:47] [config] ulr-keys-vectors: ""
[2024-08-03 14:12:47] [config] ulr-query-vectors: ""
[2024-08-03 14:12:47] [config] ulr-softmax-temperature: 1
[2024-08-03 14:12:47] [config] ulr-trainable-transformation: false
[2024-08-03 14:12:47] [config] unlikelihood-loss: false
[2024-08-03 14:12:47] [config] valid-freq: 10000
[2024-08-03 14:12:47] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-08-03 14:12:47] [config] valid-max-length: 100
[2024-08-03 14:12:47] [config] valid-metrics:
[2024-08-03 14:12:47] [config]   - perplexity
[2024-08-03 14:12:47] [config] valid-mini-batch: 16
[2024-08-03 14:12:47] [config] valid-reset-stalled: false
[2024-08-03 14:12:47] [config] valid-script-args:
[2024-08-03 14:12:47] [config]   []
[2024-08-03 14:12:47] [config] valid-script-path: ""
[2024-08-03 14:12:47] [config] valid-sets:
[2024-08-03 14:12:47] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-08-03 14:12:47] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-08-03 14:12:47] [config] valid-translation-output: ""
[2024-08-03 14:12:47] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-03 14:12:47] [config] vocabs:
[2024-08-03 14:12:47] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-03 14:12:47] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-03 14:12:47] [config] word-penalty: 0
[2024-08-03 14:12:47] [config] word-scores: false
[2024-08-03 14:12:47] [config] workspace: 20000
[2024-08-03 14:12:47] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-03 14:12:47] Using synchronous SGD
[2024-08-03 14:12:47] [comm] Compiled without MPI support. Running as a single process on nid005092
[2024-08-03 14:12:47] Synced seed 2222
[2024-08-03 14:12:47] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-03 14:12:47] [data] Setting vocabulary size for input 0 to 69,666
[2024-08-03 14:12:47] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-03 14:12:48] [data] Setting vocabulary size for input 1 to 69,666
[2024-08-03 14:12:48] [batching] Collecting statistics for batch fitting with step size 10
[2024-08-03 14:12:54] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-08-03 14:12:54] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-08-03 14:12:54] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-08-03 14:12:54] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-08-03 14:12:54] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-08-03 14:12:54] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-08-03 14:12:54] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-08-03 14:12:54] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-08-03 14:12:54] [comm] Using NCCL 3.2.12 for GPU communication
[2024-08-03 14:12:56] [comm] Using global sharding
[2024-08-03 14:12:57] [comm] NCCLCommunicators constructed successfully
[2024-08-03 14:12:57] [training] Using 8 GPUs
[2024-08-03 14:12:57] [logits] Applying loss function for 1 factor(s)
[2024-08-03 14:12:57] [memory] Reserving 945 MB, device gpu0
[2024-08-03 14:13:03] [memory] Reserving 945 MB, device gpu0
[2024-08-03 14:13:36] [batching] Done. Typical MB size is 699,120 target words
[2024-08-03 14:13:36] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-08-03 14:13:36] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-08-03 14:13:36] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-08-03 14:13:36] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-08-03 14:13:36] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-08-03 14:13:36] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-08-03 14:13:36] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-08-03 14:13:36] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-08-03 14:13:36] [comm] Using NCCL 3.2.12 for GPU communication
[2024-08-03 14:13:36] [comm] Using global sharding
[2024-08-03 14:13:37] [comm] NCCLCommunicators constructed successfully
[2024-08-03 14:13:37] [training] Using 8 GPUs
[2024-08-03 14:13:37] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-03 14:13:55] Allocating memory for general optimizer shards
[2024-08-03 14:13:55] [memory] Reserving 118 MB, device gpu0
[2024-08-03 14:13:55] [memory] Reserving 118 MB, device gpu1
[2024-08-03 14:13:55] [memory] Reserving 118 MB, device gpu2
[2024-08-03 14:13:55] [memory] Reserving 118 MB, device gpu3
[2024-08-03 14:13:55] [memory] Reserving 118 MB, device gpu4
[2024-08-03 14:13:55] [memory] Reserving 118 MB, device gpu5
[2024-08-03 14:13:55] [memory] Reserving 118 MB, device gpu6
[2024-08-03 14:13:55] [memory] Reserving 118 MB, device gpu7
[2024-08-03 14:13:55] Loading Adam parameters
[2024-08-03 14:13:57] [memory] Reserving 236 MB, device gpu0
[2024-08-03 14:13:57] [memory] Reserving 236 MB, device gpu1
[2024-08-03 14:13:57] [memory] Reserving 236 MB, device gpu2
[2024-08-03 14:13:57] [memory] Reserving 236 MB, device gpu3
[2024-08-03 14:13:58] [memory] Reserving 236 MB, device gpu4
[2024-08-03 14:13:58] [memory] Reserving 236 MB, device gpu5
[2024-08-03 14:13:58] [memory] Reserving 236 MB, device gpu6
[2024-08-03 14:13:58] [memory] Reserving 236 MB, device gpu7
[2024-08-03 14:13:59] [memory] Reserving 945 MB, device gpu0
[2024-08-03 14:13:59] [memory] Reserving 945 MB, device gpu1
[2024-08-03 14:13:59] [memory] Reserving 945 MB, device gpu2
[2024-08-03 14:13:59] [memory] Reserving 945 MB, device gpu3
[2024-08-03 14:14:00] [memory] Reserving 945 MB, device gpu4
[2024-08-03 14:14:00] [memory] Reserving 945 MB, device gpu5
[2024-08-03 14:14:00] [memory] Reserving 945 MB, device gpu6
[2024-08-03 14:14:00] [memory] Reserving 945 MB, device gpu7
[2024-08-03 14:14:01] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-03 14:14:01] [data] Restoring the corpus state to epoch 1, batch 1000000
[2024-08-04 07:31:07] Training started
[2024-08-04 07:31:07] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-08-04 07:31:09] [memory] Reserving 945 MB, device gpu0
[2024-08-04 07:31:33] [memory] Reserving 945 MB, device gpu4
[2024-08-04 07:31:33] [memory] Reserving 945 MB, device gpu1
[2024-08-04 07:31:33] [memory] Reserving 945 MB, device gpu3
[2024-08-04 07:31:33] [memory] Reserving 945 MB, device gpu5
[2024-08-04 07:31:33] [memory] Reserving 945 MB, device gpu6
[2024-08-04 07:31:33] [memory] Reserving 945 MB, device gpu2
[2024-08-04 07:31:33] [memory] Reserving 945 MB, device gpu7
[2024-08-04 07:31:37] Parameter type float32, optimization type float32, casting types false
[2024-08-04 15:35:48] Ep. 1 : Up. 1010000 : Sen. 7,758,914,779 : Cost 3.10018849 : Time 91331.69s : 29606.03 words/s : gNorm 1.5448
[2024-08-04 15:35:48] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-04 15:35:53] Saving Adam parameters
[2024-08-04 15:36:00] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-04 15:36:14] [valid] Ep. 1 : Up. 1010000 : perplexity : 11.5302 : stalled 1 times (last best: 11.5256)
[2024-08-04 23:40:57] Ep. 1 : Up. 1020000 : Sen. 7,835,761,994 : Cost 3.09960461 : Time 29109.28s : 93039.29 words/s : gNorm 1.4530
[2024-08-04 23:40:57] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-04 23:41:02] Saving Adam parameters
[2024-08-04 23:41:10] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-04 23:41:24] [valid] Ep. 1 : Up. 1020000 : perplexity : 11.533 : stalled 2 times (last best: 11.5256)
[2024-08-05 07:45:52] Ep. 1 : Up. 1030000 : Sen. 7,912,597,996 : Cost 3.09967089 : Time 29094.60s : 92967.82 words/s : gNorm 1.2304
[2024-08-05 07:45:52] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-05 07:45:57] Saving Adam parameters
[2024-08-05 07:46:04] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-05 07:46:18] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-05 07:46:21] [valid] Ep. 1 : Up. 1030000 : perplexity : 11.5244 : new best
[2024-08-05 15:50:28] Ep. 1 : Up. 1040000 : Sen. 7,989,418,022 : Cost 3.09982610 : Time 29076.40s : 93044.90 words/s : gNorm 1.9590
[2024-08-05 15:50:28] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-05 15:50:34] Saving Adam parameters
[2024-08-05 15:50:41] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-05 15:50:55] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-05 15:50:58] [valid] Ep. 1 : Up. 1040000 : perplexity : 11.5234 : new best
[2024-08-05 23:55:16] Ep. 1 : Up. 1050000 : Sen. 8,066,302,643 : Cost 3.09887838 : Time 29087.80s : 93083.85 words/s : gNorm 1.8432
[2024-08-05 23:55:17] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-05 23:55:21] Saving Adam parameters
[2024-08-05 23:55:29] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-05 23:55:43] [valid] Ep. 1 : Up. 1050000 : perplexity : 11.5247 : stalled 1 times (last best: 11.5234)
[2024-08-06 08:00:00] Ep. 1 : Up. 1060000 : Sen. 8,143,151,379 : Cost 3.09853721 : Time 29083.09s : 92998.93 words/s : gNorm 1.3246
[2024-08-06 08:00:00] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-06 08:00:04] Saving Adam parameters
[2024-08-06 08:00:12] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-06 08:00:26] [valid] Ep. 1 : Up. 1060000 : perplexity : 11.5275 : stalled 2 times (last best: 11.5234)
[2024-08-07 14:53:00] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-07 14:53:00] [marian] Running on nid007911 as process 43915 with command line:
[2024-08-07 14:53:00] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-08-07 14:53:02] [config] after: 0e
[2024-08-07 14:53:02] [config] after-batches: 0
[2024-08-07 14:53:02] [config] after-epochs: 0
[2024-08-07 14:53:02] [config] all-caps-every: 0
[2024-08-07 14:53:02] [config] allow-unk: true
[2024-08-07 14:53:02] [config] authors: false
[2024-08-07 14:53:02] [config] beam-size: 6
[2024-08-07 14:53:02] [config] bert-class-symbol: "[CLS]"
[2024-08-07 14:53:02] [config] bert-mask-symbol: "[MASK]"
[2024-08-07 14:53:02] [config] bert-masking-fraction: 0.15
[2024-08-07 14:53:02] [config] bert-sep-symbol: "[SEP]"
[2024-08-07 14:53:02] [config] bert-train-type-embeddings: true
[2024-08-07 14:53:02] [config] bert-type-vocab-size: 2
[2024-08-07 14:53:02] [config] build-info: ""
[2024-08-07 14:53:02] [config] char-conv-filters-num:
[2024-08-07 14:53:02] [config]   - 200
[2024-08-07 14:53:02] [config]   - 200
[2024-08-07 14:53:02] [config]   - 250
[2024-08-07 14:53:02] [config]   - 250
[2024-08-07 14:53:02] [config]   - 300
[2024-08-07 14:53:02] [config]   - 300
[2024-08-07 14:53:02] [config]   - 300
[2024-08-07 14:53:02] [config]   - 300
[2024-08-07 14:53:02] [config] char-conv-filters-widths:
[2024-08-07 14:53:02] [config]   - 1
[2024-08-07 14:53:02] [config]   - 2
[2024-08-07 14:53:02] [config]   - 3
[2024-08-07 14:53:02] [config]   - 4
[2024-08-07 14:53:02] [config]   - 5
[2024-08-07 14:53:02] [config]   - 6
[2024-08-07 14:53:02] [config]   - 7
[2024-08-07 14:53:02] [config]   - 8
[2024-08-07 14:53:02] [config] char-highway: 4
[2024-08-07 14:53:02] [config] char-stride: 5
[2024-08-07 14:53:02] [config] check-gradient-nan: false
[2024-08-07 14:53:02] [config] check-nan: false
[2024-08-07 14:53:02] [config] cite: false
[2024-08-07 14:53:02] [config] clip-norm: 0
[2024-08-07 14:53:02] [config] cost-scaling:
[2024-08-07 14:53:02] [config]   []
[2024-08-07 14:53:02] [config] cost-type: ce-mean-words
[2024-08-07 14:53:02] [config] cpu-threads: 0
[2024-08-07 14:53:02] [config] data-threads: 8
[2024-08-07 14:53:02] [config] data-weighting: ""
[2024-08-07 14:53:02] [config] data-weighting-type: sentence
[2024-08-07 14:53:02] [config] dec-cell: gru
[2024-08-07 14:53:02] [config] dec-cell-base-depth: 2
[2024-08-07 14:53:02] [config] dec-cell-high-depth: 1
[2024-08-07 14:53:02] [config] dec-depth: 6
[2024-08-07 14:53:02] [config] devices:
[2024-08-07 14:53:02] [config]   - 0
[2024-08-07 14:53:02] [config]   - 1
[2024-08-07 14:53:02] [config]   - 2
[2024-08-07 14:53:02] [config]   - 3
[2024-08-07 14:53:02] [config]   - 4
[2024-08-07 14:53:02] [config]   - 5
[2024-08-07 14:53:02] [config]   - 6
[2024-08-07 14:53:02] [config]   - 7
[2024-08-07 14:53:02] [config] dim-emb: 1024
[2024-08-07 14:53:02] [config] dim-rnn: 1024
[2024-08-07 14:53:02] [config] dim-vocabs:
[2024-08-07 14:53:02] [config]   - 69666
[2024-08-07 14:53:02] [config]   - 69666
[2024-08-07 14:53:02] [config] disp-first: 10
[2024-08-07 14:53:02] [config] disp-freq: 10000
[2024-08-07 14:53:02] [config] disp-label-counts: true
[2024-08-07 14:53:02] [config] dropout-rnn: 0
[2024-08-07 14:53:02] [config] dropout-src: 0
[2024-08-07 14:53:02] [config] dropout-trg: 0
[2024-08-07 14:53:02] [config] dump-config: ""
[2024-08-07 14:53:02] [config] dynamic-gradient-scaling:
[2024-08-07 14:53:02] [config]   []
[2024-08-07 14:53:02] [config] early-stopping: 20
[2024-08-07 14:53:02] [config] early-stopping-on: first
[2024-08-07 14:53:02] [config] embedding-fix-src: false
[2024-08-07 14:53:02] [config] embedding-fix-trg: false
[2024-08-07 14:53:02] [config] embedding-normalization: false
[2024-08-07 14:53:02] [config] embedding-vectors:
[2024-08-07 14:53:02] [config]   []
[2024-08-07 14:53:02] [config] enc-cell: gru
[2024-08-07 14:53:02] [config] enc-cell-depth: 1
[2024-08-07 14:53:02] [config] enc-depth: 6
[2024-08-07 14:53:02] [config] enc-type: bidirectional
[2024-08-07 14:53:02] [config] english-title-case-every: 0
[2024-08-07 14:53:02] [config] exponential-smoothing: 0.0001
[2024-08-07 14:53:02] [config] factor-weight: 1
[2024-08-07 14:53:02] [config] factors-combine: sum
[2024-08-07 14:53:02] [config] factors-dim-emb: 0
[2024-08-07 14:53:02] [config] gradient-checkpointing: false
[2024-08-07 14:53:02] [config] gradient-norm-average-window: 100
[2024-08-07 14:53:02] [config] guided-alignment: none
[2024-08-07 14:53:02] [config] guided-alignment-cost: ce
[2024-08-07 14:53:02] [config] guided-alignment-weight: 0.1
[2024-08-07 14:53:02] [config] ignore-model-config: false
[2024-08-07 14:53:02] [config] input-types:
[2024-08-07 14:53:02] [config]   []
[2024-08-07 14:53:02] [config] interpolate-env-vars: false
[2024-08-07 14:53:02] [config] keep-best: true
[2024-08-07 14:53:02] [config] label-smoothing: 0.1
[2024-08-07 14:53:02] [config] layer-normalization: false
[2024-08-07 14:53:02] [config] learn-rate: 0.0002
[2024-08-07 14:53:02] [config] lemma-dependency: ""
[2024-08-07 14:53:02] [config] lemma-dim-emb: 0
[2024-08-07 14:53:02] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-08-07 14:53:02] [config] log-level: info
[2024-08-07 14:53:02] [config] log-time-zone: ""
[2024-08-07 14:53:02] [config] logical-epoch:
[2024-08-07 14:53:02] [config]   - 1e
[2024-08-07 14:53:02] [config]   - 0
[2024-08-07 14:53:02] [config] lr-decay: 0
[2024-08-07 14:53:02] [config] lr-decay-freq: 50000
[2024-08-07 14:53:02] [config] lr-decay-inv-sqrt:
[2024-08-07 14:53:02] [config]   - 8000
[2024-08-07 14:53:02] [config] lr-decay-repeat-warmup: false
[2024-08-07 14:53:02] [config] lr-decay-reset-optimizer: false
[2024-08-07 14:53:02] [config] lr-decay-start:
[2024-08-07 14:53:02] [config]   - 10
[2024-08-07 14:53:02] [config]   - 1
[2024-08-07 14:53:02] [config] lr-decay-strategy: epoch+stalled
[2024-08-07 14:53:02] [config] lr-report: false
[2024-08-07 14:53:02] [config] lr-warmup: 8000
[2024-08-07 14:53:02] [config] lr-warmup-at-reload: false
[2024-08-07 14:53:02] [config] lr-warmup-cycle: true
[2024-08-07 14:53:02] [config] lr-warmup-start-rate: 0
[2024-08-07 14:53:02] [config] max-length: 100
[2024-08-07 14:53:02] [config] max-length-crop: false
[2024-08-07 14:53:02] [config] max-length-factor: 3
[2024-08-07 14:53:02] [config] maxi-batch: 1000
[2024-08-07 14:53:02] [config] maxi-batch-sort: trg
[2024-08-07 14:53:02] [config] mini-batch: 1000
[2024-08-07 14:53:02] [config] mini-batch-fit: true
[2024-08-07 14:53:02] [config] mini-batch-fit-step: 10
[2024-08-07 14:53:02] [config] mini-batch-round-up: true
[2024-08-07 14:53:02] [config] mini-batch-track-lr: false
[2024-08-07 14:53:02] [config] mini-batch-warmup: 0
[2024-08-07 14:53:02] [config] mini-batch-words: 0
[2024-08-07 14:53:02] [config] mini-batch-words-ref: 0
[2024-08-07 14:53:02] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-07 14:53:02] [config] multi-loss-type: sum
[2024-08-07 14:53:02] [config] n-best: false
[2024-08-07 14:53:02] [config] no-nccl: false
[2024-08-07 14:53:02] [config] no-reload: false
[2024-08-07 14:53:02] [config] no-restore-corpus: false
[2024-08-07 14:53:02] [config] normalize: 1
[2024-08-07 14:53:02] [config] normalize-gradient: false
[2024-08-07 14:53:02] [config] num-devices: 0
[2024-08-07 14:53:02] [config] optimizer: adam
[2024-08-07 14:53:02] [config] optimizer-delay: 10
[2024-08-07 14:53:02] [config] optimizer-params:
[2024-08-07 14:53:02] [config]   - 0.9
[2024-08-07 14:53:02] [config]   - 0.998
[2024-08-07 14:53:02] [config]   - 1e-09
[2024-08-07 14:53:02] [config] output-omit-bias: false
[2024-08-07 14:53:02] [config] overwrite: true
[2024-08-07 14:53:02] [config] precision:
[2024-08-07 14:53:02] [config]   - float32
[2024-08-07 14:53:02] [config]   - float32
[2024-08-07 14:53:02] [config] pretrained-model: ""
[2024-08-07 14:53:02] [config] quantize-biases: false
[2024-08-07 14:53:02] [config] quantize-bits: 0
[2024-08-07 14:53:02] [config] quantize-log-based: false
[2024-08-07 14:53:02] [config] quantize-optimization-steps: 0
[2024-08-07 14:53:02] [config] quiet: false
[2024-08-07 14:53:02] [config] quiet-translation: false
[2024-08-07 14:53:02] [config] relative-paths: false
[2024-08-07 14:53:02] [config] right-left: false
[2024-08-07 14:53:02] [config] save-freq: 10000
[2024-08-07 14:53:02] [config] seed: 2222
[2024-08-07 14:53:02] [config] sentencepiece-alphas:
[2024-08-07 14:53:02] [config]   []
[2024-08-07 14:53:02] [config] sentencepiece-max-lines: 2000000
[2024-08-07 14:53:02] [config] sentencepiece-options: ""
[2024-08-07 14:53:02] [config] sharding: local
[2024-08-07 14:53:02] [config] shuffle: batches
[2024-08-07 14:53:02] [config] shuffle-in-ram: false
[2024-08-07 14:53:02] [config] sigterm: save-and-exit
[2024-08-07 14:53:02] [config] skip: false
[2024-08-07 14:53:02] [config] sqlite: ""
[2024-08-07 14:53:02] [config] sqlite-drop: false
[2024-08-07 14:53:02] [config] sync-freq: 200u
[2024-08-07 14:53:02] [config] sync-sgd: true
[2024-08-07 14:53:02] [config] tempdir: /scratch/project_462000447/tmp
[2024-08-07 14:53:02] [config] tied-embeddings: false
[2024-08-07 14:53:02] [config] tied-embeddings-all: true
[2024-08-07 14:53:02] [config] tied-embeddings-src: false
[2024-08-07 14:53:02] [config] train-embedder-rank:
[2024-08-07 14:53:02] [config]   []
[2024-08-07 14:53:02] [config] train-sets:
[2024-08-07 14:53:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-08-07 14:53:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-08-07 14:53:02] [config] transformer-aan-activation: swish
[2024-08-07 14:53:02] [config] transformer-aan-depth: 2
[2024-08-07 14:53:02] [config] transformer-aan-nogate: false
[2024-08-07 14:53:02] [config] transformer-decoder-autoreg: self-attention
[2024-08-07 14:53:02] [config] transformer-decoder-dim-ffn: 0
[2024-08-07 14:53:02] [config] transformer-decoder-ffn-depth: 0
[2024-08-07 14:53:02] [config] transformer-depth-scaling: false
[2024-08-07 14:53:02] [config] transformer-dim-aan: 2048
[2024-08-07 14:53:02] [config] transformer-dim-ffn: 4096
[2024-08-07 14:53:02] [config] transformer-dropout: 0.1
[2024-08-07 14:53:02] [config] transformer-dropout-attention: 0
[2024-08-07 14:53:02] [config] transformer-dropout-ffn: 0
[2024-08-07 14:53:02] [config] transformer-ffn-activation: relu
[2024-08-07 14:53:02] [config] transformer-ffn-depth: 2
[2024-08-07 14:53:02] [config] transformer-guided-alignment-layer: last
[2024-08-07 14:53:02] [config] transformer-heads: 16
[2024-08-07 14:53:02] [config] transformer-no-projection: false
[2024-08-07 14:53:02] [config] transformer-pool: false
[2024-08-07 14:53:02] [config] transformer-postprocess: dan
[2024-08-07 14:53:02] [config] transformer-postprocess-emb: d
[2024-08-07 14:53:02] [config] transformer-postprocess-top: ""
[2024-08-07 14:53:02] [config] transformer-preprocess: ""
[2024-08-07 14:53:02] [config] transformer-rnn-projection: false
[2024-08-07 14:53:02] [config] transformer-tied-layers:
[2024-08-07 14:53:02] [config]   []
[2024-08-07 14:53:02] [config] transformer-train-position-embeddings: false
[2024-08-07 14:53:02] [config] tsv: false
[2024-08-07 14:53:02] [config] tsv-fields: 0
[2024-08-07 14:53:02] [config] type: transformer
[2024-08-07 14:53:02] [config] ulr: false
[2024-08-07 14:53:02] [config] ulr-dim-emb: 0
[2024-08-07 14:53:02] [config] ulr-dropout: 0
[2024-08-07 14:53:02] [config] ulr-keys-vectors: ""
[2024-08-07 14:53:02] [config] ulr-query-vectors: ""
[2024-08-07 14:53:02] [config] ulr-softmax-temperature: 1
[2024-08-07 14:53:02] [config] ulr-trainable-transformation: false
[2024-08-07 14:53:02] [config] unlikelihood-loss: false
[2024-08-07 14:53:02] [config] valid-freq: 10000
[2024-08-07 14:53:02] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-08-07 14:53:02] [config] valid-max-length: 100
[2024-08-07 14:53:02] [config] valid-metrics:
[2024-08-07 14:53:02] [config]   - perplexity
[2024-08-07 14:53:02] [config] valid-mini-batch: 16
[2024-08-07 14:53:02] [config] valid-reset-stalled: false
[2024-08-07 14:53:02] [config] valid-script-args:
[2024-08-07 14:53:02] [config]   []
[2024-08-07 14:53:02] [config] valid-script-path: ""
[2024-08-07 14:53:02] [config] valid-sets:
[2024-08-07 14:53:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-08-07 14:53:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-08-07 14:53:02] [config] valid-translation-output: ""
[2024-08-07 14:53:02] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-07 14:53:02] [config] vocabs:
[2024-08-07 14:53:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-07 14:53:02] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-07 14:53:02] [config] word-penalty: 0
[2024-08-07 14:53:02] [config] word-scores: false
[2024-08-07 14:53:02] [config] workspace: 20000
[2024-08-07 14:53:02] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-07 14:53:02] Using synchronous SGD
[2024-08-07 14:53:02] [comm] Compiled without MPI support. Running as a single process on nid007911
[2024-08-07 14:53:02] Synced seed 2222
[2024-08-07 14:53:02] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-07 14:53:03] [data] Setting vocabulary size for input 0 to 69,666
[2024-08-07 14:53:03] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-07 14:53:03] [data] Setting vocabulary size for input 1 to 69,666
[2024-08-07 14:53:03] [batching] Collecting statistics for batch fitting with step size 10
[2024-08-07 14:53:05] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-08-07 14:53:05] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-08-07 14:53:05] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-08-07 14:53:05] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-08-07 14:53:05] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-08-07 14:53:05] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-08-07 14:53:05] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-08-07 14:53:05] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-08-07 14:53:05] [comm] Using NCCL 3.2.12 for GPU communication
[2024-08-07 14:53:07] [comm] Using global sharding
[2024-08-07 14:53:08] [comm] NCCLCommunicators constructed successfully
[2024-08-07 14:53:08] [training] Using 8 GPUs
[2024-08-07 14:53:08] [logits] Applying loss function for 1 factor(s)
[2024-08-07 14:53:08] [memory] Reserving 945 MB, device gpu0
[2024-08-07 14:53:14] [memory] Reserving 945 MB, device gpu0
[2024-08-07 14:53:47] [batching] Done. Typical MB size is 699,120 target words
[2024-08-07 14:53:48] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-08-07 14:53:48] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-08-07 14:53:48] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-08-07 14:53:48] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-08-07 14:53:48] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-08-07 14:53:48] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-08-07 14:53:48] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-08-07 14:53:48] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-08-07 14:53:48] [comm] Using NCCL 3.2.12 for GPU communication
[2024-08-07 14:53:48] [comm] Using global sharding
[2024-08-07 14:53:48] [comm] NCCLCommunicators constructed successfully
[2024-08-07 14:53:48] [training] Using 8 GPUs
[2024-08-07 14:53:48] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-07 14:54:06] Allocating memory for general optimizer shards
[2024-08-07 14:54:06] [memory] Reserving 118 MB, device gpu0
[2024-08-07 14:54:06] [memory] Reserving 118 MB, device gpu1
[2024-08-07 14:54:06] [memory] Reserving 118 MB, device gpu2
[2024-08-07 14:54:06] [memory] Reserving 118 MB, device gpu3
[2024-08-07 14:54:06] [memory] Reserving 118 MB, device gpu4
[2024-08-07 14:54:06] [memory] Reserving 118 MB, device gpu5
[2024-08-07 14:54:06] [memory] Reserving 118 MB, device gpu6
[2024-08-07 14:54:06] [memory] Reserving 118 MB, device gpu7
[2024-08-07 14:54:06] Loading Adam parameters
[2024-08-07 14:54:08] [memory] Reserving 236 MB, device gpu0
[2024-08-07 14:54:08] [memory] Reserving 236 MB, device gpu1
[2024-08-07 14:54:08] [memory] Reserving 236 MB, device gpu2
[2024-08-07 14:54:09] [memory] Reserving 236 MB, device gpu3
[2024-08-07 14:54:09] [memory] Reserving 236 MB, device gpu4
[2024-08-07 14:54:09] [memory] Reserving 236 MB, device gpu5
[2024-08-07 14:54:09] [memory] Reserving 236 MB, device gpu6
[2024-08-07 14:54:09] [memory] Reserving 236 MB, device gpu7
[2024-08-07 14:54:09] [memory] Reserving 945 MB, device gpu0
[2024-08-07 14:54:10] [memory] Reserving 945 MB, device gpu1
[2024-08-07 14:54:10] [memory] Reserving 945 MB, device gpu2
[2024-08-07 14:54:10] [memory] Reserving 945 MB, device gpu3
[2024-08-07 14:54:10] [memory] Reserving 945 MB, device gpu4
[2024-08-07 14:54:10] [memory] Reserving 945 MB, device gpu5
[2024-08-07 14:54:11] [memory] Reserving 945 MB, device gpu6
[2024-08-07 14:54:11] [memory] Reserving 945 MB, device gpu7
[2024-08-07 14:54:11] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-07 14:54:11] [data] Restoring the corpus state to epoch 1, batch 1060000
[2024-08-08 09:05:46] Training started
[2024-08-08 09:05:46] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-08-08 09:06:01] [memory] Reserving 945 MB, device gpu0
[2024-08-08 09:06:11] [memory] Reserving 945 MB, device gpu5
[2024-08-08 09:06:11] [memory] Reserving 945 MB, device gpu2
[2024-08-08 09:06:11] [memory] Reserving 945 MB, device gpu6
[2024-08-08 09:06:11] [memory] Reserving 945 MB, device gpu7
[2024-08-08 09:06:11] [memory] Reserving 945 MB, device gpu4
[2024-08-08 09:06:11] [memory] Reserving 945 MB, device gpu3
[2024-08-08 09:06:11] [memory] Reserving 945 MB, device gpu1
[2024-08-08 09:06:15] Parameter type float32, optimization type float32, casting types false
[2024-08-08 17:12:49] Ep. 1 : Up. 1070000 : Sen. 8,220,000,747 : Cost 3.09850931 : Time 94741.41s : 28574.58 words/s : gNorm 1.3784
[2024-08-08 17:12:49] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-08 17:12:54] Saving Adam parameters
[2024-08-08 17:13:02] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-08 17:13:16] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-08 17:13:18] [valid] Ep. 1 : Up. 1070000 : perplexity : 11.5115 : new best
[2024-08-09 01:20:04] Ep. 1 : Up. 1080000 : Sen. 8,296,779,693 : Cost 3.09886503 : Time 29234.48s : 92486.06 words/s : gNorm 1.9305
[2024-08-09 01:20:04] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-09 01:20:09] Saving Adam parameters
[2024-08-09 01:20:16] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-09 01:20:30] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-09 01:20:33] [valid] Ep. 1 : Up. 1080000 : perplexity : 11.5092 : new best
[2024-08-09 09:27:01] Ep. 1 : Up. 1090000 : Sen. 8,373,550,810 : Cost 3.09762025 : Time 29216.92s : 92532.56 words/s : gNorm 1.4267
[2024-08-09 09:27:01] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-09 09:27:06] Saving Adam parameters
[2024-08-09 09:27:14] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-09 09:27:27] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-09 09:27:30] [valid] Ep. 1 : Up. 1090000 : perplexity : 11.5039 : new best
[2024-08-09 17:34:20] Ep. 1 : Up. 1100000 : Sen. 8,450,477,702 : Cost 3.09730887 : Time 29239.19s : 92610.67 words/s : gNorm 0.9906
[2024-08-09 17:34:20] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-09 17:34:25] Saving Adam parameters
[2024-08-09 17:34:33] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-09 17:34:47] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-09 17:34:49] [valid] Ep. 1 : Up. 1100000 : perplexity : 11.5029 : new best
[2024-08-10 01:41:28] Ep. 1 : Up. 1110000 : Sen. 8,527,288,877 : Cost 3.09714890 : Time 29228.40s : 92550.88 words/s : gNorm 1.2544
[2024-08-10 01:41:29] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-10 01:41:33] Saving Adam parameters
[2024-08-10 01:41:41] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-10 01:41:55] [valid] Ep. 1 : Up. 1110000 : perplexity : 11.5071 : stalled 1 times (last best: 11.5029)
[2024-08-10 09:48:26] Ep. 1 : Up. 1120000 : Sen. 8,604,177,673 : Cost 3.09753847 : Time 29217.09s : 92650.16 words/s : gNorm 1.3560
[2024-08-10 09:48:26] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-10 09:48:31] Saving Adam parameters
[2024-08-10 09:48:38] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-10 09:48:52] [valid] Ep. 1 : Up. 1120000 : perplexity : 11.5036 : stalled 2 times (last best: 11.5029)
[2024-08-10 16:18:37] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-10 16:18:37] [marian] Running on nid005048 as process 77046 with command line:
[2024-08-10 16:18:37] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-08-10 16:18:39] [config] after: 0e
[2024-08-10 16:18:39] [config] after-batches: 0
[2024-08-10 16:18:39] [config] after-epochs: 0
[2024-08-10 16:18:39] [config] all-caps-every: 0
[2024-08-10 16:18:39] [config] allow-unk: true
[2024-08-10 16:18:39] [config] authors: false
[2024-08-10 16:18:39] [config] beam-size: 6
[2024-08-10 16:18:39] [config] bert-class-symbol: "[CLS]"
[2024-08-10 16:18:39] [config] bert-mask-symbol: "[MASK]"
[2024-08-10 16:18:39] [config] bert-masking-fraction: 0.15
[2024-08-10 16:18:39] [config] bert-sep-symbol: "[SEP]"
[2024-08-10 16:18:39] [config] bert-train-type-embeddings: true
[2024-08-10 16:18:39] [config] bert-type-vocab-size: 2
[2024-08-10 16:18:39] [config] build-info: ""
[2024-08-10 16:18:39] [config] char-conv-filters-num:
[2024-08-10 16:18:39] [config]   - 200
[2024-08-10 16:18:39] [config]   - 200
[2024-08-10 16:18:39] [config]   - 250
[2024-08-10 16:18:39] [config]   - 250
[2024-08-10 16:18:39] [config]   - 300
[2024-08-10 16:18:39] [config]   - 300
[2024-08-10 16:18:39] [config]   - 300
[2024-08-10 16:18:39] [config]   - 300
[2024-08-10 16:18:39] [config] char-conv-filters-widths:
[2024-08-10 16:18:39] [config]   - 1
[2024-08-10 16:18:39] [config]   - 2
[2024-08-10 16:18:39] [config]   - 3
[2024-08-10 16:18:39] [config]   - 4
[2024-08-10 16:18:39] [config]   - 5
[2024-08-10 16:18:39] [config]   - 6
[2024-08-10 16:18:39] [config]   - 7
[2024-08-10 16:18:39] [config]   - 8
[2024-08-10 16:18:39] [config] char-highway: 4
[2024-08-10 16:18:39] [config] char-stride: 5
[2024-08-10 16:18:39] [config] check-gradient-nan: false
[2024-08-10 16:18:39] [config] check-nan: false
[2024-08-10 16:18:39] [config] cite: false
[2024-08-10 16:18:39] [config] clip-norm: 0
[2024-08-10 16:18:39] [config] cost-scaling:
[2024-08-10 16:18:39] [config]   []
[2024-08-10 16:18:39] [config] cost-type: ce-mean-words
[2024-08-10 16:18:39] [config] cpu-threads: 0
[2024-08-10 16:18:39] [config] data-threads: 8
[2024-08-10 16:18:39] [config] data-weighting: ""
[2024-08-10 16:18:39] [config] data-weighting-type: sentence
[2024-08-10 16:18:39] [config] dec-cell: gru
[2024-08-10 16:18:39] [config] dec-cell-base-depth: 2
[2024-08-10 16:18:39] [config] dec-cell-high-depth: 1
[2024-08-10 16:18:39] [config] dec-depth: 6
[2024-08-10 16:18:39] [config] devices:
[2024-08-10 16:18:39] [config]   - 0
[2024-08-10 16:18:39] [config]   - 1
[2024-08-10 16:18:39] [config]   - 2
[2024-08-10 16:18:39] [config]   - 3
[2024-08-10 16:18:39] [config]   - 4
[2024-08-10 16:18:39] [config]   - 5
[2024-08-10 16:18:39] [config]   - 6
[2024-08-10 16:18:39] [config]   - 7
[2024-08-10 16:18:39] [config] dim-emb: 1024
[2024-08-10 16:18:39] [config] dim-rnn: 1024
[2024-08-10 16:18:39] [config] dim-vocabs:
[2024-08-10 16:18:39] [config]   - 69666
[2024-08-10 16:18:39] [config]   - 69666
[2024-08-10 16:18:39] [config] disp-first: 10
[2024-08-10 16:18:39] [config] disp-freq: 10000
[2024-08-10 16:18:39] [config] disp-label-counts: true
[2024-08-10 16:18:39] [config] dropout-rnn: 0
[2024-08-10 16:18:39] [config] dropout-src: 0
[2024-08-10 16:18:39] [config] dropout-trg: 0
[2024-08-10 16:18:39] [config] dump-config: ""
[2024-08-10 16:18:39] [config] dynamic-gradient-scaling:
[2024-08-10 16:18:39] [config]   []
[2024-08-10 16:18:39] [config] early-stopping: 20
[2024-08-10 16:18:39] [config] early-stopping-on: first
[2024-08-10 16:18:39] [config] embedding-fix-src: false
[2024-08-10 16:18:39] [config] embedding-fix-trg: false
[2024-08-10 16:18:39] [config] embedding-normalization: false
[2024-08-10 16:18:39] [config] embedding-vectors:
[2024-08-10 16:18:39] [config]   []
[2024-08-10 16:18:39] [config] enc-cell: gru
[2024-08-10 16:18:39] [config] enc-cell-depth: 1
[2024-08-10 16:18:39] [config] enc-depth: 6
[2024-08-10 16:18:39] [config] enc-type: bidirectional
[2024-08-10 16:18:39] [config] english-title-case-every: 0
[2024-08-10 16:18:39] [config] exponential-smoothing: 0.0001
[2024-08-10 16:18:39] [config] factor-weight: 1
[2024-08-10 16:18:39] [config] factors-combine: sum
[2024-08-10 16:18:39] [config] factors-dim-emb: 0
[2024-08-10 16:18:39] [config] gradient-checkpointing: false
[2024-08-10 16:18:39] [config] gradient-norm-average-window: 100
[2024-08-10 16:18:39] [config] guided-alignment: none
[2024-08-10 16:18:39] [config] guided-alignment-cost: ce
[2024-08-10 16:18:39] [config] guided-alignment-weight: 0.1
[2024-08-10 16:18:39] [config] ignore-model-config: false
[2024-08-10 16:18:39] [config] input-types:
[2024-08-10 16:18:39] [config]   []
[2024-08-10 16:18:39] [config] interpolate-env-vars: false
[2024-08-10 16:18:39] [config] keep-best: true
[2024-08-10 16:18:39] [config] label-smoothing: 0.1
[2024-08-10 16:18:39] [config] layer-normalization: false
[2024-08-10 16:18:39] [config] learn-rate: 0.0002
[2024-08-10 16:18:39] [config] lemma-dependency: ""
[2024-08-10 16:18:39] [config] lemma-dim-emb: 0
[2024-08-10 16:18:39] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-08-10 16:18:39] [config] log-level: info
[2024-08-10 16:18:39] [config] log-time-zone: ""
[2024-08-10 16:18:39] [config] logical-epoch:
[2024-08-10 16:18:39] [config]   - 1e
[2024-08-10 16:18:39] [config]   - 0
[2024-08-10 16:18:39] [config] lr-decay: 0
[2024-08-10 16:18:39] [config] lr-decay-freq: 50000
[2024-08-10 16:18:39] [config] lr-decay-inv-sqrt:
[2024-08-10 16:18:39] [config]   - 8000
[2024-08-10 16:18:39] [config] lr-decay-repeat-warmup: false
[2024-08-10 16:18:39] [config] lr-decay-reset-optimizer: false
[2024-08-10 16:18:39] [config] lr-decay-start:
[2024-08-10 16:18:39] [config]   - 10
[2024-08-10 16:18:39] [config]   - 1
[2024-08-10 16:18:39] [config] lr-decay-strategy: epoch+stalled
[2024-08-10 16:18:39] [config] lr-report: false
[2024-08-10 16:18:39] [config] lr-warmup: 8000
[2024-08-10 16:18:39] [config] lr-warmup-at-reload: false
[2024-08-10 16:18:39] [config] lr-warmup-cycle: true
[2024-08-10 16:18:39] [config] lr-warmup-start-rate: 0
[2024-08-10 16:18:39] [config] max-length: 100
[2024-08-10 16:18:39] [config] max-length-crop: false
[2024-08-10 16:18:39] [config] max-length-factor: 3
[2024-08-10 16:18:39] [config] maxi-batch: 1000
[2024-08-10 16:18:39] [config] maxi-batch-sort: trg
[2024-08-10 16:18:39] [config] mini-batch: 1000
[2024-08-10 16:18:39] [config] mini-batch-fit: true
[2024-08-10 16:18:39] [config] mini-batch-fit-step: 10
[2024-08-10 16:18:39] [config] mini-batch-round-up: true
[2024-08-10 16:18:39] [config] mini-batch-track-lr: false
[2024-08-10 16:18:39] [config] mini-batch-warmup: 0
[2024-08-10 16:18:39] [config] mini-batch-words: 0
[2024-08-10 16:18:39] [config] mini-batch-words-ref: 0
[2024-08-10 16:18:39] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-10 16:18:39] [config] multi-loss-type: sum
[2024-08-10 16:18:39] [config] n-best: false
[2024-08-10 16:18:39] [config] no-nccl: false
[2024-08-10 16:18:39] [config] no-reload: false
[2024-08-10 16:18:39] [config] no-restore-corpus: false
[2024-08-10 16:18:39] [config] normalize: 1
[2024-08-10 16:18:39] [config] normalize-gradient: false
[2024-08-10 16:18:39] [config] num-devices: 0
[2024-08-10 16:18:39] [config] optimizer: adam
[2024-08-10 16:18:39] [config] optimizer-delay: 10
[2024-08-10 16:18:39] [config] optimizer-params:
[2024-08-10 16:18:39] [config]   - 0.9
[2024-08-10 16:18:39] [config]   - 0.998
[2024-08-10 16:18:39] [config]   - 1e-09
[2024-08-10 16:18:39] [config] output-omit-bias: false
[2024-08-10 16:18:39] [config] overwrite: true
[2024-08-10 16:18:39] [config] precision:
[2024-08-10 16:18:39] [config]   - float32
[2024-08-10 16:18:39] [config]   - float32
[2024-08-10 16:18:39] [config] pretrained-model: ""
[2024-08-10 16:18:39] [config] quantize-biases: false
[2024-08-10 16:18:39] [config] quantize-bits: 0
[2024-08-10 16:18:39] [config] quantize-log-based: false
[2024-08-10 16:18:39] [config] quantize-optimization-steps: 0
[2024-08-10 16:18:39] [config] quiet: false
[2024-08-10 16:18:39] [config] quiet-translation: false
[2024-08-10 16:18:39] [config] relative-paths: false
[2024-08-10 16:18:39] [config] right-left: false
[2024-08-10 16:18:39] [config] save-freq: 10000
[2024-08-10 16:18:39] [config] seed: 2222
[2024-08-10 16:18:39] [config] sentencepiece-alphas:
[2024-08-10 16:18:39] [config]   []
[2024-08-10 16:18:39] [config] sentencepiece-max-lines: 2000000
[2024-08-10 16:18:39] [config] sentencepiece-options: ""
[2024-08-10 16:18:39] [config] sharding: local
[2024-08-10 16:18:39] [config] shuffle: batches
[2024-08-10 16:18:39] [config] shuffle-in-ram: false
[2024-08-10 16:18:39] [config] sigterm: save-and-exit
[2024-08-10 16:18:39] [config] skip: false
[2024-08-10 16:18:39] [config] sqlite: ""
[2024-08-10 16:18:39] [config] sqlite-drop: false
[2024-08-10 16:18:39] [config] sync-freq: 200u
[2024-08-10 16:18:39] [config] sync-sgd: true
[2024-08-10 16:18:39] [config] tempdir: /scratch/project_462000447/tmp
[2024-08-10 16:18:39] [config] tied-embeddings: false
[2024-08-10 16:18:39] [config] tied-embeddings-all: true
[2024-08-10 16:18:39] [config] tied-embeddings-src: false
[2024-08-10 16:18:39] [config] train-embedder-rank:
[2024-08-10 16:18:39] [config]   []
[2024-08-10 16:18:39] [config] train-sets:
[2024-08-10 16:18:39] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-08-10 16:18:39] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-08-10 16:18:39] [config] transformer-aan-activation: swish
[2024-08-10 16:18:39] [config] transformer-aan-depth: 2
[2024-08-10 16:18:39] [config] transformer-aan-nogate: false
[2024-08-10 16:18:39] [config] transformer-decoder-autoreg: self-attention
[2024-08-10 16:18:39] [config] transformer-decoder-dim-ffn: 0
[2024-08-10 16:18:39] [config] transformer-decoder-ffn-depth: 0
[2024-08-10 16:18:39] [config] transformer-depth-scaling: false
[2024-08-10 16:18:39] [config] transformer-dim-aan: 2048
[2024-08-10 16:18:39] [config] transformer-dim-ffn: 4096
[2024-08-10 16:18:39] [config] transformer-dropout: 0.1
[2024-08-10 16:18:39] [config] transformer-dropout-attention: 0
[2024-08-10 16:18:39] [config] transformer-dropout-ffn: 0
[2024-08-10 16:18:39] [config] transformer-ffn-activation: relu
[2024-08-10 16:18:39] [config] transformer-ffn-depth: 2
[2024-08-10 16:18:39] [config] transformer-guided-alignment-layer: last
[2024-08-10 16:18:39] [config] transformer-heads: 16
[2024-08-10 16:18:39] [config] transformer-no-projection: false
[2024-08-10 16:18:39] [config] transformer-pool: false
[2024-08-10 16:18:39] [config] transformer-postprocess: dan
[2024-08-10 16:18:39] [config] transformer-postprocess-emb: d
[2024-08-10 16:18:39] [config] transformer-postprocess-top: ""
[2024-08-10 16:18:39] [config] transformer-preprocess: ""
[2024-08-10 16:18:39] [config] transformer-rnn-projection: false
[2024-08-10 16:18:39] [config] transformer-tied-layers:
[2024-08-10 16:18:39] [config]   []
[2024-08-10 16:18:39] [config] transformer-train-position-embeddings: false
[2024-08-10 16:18:39] [config] tsv: false
[2024-08-10 16:18:39] [config] tsv-fields: 0
[2024-08-10 16:18:39] [config] type: transformer
[2024-08-10 16:18:39] [config] ulr: false
[2024-08-10 16:18:39] [config] ulr-dim-emb: 0
[2024-08-10 16:18:39] [config] ulr-dropout: 0
[2024-08-10 16:18:39] [config] ulr-keys-vectors: ""
[2024-08-10 16:18:39] [config] ulr-query-vectors: ""
[2024-08-10 16:18:39] [config] ulr-softmax-temperature: 1
[2024-08-10 16:18:39] [config] ulr-trainable-transformation: false
[2024-08-10 16:18:39] [config] unlikelihood-loss: false
[2024-08-10 16:18:39] [config] valid-freq: 10000
[2024-08-10 16:18:39] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-08-10 16:18:39] [config] valid-max-length: 100
[2024-08-10 16:18:39] [config] valid-metrics:
[2024-08-10 16:18:39] [config]   - perplexity
[2024-08-10 16:18:39] [config] valid-mini-batch: 16
[2024-08-10 16:18:39] [config] valid-reset-stalled: false
[2024-08-10 16:18:39] [config] valid-script-args:
[2024-08-10 16:18:39] [config]   []
[2024-08-10 16:18:39] [config] valid-script-path: ""
[2024-08-10 16:18:39] [config] valid-sets:
[2024-08-10 16:18:39] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-08-10 16:18:39] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-08-10 16:18:39] [config] valid-translation-output: ""
[2024-08-10 16:18:39] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-10 16:18:39] [config] vocabs:
[2024-08-10 16:18:39] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-10 16:18:39] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-10 16:18:39] [config] word-penalty: 0
[2024-08-10 16:18:39] [config] word-scores: false
[2024-08-10 16:18:39] [config] workspace: 20000
[2024-08-10 16:18:39] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-10 16:18:39] Using synchronous SGD
[2024-08-10 16:18:39] [comm] Compiled without MPI support. Running as a single process on nid005048
[2024-08-10 16:18:39] Synced seed 2222
[2024-08-10 16:18:39] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-10 16:18:39] [data] Setting vocabulary size for input 0 to 69,666
[2024-08-10 16:18:39] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-10 16:18:40] [data] Setting vocabulary size for input 1 to 69,666
[2024-08-10 16:18:40] [batching] Collecting statistics for batch fitting with step size 10
[2024-08-10 16:18:41] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-08-10 16:18:41] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-08-10 16:18:41] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-08-10 16:18:41] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-08-10 16:18:41] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-08-10 16:18:41] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-08-10 16:18:41] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-08-10 16:18:41] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-08-10 16:18:41] [comm] Using NCCL 3.2.12 for GPU communication
[2024-08-10 16:18:43] [comm] Using global sharding
[2024-08-10 16:18:44] [comm] NCCLCommunicators constructed successfully
[2024-08-10 16:18:44] [training] Using 8 GPUs
[2024-08-10 16:18:44] [logits] Applying loss function for 1 factor(s)
[2024-08-10 16:18:44] [memory] Reserving 945 MB, device gpu0
[2024-08-10 16:18:49] [memory] Reserving 945 MB, device gpu0
[2024-08-10 16:19:23] [batching] Done. Typical MB size is 699,120 target words
[2024-08-10 16:19:23] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-08-10 16:19:23] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-08-10 16:19:23] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-08-10 16:19:23] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-08-10 16:19:23] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-08-10 16:19:23] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-08-10 16:19:23] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-08-10 16:19:23] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-08-10 16:19:23] [comm] Using NCCL 3.2.12 for GPU communication
[2024-08-10 16:19:23] [comm] Using global sharding
[2024-08-10 16:19:24] [comm] NCCLCommunicators constructed successfully
[2024-08-10 16:19:24] [training] Using 8 GPUs
[2024-08-10 16:19:24] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-10 16:19:42] Allocating memory for general optimizer shards
[2024-08-10 16:19:42] [memory] Reserving 118 MB, device gpu0
[2024-08-10 16:19:42] [memory] Reserving 118 MB, device gpu1
[2024-08-10 16:19:42] [memory] Reserving 118 MB, device gpu2
[2024-08-10 16:19:42] [memory] Reserving 118 MB, device gpu3
[2024-08-10 16:19:42] [memory] Reserving 118 MB, device gpu4
[2024-08-10 16:19:42] [memory] Reserving 118 MB, device gpu5
[2024-08-10 16:19:42] [memory] Reserving 118 MB, device gpu6
[2024-08-10 16:19:42] [memory] Reserving 118 MB, device gpu7
[2024-08-10 16:19:42] Loading Adam parameters
[2024-08-10 16:19:44] [memory] Reserving 236 MB, device gpu0
[2024-08-10 16:19:44] [memory] Reserving 236 MB, device gpu1
[2024-08-10 16:19:44] [memory] Reserving 236 MB, device gpu2
[2024-08-10 16:19:44] [memory] Reserving 236 MB, device gpu3
[2024-08-10 16:19:45] [memory] Reserving 236 MB, device gpu4
[2024-08-10 16:19:45] [memory] Reserving 236 MB, device gpu5
[2024-08-10 16:19:45] [memory] Reserving 236 MB, device gpu6
[2024-08-10 16:19:45] [memory] Reserving 236 MB, device gpu7
[2024-08-10 16:19:45] [memory] Reserving 945 MB, device gpu0
[2024-08-10 16:19:46] [memory] Reserving 945 MB, device gpu1
[2024-08-10 16:19:46] [memory] Reserving 945 MB, device gpu2
[2024-08-10 16:19:46] [memory] Reserving 945 MB, device gpu3
[2024-08-10 16:19:47] [memory] Reserving 945 MB, device gpu4
[2024-08-10 16:19:47] [memory] Reserving 945 MB, device gpu5
[2024-08-10 16:19:47] [memory] Reserving 945 MB, device gpu6
[2024-08-10 16:19:47] [memory] Reserving 945 MB, device gpu7
[2024-08-10 16:19:48] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-10 16:19:48] [data] Restoring the corpus state to epoch 1, batch 1120000
[2024-08-11 11:46:57] Training started
[2024-08-11 11:47:04] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-08-11 11:47:12] [memory] Reserving 945 MB, device gpu0
[2024-08-11 11:47:26] [memory] Reserving 945 MB, device gpu7
[2024-08-11 11:47:29] [memory] Reserving 945 MB, device gpu2
[2024-08-11 11:47:29] [memory] Reserving 945 MB, device gpu1
[2024-08-11 11:47:29] [memory] Reserving 945 MB, device gpu3
[2024-08-11 11:47:29] [memory] Reserving 945 MB, device gpu4
[2024-08-11 11:47:29] [memory] Reserving 945 MB, device gpu5
[2024-08-11 11:47:29] [memory] Reserving 945 MB, device gpu6
[2024-08-11 11:47:31] Parameter type float32, optimization type float32, casting types false
[2024-08-11 19:48:37] Ep. 1 : Up. 1130000 : Sen. 8,681,032,435 : Cost 3.09650517 : Time 98953.65s : 27344.55 words/s : gNorm 1.4372
[2024-08-11 19:48:37] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-11 19:48:41] Saving Adam parameters
[2024-08-11 19:48:49] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-11 19:49:03] [valid] Ep. 1 : Up. 1130000 : perplexity : 11.5045 : stalled 2 times (last best: 11.5029)
[2024-08-12 03:50:46] Ep. 1 : Up. 1140000 : Sen. 8,757,907,732 : Cost 3.09618306 : Time 28928.97s : 93564.73 words/s : gNorm 1.3144
[2024-08-12 03:50:46] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-12 03:50:51] Saving Adam parameters
[2024-08-12 03:50:59] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-12 03:51:12] [valid] Ep. 1 : Up. 1140000 : perplexity : 11.5032 : stalled 3 times (last best: 11.5029)
[2024-08-12 11:52:19] Ep. 1 : Up. 1150000 : Sen. 8,834,642,611 : Cost 3.09606481 : Time 28893.55s : 93536.06 words/s : gNorm 1.4225
[2024-08-12 11:52:19] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-12 11:52:24] Saving Adam parameters
[2024-08-12 11:52:32] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-12 11:52:47] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-12 11:52:50] [valid] Ep. 1 : Up. 1150000 : perplexity : 11.4989 : new best
[2024-08-12 19:54:53] Ep. 1 : Up. 1160000 : Sen. 8,911,535,571 : Cost 3.09629917 : Time 28953.52s : 93502.27 words/s : gNorm 1.1174
[2024-08-12 19:54:53] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-12 19:54:58] Saving Adam parameters
[2024-08-12 19:55:06] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-12 19:55:20] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-12 19:55:22] [valid] Ep. 1 : Up. 1160000 : perplexity : 11.4963 : new best
[2024-08-13 03:56:42] Ep. 1 : Up. 1170000 : Sen. 8,988,365,624 : Cost 3.09544134 : Time 28908.75s : 93600.04 words/s : gNorm 1.5183
[2024-08-13 03:56:42] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-13 03:56:47] Saving Adam parameters
[2024-08-13 03:56:55] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-13 03:57:09] [valid] Ep. 1 : Up. 1170000 : perplexity : 11.5071 : stalled 1 times (last best: 11.4963)
[2024-08-13 11:59:10] Ep. 1 : Up. 1180000 : Sen. 9,065,180,058 : Cost 3.09504533 : Time 28948.32s : 93406.51 words/s : gNorm 1.0517
[2024-08-13 11:59:10] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-13 11:59:15] Saving Adam parameters
[2024-08-13 11:59:23] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-13 11:59:37] [valid] Ep. 1 : Up. 1180000 : perplexity : 11.4989 : stalled 2 times (last best: 11.4963)
[2024-08-14 04:53:58] [marian] Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-14 04:53:58] [marian] Running on nid005031 as process 111075 with command line:
[2024-08-14 04:53:58] [marian] /users/tiedeman/.local/bin/marian --task transformer-big --optimizer-delay 10 --lr-warmup-cycle --early-stopping 20 --valid-freq 10000 --valid-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k --valid-metrics perplexity --valid-mini-batch 16 --valid-max-length 100 --valid-log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log --beam-size 6 --normalize 1 --allow-unk --workspace 20000 --model /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz --train-sets /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz --vocabs /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml --save-freq 10000 --disp-freq 10000 --log /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log --devices 0 1 2 3 4 5 6 7 --seed 2222 --tempdir /scratch/project_462000447/tmp --shuffle batches --sharding local --overwrite --disp-first 10 --disp-label-counts --keep-best
[2024-08-14 04:53:59] [config] after: 0e
[2024-08-14 04:53:59] [config] after-batches: 0
[2024-08-14 04:53:59] [config] after-epochs: 0
[2024-08-14 04:53:59] [config] all-caps-every: 0
[2024-08-14 04:53:59] [config] allow-unk: true
[2024-08-14 04:53:59] [config] authors: false
[2024-08-14 04:53:59] [config] beam-size: 6
[2024-08-14 04:53:59] [config] bert-class-symbol: "[CLS]"
[2024-08-14 04:53:59] [config] bert-mask-symbol: "[MASK]"
[2024-08-14 04:53:59] [config] bert-masking-fraction: 0.15
[2024-08-14 04:53:59] [config] bert-sep-symbol: "[SEP]"
[2024-08-14 04:53:59] [config] bert-train-type-embeddings: true
[2024-08-14 04:53:59] [config] bert-type-vocab-size: 2
[2024-08-14 04:53:59] [config] build-info: ""
[2024-08-14 04:53:59] [config] char-conv-filters-num:
[2024-08-14 04:53:59] [config]   - 200
[2024-08-14 04:53:59] [config]   - 200
[2024-08-14 04:53:59] [config]   - 250
[2024-08-14 04:53:59] [config]   - 250
[2024-08-14 04:53:59] [config]   - 300
[2024-08-14 04:53:59] [config]   - 300
[2024-08-14 04:53:59] [config]   - 300
[2024-08-14 04:53:59] [config]   - 300
[2024-08-14 04:53:59] [config] char-conv-filters-widths:
[2024-08-14 04:53:59] [config]   - 1
[2024-08-14 04:53:59] [config]   - 2
[2024-08-14 04:53:59] [config]   - 3
[2024-08-14 04:53:59] [config]   - 4
[2024-08-14 04:53:59] [config]   - 5
[2024-08-14 04:53:59] [config]   - 6
[2024-08-14 04:53:59] [config]   - 7
[2024-08-14 04:53:59] [config]   - 8
[2024-08-14 04:53:59] [config] char-highway: 4
[2024-08-14 04:53:59] [config] char-stride: 5
[2024-08-14 04:53:59] [config] check-gradient-nan: false
[2024-08-14 04:53:59] [config] check-nan: false
[2024-08-14 04:53:59] [config] cite: false
[2024-08-14 04:53:59] [config] clip-norm: 0
[2024-08-14 04:53:59] [config] cost-scaling:
[2024-08-14 04:53:59] [config]   []
[2024-08-14 04:53:59] [config] cost-type: ce-mean-words
[2024-08-14 04:53:59] [config] cpu-threads: 0
[2024-08-14 04:53:59] [config] data-threads: 8
[2024-08-14 04:53:59] [config] data-weighting: ""
[2024-08-14 04:53:59] [config] data-weighting-type: sentence
[2024-08-14 04:53:59] [config] dec-cell: gru
[2024-08-14 04:53:59] [config] dec-cell-base-depth: 2
[2024-08-14 04:53:59] [config] dec-cell-high-depth: 1
[2024-08-14 04:53:59] [config] dec-depth: 6
[2024-08-14 04:53:59] [config] devices:
[2024-08-14 04:53:59] [config]   - 0
[2024-08-14 04:53:59] [config]   - 1
[2024-08-14 04:53:59] [config]   - 2
[2024-08-14 04:53:59] [config]   - 3
[2024-08-14 04:53:59] [config]   - 4
[2024-08-14 04:53:59] [config]   - 5
[2024-08-14 04:53:59] [config]   - 6
[2024-08-14 04:53:59] [config]   - 7
[2024-08-14 04:53:59] [config] dim-emb: 1024
[2024-08-14 04:53:59] [config] dim-rnn: 1024
[2024-08-14 04:53:59] [config] dim-vocabs:
[2024-08-14 04:53:59] [config]   - 69666
[2024-08-14 04:53:59] [config]   - 69666
[2024-08-14 04:53:59] [config] disp-first: 10
[2024-08-14 04:53:59] [config] disp-freq: 10000
[2024-08-14 04:53:59] [config] disp-label-counts: true
[2024-08-14 04:53:59] [config] dropout-rnn: 0
[2024-08-14 04:53:59] [config] dropout-src: 0
[2024-08-14 04:53:59] [config] dropout-trg: 0
[2024-08-14 04:53:59] [config] dump-config: ""
[2024-08-14 04:53:59] [config] dynamic-gradient-scaling:
[2024-08-14 04:53:59] [config]   []
[2024-08-14 04:53:59] [config] early-stopping: 20
[2024-08-14 04:53:59] [config] early-stopping-on: first
[2024-08-14 04:53:59] [config] embedding-fix-src: false
[2024-08-14 04:53:59] [config] embedding-fix-trg: false
[2024-08-14 04:53:59] [config] embedding-normalization: false
[2024-08-14 04:53:59] [config] embedding-vectors:
[2024-08-14 04:53:59] [config]   []
[2024-08-14 04:53:59] [config] enc-cell: gru
[2024-08-14 04:53:59] [config] enc-cell-depth: 1
[2024-08-14 04:53:59] [config] enc-depth: 6
[2024-08-14 04:53:59] [config] enc-type: bidirectional
[2024-08-14 04:53:59] [config] english-title-case-every: 0
[2024-08-14 04:53:59] [config] exponential-smoothing: 0.0001
[2024-08-14 04:53:59] [config] factor-weight: 1
[2024-08-14 04:53:59] [config] factors-combine: sum
[2024-08-14 04:53:59] [config] factors-dim-emb: 0
[2024-08-14 04:53:59] [config] gradient-checkpointing: false
[2024-08-14 04:53:59] [config] gradient-norm-average-window: 100
[2024-08-14 04:53:59] [config] guided-alignment: none
[2024-08-14 04:53:59] [config] guided-alignment-cost: ce
[2024-08-14 04:53:59] [config] guided-alignment-weight: 0.1
[2024-08-14 04:53:59] [config] ignore-model-config: false
[2024-08-14 04:53:59] [config] input-types:
[2024-08-14 04:53:59] [config]   []
[2024-08-14 04:53:59] [config] interpolate-env-vars: false
[2024-08-14 04:53:59] [config] keep-best: true
[2024-08-14 04:53:59] [config] label-smoothing: 0.1
[2024-08-14 04:53:59] [config] layer-normalization: false
[2024-08-14 04:53:59] [config] learn-rate: 0.0002
[2024-08-14 04:53:59] [config] lemma-dependency: ""
[2024-08-14 04:53:59] [config] lemma-dim-emb: 0
[2024-08-14 04:53:59] [config] log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.train2.log
[2024-08-14 04:53:59] [config] log-level: info
[2024-08-14 04:53:59] [config] log-time-zone: ""
[2024-08-14 04:53:59] [config] logical-epoch:
[2024-08-14 04:53:59] [config]   - 1e
[2024-08-14 04:53:59] [config]   - 0
[2024-08-14 04:53:59] [config] lr-decay: 0
[2024-08-14 04:53:59] [config] lr-decay-freq: 50000
[2024-08-14 04:53:59] [config] lr-decay-inv-sqrt:
[2024-08-14 04:53:59] [config]   - 8000
[2024-08-14 04:53:59] [config] lr-decay-repeat-warmup: false
[2024-08-14 04:53:59] [config] lr-decay-reset-optimizer: false
[2024-08-14 04:53:59] [config] lr-decay-start:
[2024-08-14 04:53:59] [config]   - 10
[2024-08-14 04:53:59] [config]   - 1
[2024-08-14 04:53:59] [config] lr-decay-strategy: epoch+stalled
[2024-08-14 04:53:59] [config] lr-report: false
[2024-08-14 04:53:59] [config] lr-warmup: 8000
[2024-08-14 04:53:59] [config] lr-warmup-at-reload: false
[2024-08-14 04:53:59] [config] lr-warmup-cycle: true
[2024-08-14 04:53:59] [config] lr-warmup-start-rate: 0
[2024-08-14 04:53:59] [config] max-length: 100
[2024-08-14 04:53:59] [config] max-length-crop: false
[2024-08-14 04:53:59] [config] max-length-factor: 3
[2024-08-14 04:53:59] [config] maxi-batch: 1000
[2024-08-14 04:53:59] [config] maxi-batch-sort: trg
[2024-08-14 04:53:59] [config] mini-batch: 1000
[2024-08-14 04:53:59] [config] mini-batch-fit: true
[2024-08-14 04:53:59] [config] mini-batch-fit-step: 10
[2024-08-14 04:53:59] [config] mini-batch-round-up: true
[2024-08-14 04:53:59] [config] mini-batch-track-lr: false
[2024-08-14 04:53:59] [config] mini-batch-warmup: 0
[2024-08-14 04:53:59] [config] mini-batch-words: 0
[2024-08-14 04:53:59] [config] mini-batch-words-ref: 0
[2024-08-14 04:53:59] [config] model: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-14 04:53:59] [config] multi-loss-type: sum
[2024-08-14 04:53:59] [config] n-best: false
[2024-08-14 04:53:59] [config] no-nccl: false
[2024-08-14 04:53:59] [config] no-reload: false
[2024-08-14 04:53:59] [config] no-restore-corpus: false
[2024-08-14 04:53:59] [config] normalize: 1
[2024-08-14 04:53:59] [config] normalize-gradient: false
[2024-08-14 04:53:59] [config] num-devices: 0
[2024-08-14 04:53:59] [config] optimizer: adam
[2024-08-14 04:53:59] [config] optimizer-delay: 10
[2024-08-14 04:53:59] [config] optimizer-params:
[2024-08-14 04:53:59] [config]   - 0.9
[2024-08-14 04:53:59] [config]   - 0.998
[2024-08-14 04:53:59] [config]   - 1e-09
[2024-08-14 04:53:59] [config] output-omit-bias: false
[2024-08-14 04:53:59] [config] overwrite: true
[2024-08-14 04:53:59] [config] precision:
[2024-08-14 04:53:59] [config]   - float32
[2024-08-14 04:53:59] [config]   - float32
[2024-08-14 04:53:59] [config] pretrained-model: ""
[2024-08-14 04:53:59] [config] quantize-biases: false
[2024-08-14 04:53:59] [config] quantize-bits: 0
[2024-08-14 04:53:59] [config] quantize-log-based: false
[2024-08-14 04:53:59] [config] quantize-optimization-steps: 0
[2024-08-14 04:53:59] [config] quiet: false
[2024-08-14 04:53:59] [config] quiet-translation: false
[2024-08-14 04:53:59] [config] relative-paths: false
[2024-08-14 04:53:59] [config] right-left: false
[2024-08-14 04:53:59] [config] save-freq: 10000
[2024-08-14 04:53:59] [config] seed: 2222
[2024-08-14 04:53:59] [config] sentencepiece-alphas:
[2024-08-14 04:53:59] [config]   []
[2024-08-14 04:53:59] [config] sentencepiece-max-lines: 2000000
[2024-08-14 04:53:59] [config] sentencepiece-options: ""
[2024-08-14 04:53:59] [config] sharding: local
[2024-08-14 04:53:59] [config] shuffle: batches
[2024-08-14 04:53:59] [config] shuffle-in-ram: false
[2024-08-14 04:53:59] [config] sigterm: save-and-exit
[2024-08-14 04:53:59] [config] skip: false
[2024-08-14 04:53:59] [config] sqlite: ""
[2024-08-14 04:53:59] [config] sqlite-drop: false
[2024-08-14 04:53:59] [config] sync-freq: 200u
[2024-08-14 04:53:59] [config] sync-sgd: true
[2024-08-14 04:53:59] [config] tempdir: /scratch/project_462000447/tmp
[2024-08-14 04:53:59] [config] tied-embeddings: false
[2024-08-14 04:53:59] [config] tied-embeddings-all: true
[2024-08-14 04:53:59] [config] tied-embeddings-src: false
[2024-08-14 04:53:59] [config] train-embedder-rank:
[2024-08-14 04:53:59] [config]   []
[2024-08-14 04:53:59] [config] train-sets:
[2024-08-14 04:53:59] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.src.clean.spm64k.gz
[2024-08-14 04:53:59] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/train/opusTCv20230926+bt+jhubc.trg.clean.spm64k.gz
[2024-08-14 04:53:59] [config] transformer-aan-activation: swish
[2024-08-14 04:53:59] [config] transformer-aan-depth: 2
[2024-08-14 04:53:59] [config] transformer-aan-nogate: false
[2024-08-14 04:53:59] [config] transformer-decoder-autoreg: self-attention
[2024-08-14 04:53:59] [config] transformer-decoder-dim-ffn: 0
[2024-08-14 04:53:59] [config] transformer-decoder-ffn-depth: 0
[2024-08-14 04:53:59] [config] transformer-depth-scaling: false
[2024-08-14 04:53:59] [config] transformer-dim-aan: 2048
[2024-08-14 04:53:59] [config] transformer-dim-ffn: 4096
[2024-08-14 04:53:59] [config] transformer-dropout: 0.1
[2024-08-14 04:53:59] [config] transformer-dropout-attention: 0
[2024-08-14 04:53:59] [config] transformer-dropout-ffn: 0
[2024-08-14 04:53:59] [config] transformer-ffn-activation: relu
[2024-08-14 04:53:59] [config] transformer-ffn-depth: 2
[2024-08-14 04:53:59] [config] transformer-guided-alignment-layer: last
[2024-08-14 04:53:59] [config] transformer-heads: 16
[2024-08-14 04:53:59] [config] transformer-no-projection: false
[2024-08-14 04:53:59] [config] transformer-pool: false
[2024-08-14 04:53:59] [config] transformer-postprocess: dan
[2024-08-14 04:53:59] [config] transformer-postprocess-emb: d
[2024-08-14 04:53:59] [config] transformer-postprocess-top: ""
[2024-08-14 04:53:59] [config] transformer-preprocess: ""
[2024-08-14 04:53:59] [config] transformer-rnn-projection: false
[2024-08-14 04:53:59] [config] transformer-tied-layers:
[2024-08-14 04:53:59] [config]   []
[2024-08-14 04:53:59] [config] transformer-train-position-embeddings: false
[2024-08-14 04:53:59] [config] tsv: false
[2024-08-14 04:53:59] [config] tsv-fields: 0
[2024-08-14 04:53:59] [config] type: transformer
[2024-08-14 04:53:59] [config] ulr: false
[2024-08-14 04:53:59] [config] ulr-dim-emb: 0
[2024-08-14 04:53:59] [config] ulr-dropout: 0
[2024-08-14 04:53:59] [config] ulr-keys-vectors: ""
[2024-08-14 04:53:59] [config] ulr-query-vectors: ""
[2024-08-14 04:53:59] [config] ulr-softmax-temperature: 1
[2024-08-14 04:53:59] [config] ulr-trainable-transformation: false
[2024-08-14 04:53:59] [config] unlikelihood-loss: false
[2024-08-14 04:53:59] [config] valid-freq: 10000
[2024-08-14 04:53:59] [config] valid-log: /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.valid2.log
[2024-08-14 04:53:59] [config] valid-max-length: 100
[2024-08-14 04:53:59] [config] valid-metrics:
[2024-08-14 04:53:59] [config]   - perplexity
[2024-08-14 04:53:59] [config] valid-mini-batch: 16
[2024-08-14 04:53:59] [config] valid-reset-stalled: false
[2024-08-14 04:53:59] [config] valid-script-args:
[2024-08-14 04:53:59] [config]   []
[2024-08-14 04:53:59] [config] valid-script-path: ""
[2024-08-14 04:53:59] [config] valid-sets:
[2024-08-14 04:53:59] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.src.spm64k
[2024-08-14 04:53:59] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/val/Tatoeba-dev-v2023-09-26.trg.spm64k
[2024-08-14 04:53:59] [config] valid-translation-output: ""
[2024-08-14 04:53:59] [config] version: v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-14 04:53:59] [config] vocabs:
[2024-08-14 04:53:59] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-14 04:53:59] [config]   - /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-14 04:53:59] [config] word-penalty: 0
[2024-08-14 04:53:59] [config] word-scores: false
[2024-08-14 04:53:59] [config] workspace: 20000
[2024-08-14 04:53:59] [config] Loaded model has been created with Marian v1.11.13 320dd390 2022-12-08 15:07:59 +0200
[2024-08-14 04:53:59] Using synchronous SGD
[2024-08-14 04:53:59] [comm] Compiled without MPI support. Running as a single process on nid005031
[2024-08-14 04:53:59] Synced seed 2222
[2024-08-14 04:53:59] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-14 04:54:00] [data] Setting vocabulary size for input 0 to 69,666
[2024-08-14 04:54:00] [data] Loading vocabulary from JSON/Yaml file /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.vocab.yml
[2024-08-14 04:54:00] [data] Setting vocabulary size for input 1 to 69,666
[2024-08-14 04:54:00] [batching] Collecting statistics for batch fitting with step size 10
[2024-08-14 04:54:01] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-08-14 04:54:01] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-08-14 04:54:01] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-08-14 04:54:01] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-08-14 04:54:01] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-08-14 04:54:01] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-08-14 04:54:01] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-08-14 04:54:01] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-08-14 04:54:01] [comm] Using NCCL 3.2.12 for GPU communication
[2024-08-14 04:54:04] [comm] Using global sharding
[2024-08-14 04:54:05] [comm] NCCLCommunicators constructed successfully
[2024-08-14 04:54:05] [training] Using 8 GPUs
[2024-08-14 04:54:05] [logits] Applying loss function for 1 factor(s)
[2024-08-14 04:54:05] [memory] Reserving 945 MB, device gpu0
[2024-08-14 04:54:10] [memory] Reserving 945 MB, device gpu0
[2024-08-14 04:54:44] [batching] Done. Typical MB size is 699,120 target words
[2024-08-14 04:54:44] [memory] Extending reserved space to 20096 MB (device gpu0)
[2024-08-14 04:54:44] [memory] Extending reserved space to 20096 MB (device gpu1)
[2024-08-14 04:54:44] [memory] Extending reserved space to 20096 MB (device gpu2)
[2024-08-14 04:54:44] [memory] Extending reserved space to 20096 MB (device gpu3)
[2024-08-14 04:54:44] [memory] Extending reserved space to 20096 MB (device gpu4)
[2024-08-14 04:54:44] [memory] Extending reserved space to 20096 MB (device gpu5)
[2024-08-14 04:54:44] [memory] Extending reserved space to 20096 MB (device gpu6)
[2024-08-14 04:54:44] [memory] Extending reserved space to 20096 MB (device gpu7)
[2024-08-14 04:54:44] [comm] Using NCCL 3.2.12 for GPU communication
[2024-08-14 04:54:44] [comm] Using global sharding
[2024-08-14 04:54:45] [comm] NCCLCommunicators constructed successfully
[2024-08-14 04:54:45] [training] Using 8 GPUs
[2024-08-14 04:54:45] Loading model from /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-14 04:55:03] Allocating memory for general optimizer shards
[2024-08-14 04:55:03] [memory] Reserving 118 MB, device gpu0
[2024-08-14 04:55:03] [memory] Reserving 118 MB, device gpu1
[2024-08-14 04:55:03] [memory] Reserving 118 MB, device gpu2
[2024-08-14 04:55:03] [memory] Reserving 118 MB, device gpu3
[2024-08-14 04:55:03] [memory] Reserving 118 MB, device gpu4
[2024-08-14 04:55:03] [memory] Reserving 118 MB, device gpu5
[2024-08-14 04:55:03] [memory] Reserving 118 MB, device gpu6
[2024-08-14 04:55:03] [memory] Reserving 118 MB, device gpu7
[2024-08-14 04:55:03] Loading Adam parameters
[2024-08-14 04:55:05] [memory] Reserving 236 MB, device gpu0
[2024-08-14 04:55:05] [memory] Reserving 236 MB, device gpu1
[2024-08-14 04:55:05] [memory] Reserving 236 MB, device gpu2
[2024-08-14 04:55:05] [memory] Reserving 236 MB, device gpu3
[2024-08-14 04:55:05] [memory] Reserving 236 MB, device gpu4
[2024-08-14 04:55:06] [memory] Reserving 236 MB, device gpu5
[2024-08-14 04:55:06] [memory] Reserving 236 MB, device gpu6
[2024-08-14 04:55:06] [memory] Reserving 236 MB, device gpu7
[2024-08-14 04:55:06] [memory] Reserving 945 MB, device gpu0
[2024-08-14 04:55:07] [memory] Reserving 945 MB, device gpu1
[2024-08-14 04:55:07] [memory] Reserving 945 MB, device gpu2
[2024-08-14 04:55:07] [memory] Reserving 945 MB, device gpu3
[2024-08-14 04:55:07] [memory] Reserving 945 MB, device gpu4
[2024-08-14 04:55:08] [memory] Reserving 945 MB, device gpu5
[2024-08-14 04:55:08] [memory] Reserving 945 MB, device gpu6
[2024-08-14 04:55:08] [memory] Reserving 945 MB, device gpu7
[2024-08-14 04:55:09] [training] Master parameters and optimizers restored from training checkpoint /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-14 04:55:09] [data] Restoring the corpus state to epoch 1, batch 1180000
[2024-08-15 00:59:48] Training started
[2024-08-15 00:59:49] [training] Batches are processed as 1 process(es) x 8 devices/process
[2024-08-15 01:00:13] [memory] Reserving 945 MB, device gpu4
[2024-08-15 01:00:13] [memory] Reserving 945 MB, device gpu7
[2024-08-15 01:00:13] [memory] Reserving 945 MB, device gpu1
[2024-08-15 01:00:14] [memory] Reserving 945 MB, device gpu6
[2024-08-15 01:00:14] [memory] Reserving 945 MB, device gpu2
[2024-08-15 01:00:14] [memory] Reserving 945 MB, device gpu5
[2024-08-15 01:00:14] [memory] Reserving 945 MB, device gpu3
[2024-08-15 01:00:14] [memory] Reserving 945 MB, device gpu0
[2024-08-15 01:00:17] Parameter type float32, optimization type float32, casting types false
[2024-08-15 09:03:07] Ep. 1 : Up. 1190000 : Sen. 9,141,958,887 : Cost 3.09503508 : Time 101302.63s : 26694.61 words/s : gNorm 1.4938
[2024-08-15 09:03:07] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-15 09:03:12] Saving Adam parameters
[2024-08-15 09:03:19] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-15 09:03:33] [valid] Ep. 1 : Up. 1190000 : perplexity : 11.4967 : stalled 2 times (last best: 11.4963)
[2024-08-15 17:06:56] Ep. 1 : Up. 1200000 : Sen. 9,218,760,440 : Cost 3.09536195 : Time 29029.63s : 93158.99 words/s : gNorm 1.6388
[2024-08-15 17:06:57] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-15 17:07:01] Saving Adam parameters
[2024-08-15 17:07:09] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-15 17:07:23] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-15 17:07:26] [valid] Ep. 1 : Up. 1200000 : perplexity : 11.4928 : new best
[2024-08-16 01:10:24] Ep. 1 : Up. 1210000 : Sen. 9,295,535,102 : Cost 3.09451485 : Time 29007.15s : 93186.16 words/s : gNorm 1.4417
[2024-08-16 01:10:24] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-16 01:10:28] Saving Adam parameters
[2024-08-16 01:10:36] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-16 01:10:50] [valid] Ep. 1 : Up. 1210000 : perplexity : 11.4976 : stalled 1 times (last best: 11.4928)
[2024-08-16 09:13:54] Ep. 1 : Up. 1220000 : Sen. 9,372,320,979 : Cost 3.09389186 : Time 29010.75s : 93199.82 words/s : gNorm 1.6612
[2024-08-16 09:13:55] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-16 09:13:59] Saving Adam parameters
[2024-08-16 09:14:07] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-16 09:14:21] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-16 09:14:24] [valid] Ep. 1 : Up. 1220000 : perplexity : 11.4904 : new best
[2024-08-16 17:17:08] Ep. 1 : Up. 1230000 : Sen. 9,448,996,197 : Cost 3.09381652 : Time 28993.46s : 93177.19 words/s : gNorm 1.3056
[2024-08-16 17:17:08] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-16 17:17:13] Saving Adam parameters
[2024-08-16 17:17:21] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-16 17:17:35] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-16 17:17:37] [valid] Ep. 1 : Up. 1230000 : perplexity : 11.4766 : new best
[2024-08-17 01:20:39] Ep. 1 : Up. 1240000 : Sen. 9,525,802,059 : Cost 3.09431219 : Time 29011.34s : 93185.17 words/s : gNorm 1.1736
[2024-08-17 01:20:39] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz
[2024-08-17 01:20:44] Saving Adam parameters
[2024-08-17 01:20:52] [training] Saving training checkpoint to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz and /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.optimizer.npz
[2024-08-17 01:21:06] Saving model weights and runtime parameters to /pfs/lustrep4/scratch/project_462000447/members/tiedeman/OPUS-MT-train/tatoeba/work/mul-mul/opusTCv20230926+bt+jhubc.spm64k-spm64k.transformer-big.model2.npz.best-perplexity.npz
[2024-08-17 01:21:09] [valid] Ep. 1 : Up. 1240000 : perplexity : 11.4724 : new best
